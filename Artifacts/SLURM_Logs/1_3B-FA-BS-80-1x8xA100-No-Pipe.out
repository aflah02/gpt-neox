[2025-01-06 10:32:32,756] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
NeoXArgs.from_ymls() ['./configs/1-3B.yml', './configs/local_setup_wandb_modified.yml']
-------------------- arguments --------------------
  attention_config ................ ['flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash', 'flash']updated
  batch_size ...................... 80..........................updated
  checkpoint_activations .......... True........................updated
  checkpoint_factor ............... 10000.......................updated
  config_files .................... {'1-3B.yml': '# GPT-2 pretraining setup\n{\n   # parallelism settings ( you will want to change these based on your cluster setup, ideally scheduling pipeline stages\n   # across the node boundaries )\n   "pipe_parallel_size": 0,\n   "model_parallel_size": 1,\n\n   # model settings\n   "num_layers": 24,\n   "hidden_size": 2048,\n   "num_attention_heads": 16,\n   "seq_length": 2048,\n   "max_position_embeddings": 2048,\n   "norm": "layernorm",\n   "pos_emb": "rotary",\n   "no_weight_tying": true,\n   "gpt_j_residual": false,\n   "output_layer_parallelism": "column",\n\n   # these should provide some speedup but takes a while to build, set to true if desired\n   "scaled_upper_triang_masked_softmax_fusion": false,\n   "bias_gelu_fusion": false,\n   "rope_fusion": false,\n   "layernorm_fusion": false,\n\n   # init methods\n   "init_method": "small_init",\n   "output_layer_init_method": "wang_init",\n\n   # optimizer settings\n   "optimizer": {\n     "type": "Adam",\n     "params": {\n       "lr": 0.0002,\n       "betas": [0.9, 0.95],\n       "eps":  1.0e-8,\n     }\n   },\n   "min_lr": 0.00002,\n\n   # for all zero_optimization options, see https://www.deepspeed.ai/docs/config-json/#zero-optimizations-for-fp16-training\n   "zero_optimization": {\n    "stage": 1,\n    "allgather_partitions": True,\n    "allgather_bucket_size": 500000000,\n    "overlap_comm": True,\n    "reduce_scatter": True,\n    "reduce_bucket_size": 500000000,\n    "contiguous_gradients": True,\n  },\n\n   # batch / data settings\n   "train_micro_batch_size_per_gpu": 80,\n   "data_impl": "mmap",\n\n   # activation checkpointing\n   "checkpoint_activations": true,\n   "checkpoint_num_layers": 1,\n   "partition_activations": true,\n   "synchronize_each_layer": true,\n\n   # regularization\n   "gradient_clipping": 1.0,\n   "weight_decay": 0.1,\n   "hidden_dropout": 0,\n   "attention_dropout": 0,\n\n   # Flash Attention\n   "attention_config": [[["flash"], 24]],\n\n   # precision settings\n   "fp16": {\n     "fp16": true,\n     "enabled": true,\n     "loss_scale": 0,\n     "loss_scale_window": 1000,\n     "hysteresis": 2,\n     "min_loss_scale": 1\n   },\n\n   # misc. training settings\n   "train_iters": 320000,\n   "lr_decay_iters": 320000,\n   "distributed_backend": "nccl",\n   "lr_decay_style": "cosine",\n   "warmup": 0.01,\n   "checkpoint_factor": 10000,\n   "eval_interval": 1000,\n   "eval_iters": 10,\n\n   # logging\n   "log_interval": 10,\n   "steps_per_print": 10,\n   "keep_last_n_checkpoints": 4,\n   "wall_clock_breakdown": true,\n}\n', 'local_setup_wandb_modified.yml': '# Suggested data paths when using GPT-NeoX locally\n{\n  "data_path": "data/enwik8/enwik8_text_document",\n\n  # or for weighted datasets:\n  # "train-data-paths": ["data/enwik8/enwik8_text_document", "data/enwik8/enwik8_text_document"],\n  # "test-data-paths": ["data/enwik8/enwik8_text_document", "data/enwik8/enwik8_text_document"],\n  # "valid-data-paths": ["data/enwik8/enwik8_text_document", "data/enwik8/enwik8_text_document"],\n  # "train-data-weights": [1., 2.],\n  # "test-data-weights": [2., 1.],\n  # "valid-data-weights": [0.5, 0.4],\n\n  # If weight_by_num_documents is True, Builds dataset weights from a multinomial distribution over groups of data according to the number of documents in each group.\n  # WARNING: setting this to True will override any user provided weights\n  # "weight_by_num_documents": false,\n  # "weighted_sampler_alpha": 0.3,\n\n  "vocab_file": "data/gpt2-vocab.json",\n  "merge_file": "data/gpt2-merges.txt",\n\n  "save": "checkpoints",\n  "load": "checkpoints",\n  "checkpoint_validation_with_forward_pass": False,\n\n  "tensorboard_dir": "tensorboard",\n  "log_dir": "logs",\n  "use_wandb": True,\n  "wandb_host": "https://api.wandb.ai",\n  "wandb_project": "neox",\n  "wandb_run_name": "1.3B-FA-BS-80-1x8xA100-No-Pipe",\n\n  "peak_theoretical_tflops": 312\n}\n'}updated
  data_impl ....................... mmap........................updated
  data_path ....................... data/enwik8/enwik8_text_documentupdated
  dynamic_loss_scale .............. True........................updated
  eval_iters ...................... 10..........................updated
  fp16 ............................ {'fp16': True, 'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}updated
  global_num_gpus ................. 8...........................updated
  hidden_size ..................... 2048........................updated
  init_method ..................... small_init..................updated
  keep_last_n_checkpoints ......... 4...........................updated
  load ............................ checkpoints.................updated
  log_dir ......................... logs........................updated
  log_interval .................... 10..........................updated
  lr .............................. 0.0002......................updated
  lr_decay_iters .................. 320000......................updated
  lr_decay_style .................. cosine......................updated
  max_position_embeddings ......... 2048........................updated
  merge_file ...................... data/gpt2-merges.txt........updated
  min_lr .......................... 2e-05.......................updated
  no_weight_tying ................. True........................updated
  num_attention_heads ............. 16..........................updated
  num_layers ...................... 24..........................updated
  optimizer ....................... {'type': 'Adam', 'params': {'lr': 0.0002, 'betas': [0.9, 0.95], 'eps': 1e-08}}updated
  optimizer_type .................. Adam........................updated
  output_layer_init_method ........ wang_init...................updated
  partition_activations ........... True........................updated
  peak_theoretical_tflops ......... 312.........................updated
  pos_emb ......................... rotary......................updated
  precision ....................... fp16........................updated
  save ............................ checkpoints.................updated
  seq_length ...................... 2048........................updated
  sparsity_config ................. {}..........................updated
  synchronize_each_layer .......... True........................updated
  tensorboard_dir ................. tensorboard.................updated
  text_gen_type ................... unconditional...............updated
  train_batch_size ................ 640.........................updated
  train_iters ..................... 320000......................updated
  train_micro_batch_size_per_gpu .. 80..........................updated
  use_wandb ....................... True........................updated
  user_script ..................... train.py....................updated
  vocab_file ...................... data/gpt2-vocab.json........updated
  wall_clock_breakdown ............ True........................updated
  wandb_group ..................... g73ywh1o_ikyja08x...........updated
  wandb_run_name .................. 1.3B-FA-BS-80-1x8xA100-No-Pipeupdated
  zero_allgather_bucket_size ...... 500000000...................updated
  zero_contiguous_gradients ....... True........................updated
  zero_optimization ............... {'stage': 1, 'allgather_partitions': True, 'allgather_bucket_size': 500000000, 'overlap_comm': True, 'reduce_scatter': True, 'reduce_bucket_size': 500000000, 'contiguous_gradients': True}updated
  zero_reduce_bucket_size ......... 500000000...................updated
  zero_reduce_scatter ............. True........................updated
  zero_stage ...................... 1...........................updated
  account ......................... None........................default
  activation ...................... gelu........................default
  activation_checkpointing ........ None........................default
  adlr_autoresume ................. False.......................default
  adlr_autoresume_interval ........ 1000........................default
  allow_chopped ................... True........................default
  amp ............................. None........................default
  apply_query_key_layer_scaling ... False.......................default
  attention_dropout ............... 0...........................default
  attention_softmax_in_fp32 ....... False.......................default
  autotuning ...................... None........................default
  autotuning_run .................. None........................default
  base_shapes_file ................ None........................default
  bf16 ............................ None........................default
  bias_dropout_fusion ............. False.......................default
  bias_gelu_fusion ................ False.......................default
  char_level_ppl .................. False.......................default
  checkpoint ...................... None........................default
  checkpoint_in_cpu ............... False.......................default
  checkpoint_num_layers ........... 1...........................default
  checkpoint_scale ................ linear......................default
  checkpoint_validation_with_forward_pass  False................default
  clip_grad ....................... 1.0.........................default
  comet_experiment ................ None........................default
  comet_experiment_name ........... None........................default
  comet_others .................... None........................default
  comet_project ................... None........................default
  comet_tags ...................... None........................default
  comet_workspace ................. None........................default
  comment ......................... None........................default
  comms_logger .................... None........................default
  communication_data_type ......... None........................default
  compression_training ............ None........................default
  contiguous_checkpointing ........ False.......................default
  coord_check ..................... False.......................default
  create_moe_param_group .......... True........................default
  csv_monitor ..................... None........................default
  curriculum_learning ............. None........................default
  curriculum_seqlen ............... 0...........................default
  data_efficiency ................. None........................default
  data_types ...................... None........................default
  dataset_impl .................... gpt2........................default
  deepscale ....................... False.......................default
  deepscale_config ................ None........................default
  deepspeed ....................... True........................default
  deepspeed_activation_checkpointing  True......................default
  deepspeed_extra_args ............ None........................default
  deepspeed_mpi ................... False.......................default
  deepspeed_slurm ................. False.......................default
  detect_nvlink_pairs ............. False.......................default
  dim_att ......................... None........................default
  distributed_backend ............. nccl........................default
  do_test ......................... None........................default
  do_train ........................ None........................default
  do_valid ........................ None........................default
  dpo_beta ........................ 0.1.........................default
  dpo_fp32 ........................ True........................default
  dpo_reference_free .............. False.......................default
  dump_state ...................... False.......................default
  elasticity ...................... None........................default
  enable_expert_tensor_parallelism  False.......................default
  eod_mask_loss ................... False.......................default
  eval_interval ................... 1000........................default
  eval_results_prefix ............. ............................default
  eval_tasks ...................... None........................default
  exclude ......................... None........................default
  exit_interval ................... None........................default
  expansion_factor ................ None........................default
  expert_interval ................. 2...........................default
  extra_save_iters ................ None........................default
  ffn_dim ......................... None........................default
  finetune ........................ False.......................default
  flops_profiler .................. None........................default
  force_multi ..................... False.......................default
  fp16_lm_cross_entropy ........... False.......................default
  fp32_allreduce .................. False.......................default
  fp32_reinforce .................. True........................default
  git_hash ........................ 0af74c0.....................default
  gmlp_attn_dim ................... 64..........................default
  gpt_j_residual .................. False.......................default
  gpt_j_tied ...................... False.......................default
  gradient_accumulation_steps ..... 1...........................default
  gradient_clipping ............... 1.0.........................default
  gradient_noise_scale_cpu_offload  False.......................default
  gradient_noise_scale_n_batches .. 5...........................default
  gradient_predivide_factor ....... 1.0.........................default
  head_size ....................... None........................default
  hidden_dropout .................. 0...........................default
  hostfile ........................ None........................default
  hysteresis ...................... 2...........................default
  include ......................... None........................default
  init_method_std ................. 0.02........................default
  intermediate_size ............... None........................default
  is_pipe_parallel ................ False.......................default
  iteration ....................... None........................default
  kl_div_beta ..................... 0.1.........................default
  kl_impl ......................... mse.........................default
  kto_beta ........................ 0.1.........................default
  kto_desirable_weight ............ 1.0.........................default
  kto_fp32 ........................ True........................default
  kto_undesirable_weight .......... 1.0.........................default
  launcher ........................ pdsh........................default
  layernorm_epsilon ............... 1e-05.......................default
  layernorm_fusion ................ False.......................default
  lazy_mpu_init ................... False.......................default
  local_rank ...................... None........................default
  log_grad_norm ................... False.......................default
  log_grad_pct_zeros .............. False.......................default
  log_gradient_noise_scale ........ False.......................default
  log_optimizer_states ............ False.......................default
  log_param_norm .................. False.......................default
  loss_scale ...................... None........................default
  loss_scale_window ............... 1000.0......................default
  lr_decay_fraction ............... None........................default
  make_vocab_size_divisible_by .... 128.........................default
  mamba_causal_conv_fusion ........ False.......................default
  mamba_inner_func_fusion ......... False.......................default
  mamba_selective_fp32_params ..... True........................default
  mamba_selective_scan_fusion ..... False.......................default
  mamba_use_bias_in_conv .......... True........................default
  mamba_use_bias_in_linears ....... False.......................default
  master_addr ..................... None........................default
  master_port ..................... 29500.......................default
  maximum_tokens .................. 64..........................default
  memory_profiling ................ False.......................default
  memory_profiling_path ........... None........................default
  min_scale ....................... 1.0.........................default
  mlp_multiple_of ................. 1...........................default
  mmap_warmup ..................... False.......................default
  model_parallel_size ............. 1...........................default
  moe_eval_capacity_factor ........ 1.0.........................default
  moe_expert_parallel_size ........ 1...........................default
  moe_glu ......................... False.......................default
  moe_jitter_eps .................. None........................default
  moe_lbl_in_fp32 ................. False.......................default
  moe_loss_coeff .................. 0.1.........................default
  moe_min_capacity ................ 4...........................default
  moe_num_experts ................. 1...........................default
  moe_token_dropping .............. False.......................default
  moe_top_k ....................... 1...........................default
  moe_train_capacity_factor ....... 1.0.........................default
  moe_type ........................ megablocks..................default
  moe_use_residual ................ True........................default
  mup_attn_temp ................... 1.0.........................default
  mup_embedding_mult .............. 1.0.........................default
  mup_init_scale .................. 1.0.........................default
  mup_output_temp ................. 1.0.........................default
  mup_rp_embedding_mult ........... 1.0.........................default
  mup_width_scale ................. 2...........................default
  neg_test_data_paths ............. None........................default
  neg_test_label_data_paths ....... None........................default
  neg_train_data_paths ............ None........................default
  neg_train_label_data_paths ...... None........................default
  neg_valid_data_paths ............ None........................default
  neg_valid_label_data_paths ...... None........................default
  no_load_optim ................... False.......................default
  no_load_rng ..................... False.......................default
  no_save_optim ................... False.......................default
  no_save_rng ..................... False.......................default
  no_ssh_check .................... False.......................default
  norm ............................ layernorm...................default
  num_gpus ........................ None........................default
  num_kv_heads .................... None........................default
  num_nodes ....................... -1..........................default
  num_samples ..................... 1...........................default
  num_unique_layers ............... None........................default
  num_workers ..................... 2...........................default
  online_dataserver_ips ........... localhost...................default
  online_dataserver_ports ......... 10000.......................default
  onnx_safe ....................... False.......................default
  opt_pos_emb_offset .............. 0...........................default
  output_layer_parallelism ........ column......................default
  override_lr_scheduler ........... False.......................default
  pack_impl ....................... packed......................default
  padded_vocab_size ............... None........................default
  param_sharing_style ............. grouped.....................default
  pipe_parallel_size .............. 0...........................default
  pipe_partition_method ........... type:transformer|mlp........default
  pos_test_data_paths ............. None........................default
  pos_test_label_data_paths ....... None........................default
  pos_train_data_paths ............ None........................default
  pos_train_label_data_paths ...... None........................default
  pos_valid_data_paths ............ None........................default
  pos_valid_label_data_paths ...... None........................default
  precompute_model_name ........... None........................default
  prescale_gradients .............. False.......................default
  profile ......................... False.......................default
  profile_backward ................ False.......................default
  profile_step_start .............. 10..........................default
  profile_step_stop ............... 12..........................default
  prompt_end ...................... 
...........................default
  rank ............................ None........................default
  recompute ....................... False.......................default
  reinforce_leave_one_out ......... False.......................default
  return_logits ................... False.......................default
  rms_norm_epsilon ................ 1e-08.......................default
  rmsnorm_fusion .................. False.......................default
  rope_fusion ..................... False.......................default
  rotary_emb_base ................. 10000.......................default
  rotary_pct ...................... 1.0.........................default
  rotary_save_freqs_buffer ........ False.......................default
  rpe_max_distance ................ 128.........................default
  rpe_num_buckets ................. 32..........................default
  s3_chunk_size ................... 104857600...................default
  s3_path ......................... None........................default
  sample_input_file ............... None........................default
  sample_output_file .............. samples.txt.................default
  save_base_shapes ................ False.......................default
  scaled_masked_softmax_fusion .... False.......................default
  scaled_upper_triang_masked_softmax_fusion  False..............default
  scalenorm_epsilon ............... 1e-08.......................default
  scheduler ....................... None........................default
  seed ............................ 1234........................default
  sequence_parallel ............... False.......................default
  serve_model_weights ............. False.......................default
  short_seq_prob .................. 0.1.........................default
  sliding_window_width ............ None........................default
  soft_prompt_tuning .............. None........................default
  sparse_attention ................ None........................default
  sparse_gradients ................ False.......................default
  split ........................... 969, 30, 1..................default
  steps_per_print ................. 10..........................default
  te_columnparallel ............... False.......................default
  te_fp8_amax_compute_algo ........ most_recent.................default
  te_fp8_amax_history_len ......... 1...........................default
  te_fp8_format ................... hybrid......................default
  te_fp8_margin ................... 0...........................default
  te_fp8_mha ...................... False.......................default
  te_fp8_wgrad .................... True........................default
  te_layernorm_mlp ................ False.......................default
  te_mha .......................... False.......................default
  te_rowparallel .................. False.......................default
  temperature ..................... 0.0.........................default
  tensorboard ..................... None........................default
  test_data_paths ................. None........................default
  test_data_weights ............... None........................default
  test_label_data_paths ........... None........................default
  test_reward_data_paths .......... None........................default
  tokenizer_type .................. GPT2BPETokenizer............default
  top_k ........................... 0...........................default
  top_p ........................... 0.0.........................default
  train_data_paths ................ None........................default
  train_data_weights .............. None........................default
  train_epochs .................... None........................default
  train_impl ...................... normal......................default
  train_label_data_paths .......... None........................default
  train_reward_data_paths ......... None........................default
  use_bias_in_attn_linear ......... True........................default
  use_bias_in_mlp ................. True........................default
  use_bias_in_norms ............... True........................default
  use_bnb_optimizer ............... False.......................default
  use_checkpoint_lr_scheduler ..... False.......................default
  use_comet ....................... None........................default
  use_cpu_initialization .......... False.......................default
  use_flashattn_swiglu ............ False.......................default
  use_mup ......................... False.......................default
  use_qk_layernorm ................ False.......................default
  use_shared_fs ................... True........................default
  use_tutel ....................... False.......................default
  valid_data_paths ................ None........................default
  valid_data_weights .............. None........................default
  valid_label_data_paths .......... None........................default
  valid_reward_data_paths ......... None........................default
  wandb ........................... None........................default
  wandb_host ...................... https://api.wandb.ai........default
  wandb_init_all_ranks ............ False.......................default
  wandb_project ................... neox........................default
  wandb_team ...................... None........................default
  warmup .......................... 0.01........................default
  weight_by_num_documents ......... False.......................default
  weight_decay .................... 0.1.........................default
  weight_server_port .............. 6000........................default
  weighted_sampler_alpha .......... 1.0.........................default
  world_size ...................... None........................default
  z_loss .......................... 0.0.........................default
---------------- end of arguments ----------------
NeoXArgs.configure_distributed_args() using world size: 1 and model-parallel size: 1 
[2025-01-06 10:32:55,340] [WARNING] [runner.py:217:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7: setting --include=localhost:0,1,2,3,4,5,6,7
[2025-01-06 10:32:55,341] [INFO] [runner.py:586:main] cmd = /NS/venvs/work/afkhan/neoxolmo/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None train.py --deepspeed_config eyJ0cmFpbl9iYXRjaF9zaXplIjogNjQwLCAidHJhaW5fbWljcm9fYmF0Y2hfc2l6ZV9wZXJfZ3B1IjogODAsICJvcHRpbWl6ZXIiOiB7InR5cGUiOiAiQWRhbSIsICJwYXJhbXMiOiB7ImxyIjogMC4wMDAyLCAiYmV0YXMiOiBbMC45LCAwLjk1XSwgImVwcyI6IDFlLTA4fX0sICJmcDE2IjogeyJmcDE2IjogdHJ1ZSwgImVuYWJsZWQiOiB0cnVlLCAibG9zc19zY2FsZSI6IDAsICJsb3NzX3NjYWxlX3dpbmRvdyI6IDEwMDAsICJoeXN0ZXJlc2lzIjogMiwgIm1pbl9sb3NzX3NjYWxlIjogMX0sICJ6ZXJvX29wdGltaXphdGlvbiI6IHsic3RhZ2UiOiAxLCAiYWxsZ2F0aGVyX3BhcnRpdGlvbnMiOiB0cnVlLCAiYWxsZ2F0aGVyX2J1Y2tldF9zaXplIjogNTAwMDAwMDAwLCAib3ZlcmxhcF9jb21tIjogdHJ1ZSwgInJlZHVjZV9zY2F0dGVyIjogdHJ1ZSwgInJlZHVjZV9idWNrZXRfc2l6ZSI6IDUwMDAwMDAwMCwgImNvbnRpZ3VvdXNfZ3JhZGllbnRzIjogdHJ1ZX0sICJ3YWxsX2Nsb2NrX2JyZWFrZG93biI6IHRydWV9 --megatron_config eyJ0cmFpbl9iYXRjaF9zaXplIjogNjQwLCAidHJhaW5fbWljcm9fYmF0Y2hfc2l6ZV9wZXJfZ3B1IjogODAsICJvcHRpbWl6ZXIiOiB7InR5cGUiOiAiQWRhbSIsICJwYXJhbXMiOiB7ImxyIjogMC4wMDAyLCAiYmV0YXMiOiBbMC45LCAwLjk1XSwgImVwcyI6IDFlLTA4fX0sICJmcDE2IjogeyJmcDE2IjogdHJ1ZSwgImVuYWJsZWQiOiB0cnVlLCAibG9zc19zY2FsZSI6IDAsICJsb3NzX3NjYWxlX3dpbmRvdyI6IDEwMDAsICJoeXN0ZXJlc2lzIjogMiwgIm1pbl9sb3NzX3NjYWxlIjogMX0sICJ6ZXJvX29wdGltaXphdGlvbiI6IHsic3RhZ2UiOiAxLCAiYWxsZ2F0aGVyX3BhcnRpdGlvbnMiOiB0cnVlLCAiYWxsZ2F0aGVyX2J1Y2tldF9zaXplIjogNTAwMDAwMDAwLCAib3ZlcmxhcF9jb21tIjogdHJ1ZSwgInJlZHVjZV9zY2F0dGVyIjogdHJ1ZSwgInJlZHVjZV9idWNrZXRfc2l6ZSI6IDUwMDAwMDAwMCwgImNvbnRpZ3VvdXNfZ3JhZGllbnRzIjogdHJ1ZX0sICJ3YWxsX2Nsb2NrX2JyZWFrZG93biI6IHRydWUsICJwcmVjaXNpb24iOiAiZnAxNiIsICJudW1fbGF5ZXJzIjogMjQsICJoaWRkZW5fc2l6ZSI6IDIwNDgsICJudW1fYXR0ZW50aW9uX2hlYWRzIjogMTYsICJzZXFfbGVuZ3RoIjogMjA0OCwgIm1heF9wb3NpdGlvbl9lbWJlZGRpbmdzIjogMjA0OCwgInBvc19lbWIiOiAicm90YXJ5IiwgIm5vX3dlaWdodF90eWluZyI6IHRydWUsICJhdHRlbnRpb25fY29uZmlnIjogWyJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCIsICJmbGFzaCJdLCAic3BhcnNpdHlfY29uZmlnIjoge30sICJpbml0X21ldGhvZCI6ICJzbWFsbF9pbml0IiwgIm91dHB1dF9sYXllcl9pbml0X21ldGhvZCI6ICJ3YW5nX2luaXQiLCAibHJfZGVjYXlfc3R5bGUiOiAiY29zaW5lIiwgImxyX2RlY2F5X2l0ZXJzIjogMzIwMDAwLCAibWluX2xyIjogMmUtMDUsICJvcHRpbWl6ZXJfdHlwZSI6ICJBZGFtIiwgInplcm9fc3RhZ2UiOiAxLCAiemVyb19yZWR1Y2Vfc2NhdHRlciI6IHRydWUsICJ6ZXJvX2NvbnRpZ3VvdXNfZ3JhZGllbnRzIjogdHJ1ZSwgInplcm9fcmVkdWNlX2J1Y2tldF9zaXplIjogNTAwMDAwMDAwLCAiemVyb19hbGxnYXRoZXJfYnVja2V0X3NpemUiOiA1MDAwMDAwMDAsICJsciI6IDAuMDAwMiwgImRhdGFfcGF0aCI6ICJkYXRhL2Vud2lrOC9lbndpazhfdGV4dF9kb2N1bWVudCIsICJkYXRhX2ltcGwiOiAibW1hcCIsICJzYXZlIjogImNoZWNrcG9pbnRzIiwgImNvbmZpZ19maWxlcyI6IHsiMS0zQi55bWwiOiAiIyBHUFQtMiBwcmV0cmFpbmluZyBzZXR1cFxue1xuICAgIyBwYXJhbGxlbGlzbSBzZXR0aW5ncyAoIHlvdSB3aWxsIHdhbnQgdG8gY2hhbmdlIHRoZXNlIGJhc2VkIG9uIHlvdXIgY2x1c3RlciBzZXR1cCwgaWRlYWxseSBzY2hlZHVsaW5nIHBpcGVsaW5lIHN0YWdlc1xuICAgIyBhY3Jvc3MgdGhlIG5vZGUgYm91bmRhcmllcyApXG4gICBcInBpcGVfcGFyYWxsZWxfc2l6ZVwiOiAwLFxuICAgXCJtb2RlbF9wYXJhbGxlbF9zaXplXCI6IDEsXG5cbiAgICMgbW9kZWwgc2V0dGluZ3NcbiAgIFwibnVtX2xheWVyc1wiOiAyNCxcbiAgIFwiaGlkZGVuX3NpemVcIjogMjA0OCxcbiAgIFwibnVtX2F0dGVudGlvbl9oZWFkc1wiOiAxNixcbiAgIFwic2VxX2xlbmd0aFwiOiAyMDQ4LFxuICAgXCJtYXhfcG9zaXRpb25fZW1iZWRkaW5nc1wiOiAyMDQ4LFxuICAgXCJub3JtXCI6IFwibGF5ZXJub3JtXCIsXG4gICBcInBvc19lbWJcIjogXCJyb3RhcnlcIixcbiAgIFwibm9fd2VpZ2h0X3R5aW5nXCI6IHRydWUsXG4gICBcImdwdF9qX3Jlc2lkdWFsXCI6IGZhbHNlLFxuICAgXCJvdXRwdXRfbGF5ZXJfcGFyYWxsZWxpc21cIjogXCJjb2x1bW5cIixcblxuICAgIyB0aGVzZSBzaG91bGQgcHJvdmlkZSBzb21lIHNwZWVkdXAgYnV0IHRha2VzIGEgd2hpbGUgdG8gYnVpbGQsIHNldCB0byB0cnVlIGlmIGRlc2lyZWRcbiAgIFwic2NhbGVkX3VwcGVyX3RyaWFuZ19tYXNrZWRfc29mdG1heF9mdXNpb25cIjogZmFsc2UsXG4gICBcImJpYXNfZ2VsdV9mdXNpb25cIjogZmFsc2UsXG4gICBcInJvcGVfZnVzaW9uXCI6IGZhbHNlLFxuICAgXCJsYXllcm5vcm1fZnVzaW9uXCI6IGZhbHNlLFxuXG4gICAjIGluaXQgbWV0aG9kc1xuICAgXCJpbml0X21ldGhvZFwiOiBcInNtYWxsX2luaXRcIixcbiAgIFwib3V0cHV0X2xheWVyX2luaXRfbWV0aG9kXCI6IFwid2FuZ19pbml0XCIsXG5cbiAgICMgb3B0aW1pemVyIHNldHRpbmdzXG4gICBcIm9wdGltaXplclwiOiB7XG4gICAgIFwidHlwZVwiOiBcIkFkYW1cIixcbiAgICAgXCJwYXJhbXNcIjoge1xuICAgICAgIFwibHJcIjogMC4wMDAyLFxuICAgICAgIFwiYmV0YXNcIjogWzAuOSwgMC45NV0sXG4gICAgICAgXCJlcHNcIjogIDEuMGUtOCxcbiAgICAgfVxuICAgfSxcbiAgIFwibWluX2xyXCI6IDAuMDAwMDIsXG5cbiAgICMgZm9yIGFsbCB6ZXJvX29wdGltaXphdGlvbiBvcHRpb25zLCBzZWUgaHR0cHM6Ly93d3cuZGVlcHNwZWVkLmFpL2RvY3MvY29uZmlnLWpzb24vI3plcm8tb3B0aW1pemF0aW9ucy1mb3ItZnAxNi10cmFpbmluZ1xuICAgXCJ6ZXJvX29wdGltaXphdGlvblwiOiB7XG4gICAgXCJzdGFnZVwiOiAxLFxuICAgIFwiYWxsZ2F0aGVyX3BhcnRpdGlvbnNcIjogVHJ1ZSxcbiAgICBcImFsbGdhdGhlcl9idWNrZXRfc2l6ZVwiOiA1MDAwMDAwMDAsXG4gICAgXCJvdmVybGFwX2NvbW1cIjogVHJ1ZSxcbiAgICBcInJlZHVjZV9zY2F0dGVyXCI6IFRydWUsXG4gICAgXCJyZWR1Y2VfYnVja2V0X3NpemVcIjogNTAwMDAwMDAwLFxuICAgIFwiY29udGlndW91c19ncmFkaWVudHNcIjogVHJ1ZSxcbiAgfSxcblxuICAgIyBiYXRjaCAvIGRhdGEgc2V0dGluZ3NcbiAgIFwidHJhaW5fbWljcm9fYmF0Y2hfc2l6ZV9wZXJfZ3B1XCI6IDgwLFxuICAgXCJkYXRhX2ltcGxcIjogXCJtbWFwXCIsXG5cbiAgICMgYWN0aXZhdGlvbiBjaGVja3BvaW50aW5nXG4gICBcImNoZWNrcG9pbnRfYWN0aXZhdGlvbnNcIjogdHJ1ZSxcbiAgIFwiY2hlY2twb2ludF9udW1fbGF5ZXJzXCI6IDEsXG4gICBcInBhcnRpdGlvbl9hY3RpdmF0aW9uc1wiOiB0cnVlLFxuICAgXCJzeW5jaHJvbml6ZV9lYWNoX2xheWVyXCI6IHRydWUsXG5cbiAgICMgcmVndWxhcml6YXRpb25cbiAgIFwiZ3JhZGllbnRfY2xpcHBpbmdcIjogMS4wLFxuICAgXCJ3ZWlnaHRfZGVjYXlcIjogMC4xLFxuICAgXCJoaWRkZW5fZHJvcG91dFwiOiAwLFxuICAgXCJhdHRlbnRpb25fZHJvcG91dFwiOiAwLFxuXG4gICAjIEZsYXNoIEF0dGVudGlvblxuICAgXCJhdHRlbnRpb25fY29uZmlnXCI6IFtbW1wiZmxhc2hcIl0sIDI0XV0sXG5cbiAgICMgcHJlY2lzaW9uIHNldHRpbmdzXG4gICBcImZwMTZcIjoge1xuICAgICBcImZwMTZcIjogdHJ1ZSxcbiAgICAgXCJlbmFibGVkXCI6IHRydWUsXG4gICAgIFwibG9zc19zY2FsZVwiOiAwLFxuICAgICBcImxvc3Nfc2NhbGVfd2luZG93XCI6IDEwMDAsXG4gICAgIFwiaHlzdGVyZXNpc1wiOiAyLFxuICAgICBcIm1pbl9sb3NzX3NjYWxlXCI6IDFcbiAgIH0sXG5cbiAgICMgbWlzYy4gdHJhaW5pbmcgc2V0dGluZ3NcbiAgIFwidHJhaW5faXRlcnNcIjogMzIwMDAwLFxuICAgXCJscl9kZWNheV9pdGVyc1wiOiAzMjAwMDAsXG4gICBcImRpc3RyaWJ1dGVkX2JhY2tlbmRcIjogXCJuY2NsXCIsXG4gICBcImxyX2RlY2F5X3N0eWxlXCI6IFwiY29zaW5lXCIsXG4gICBcIndhcm11cFwiOiAwLjAxLFxuICAgXCJjaGVja3BvaW50X2ZhY3RvclwiOiAxMDAwMCxcbiAgIFwiZXZhbF9pbnRlcnZhbFwiOiAxMDAwLFxuICAgXCJldmFsX2l0ZXJzXCI6IDEwLFxuXG4gICAjIGxvZ2dpbmdcbiAgIFwibG9nX2ludGVydmFsXCI6IDEwLFxuICAgXCJzdGVwc19wZXJfcHJpbnRcIjogMTAsXG4gICBcImtlZXBfbGFzdF9uX2NoZWNrcG9pbnRzXCI6IDQsXG4gICBcIndhbGxfY2xvY2tfYnJlYWtkb3duXCI6IHRydWUsXG59XG4iLCAibG9jYWxfc2V0dXBfd2FuZGJfbW9kaWZpZWQueW1sIjogIiMgU3VnZ2VzdGVkIGRhdGEgcGF0aHMgd2hlbiB1c2luZyBHUFQtTmVvWCBsb2NhbGx5XG57XG4gIFwiZGF0YV9wYXRoXCI6IFwiZGF0YS9lbndpazgvZW53aWs4X3RleHRfZG9jdW1lbnRcIixcblxuICAjIG9yIGZvciB3ZWlnaHRlZCBkYXRhc2V0czpcbiAgIyBcInRyYWluLWRhdGEtcGF0aHNcIjogW1wiZGF0YS9lbndpazgvZW53aWs4X3RleHRfZG9jdW1lbnRcIiwgXCJkYXRhL2Vud2lrOC9lbndpazhfdGV4dF9kb2N1bWVudFwiXSxcbiAgIyBcInRlc3QtZGF0YS1wYXRoc1wiOiBbXCJkYXRhL2Vud2lrOC9lbndpazhfdGV4dF9kb2N1bWVudFwiLCBcImRhdGEvZW53aWs4L2Vud2lrOF90ZXh0X2RvY3VtZW50XCJdLFxuICAjIFwidmFsaWQtZGF0YS1wYXRoc1wiOiBbXCJkYXRhL2Vud2lrOC9lbndpazhfdGV4dF9kb2N1bWVudFwiLCBcImRhdGEvZW53aWs4L2Vud2lrOF90ZXh0X2RvY3VtZW50XCJdLFxuICAjIFwidHJhaW4tZGF0YS13ZWlnaHRzXCI6IFsxLiwgMi5dLFxuICAjIFwidGVzdC1kYXRhLXdlaWdodHNcIjogWzIuLCAxLl0sXG4gICMgXCJ2YWxpZC1kYXRhLXdlaWdodHNcIjogWzAuNSwgMC40XSxcblxuICAjIElmIHdlaWdodF9ieV9udW1fZG9jdW1lbnRzIGlzIFRydWUsIEJ1aWxkcyBkYXRhc2V0IHdlaWdodHMgZnJvbSBhIG11bHRpbm9taWFsIGRpc3RyaWJ1dGlvbiBvdmVyIGdyb3VwcyBvZiBkYXRhIGFjY29yZGluZyB0byB0aGUgbnVtYmVyIG9mIGRvY3VtZW50cyBpbiBlYWNoIGdyb3VwLlxuICAjIFdBUk5JTkc6IHNldHRpbmcgdGhpcyB0byBUcnVlIHdpbGwgb3ZlcnJpZGUgYW55IHVzZXIgcHJvdmlkZWQgd2VpZ2h0c1xuICAjIFwid2VpZ2h0X2J5X251bV9kb2N1bWVudHNcIjogZmFsc2UsXG4gICMgXCJ3ZWlnaHRlZF9zYW1wbGVyX2FscGhhXCI6IDAuMyxcblxuICBcInZvY2FiX2ZpbGVcIjogXCJkYXRhL2dwdDItdm9jYWIuanNvblwiLFxuICBcIm1lcmdlX2ZpbGVcIjogXCJkYXRhL2dwdDItbWVyZ2VzLnR4dFwiLFxuXG4gIFwic2F2ZVwiOiBcImNoZWNrcG9pbnRzXCIsXG4gIFwibG9hZFwiOiBcImNoZWNrcG9pbnRzXCIsXG4gIFwiY2hlY2twb2ludF92YWxpZGF0aW9uX3dpdGhfZm9yd2FyZF9wYXNzXCI6IEZhbHNlLFxuXG4gIFwidGVuc29yYm9hcmRfZGlyXCI6IFwidGVuc29yYm9hcmRcIixcbiAgXCJsb2dfZGlyXCI6IFwibG9nc1wiLFxuICBcInVzZV93YW5kYlwiOiBUcnVlLFxuICBcIndhbmRiX2hvc3RcIjogXCJodHRwczovL2FwaS53YW5kYi5haVwiLFxuICBcIndhbmRiX3Byb2plY3RcIjogXCJuZW94XCIsXG4gIFwid2FuZGJfcnVuX25hbWVcIjogXCIxLjNCLUZBLUJTLTgwLTF4OHhBMTAwLU5vLVBpcGVcIixcblxuICBcInBlYWtfdGhlb3JldGljYWxfdGZsb3BzXCI6IDMxMlxufVxuIn0sICJsb2FkIjogImNoZWNrcG9pbnRzIiwgImNoZWNrcG9pbnRfZmFjdG9yIjogMTAwMDAsICJiYXRjaF9zaXplIjogODAsICJ0cmFpbl9pdGVycyI6IDMyMDAwMCwgImV2YWxfaXRlcnMiOiAxMCwgImtlZXBfbGFzdF9uX2NoZWNrcG9pbnRzIjogNCwgInZvY2FiX2ZpbGUiOiAiZGF0YS9ncHQyLXZvY2FiLmpzb24iLCAibWVyZ2VfZmlsZSI6ICJkYXRhL2dwdDItbWVyZ2VzLnR4dCIsICJjaGVja3BvaW50X2FjdGl2YXRpb25zIjogdHJ1ZSwgInN5bmNocm9uaXplX2VhY2hfbGF5ZXIiOiB0cnVlLCAicGFydGl0aW9uX2FjdGl2YXRpb25zIjogdHJ1ZSwgImR5bmFtaWNfbG9zc19zY2FsZSI6IHRydWUsICJ3b3JsZF9zaXplIjogMSwgInVzZV93YW5kYiI6IHRydWUsICJ3YW5kYl9ncm91cCI6ICJnNzN5d2gxb19pa3lqYTA4eCIsICJ3YW5kYl9ydW5fbmFtZSI6ICIxLjNCLUZBLUJTLTgwLTF4OHhBMTAwLU5vLVBpcGUiLCAibG9nX2RpciI6ICJsb2dzIiwgInRlbnNvcmJvYXJkX2RpciI6ICJ0ZW5zb3Jib2FyZCIsICJwZWFrX3RoZW9yZXRpY2FsX3RmbG9wcyI6IDMxMiwgImxvZ19pbnRlcnZhbCI6IDEwLCAidGV4dF9nZW5fdHlwZSI6ICJ1bmNvbmRpdGlvbmFsIiwgImxvY2FsX3JhbmsiOiAwLCAicmFuayI6IDAsICJ1c2VyX3NjcmlwdCI6ICJ0cmFpbi5weSIsICJnbG9iYWxfbnVtX2dwdXMiOiA4fQ==
[2025-01-06 10:33:03,648] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:14,232] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2025-01-06 10:33:14,232] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2025-01-06 10:33:14,232] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2025-01-06 10:33:14,233] [INFO] [launch.py:163:main] dist_world_size=8
[2025-01-06 10:33:14,233] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2025-01-06 10:33:21,962] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,965] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,979] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,982] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,989] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,992] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,992] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-01-06 10:33:21,992] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mambaUnable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba

Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
Unable to import Mamba kernels. Install them from our requirements/requirements-mamba.txt,     or directly from https://github.com/state-spaces/mamba
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3

For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transferFor s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer

For s3 checkpointing, please install boto3 either using requirements/requirements-s3.txt or https://github.com/boto/boto3
For s3 checkpointing, please install hf_transfer either using requirements/requirements-s3.txt or https://github.com/huggingface/hf_transfer
NeoXArgs.configure_distributed_args() using world size: 8 and model-parallel size: 1 
> building GPT2BPETokenizer tokenizer ...
 > padded vocab (size: 50257) with 47 dummy tokens (new size: 50304)
WARNING: TensorBoard writing requested but is not available (are you using PyTorch 1.1.0 or later and do you have tensorboard installed?), no TensorBoard logs will be written.
[2025-01-06 10:33:35,579] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,581] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,586] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,588] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,595] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,601] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:35,604] [INFO] [comm.py:637:init_distributed] cdb=None
> initializing torch distributed ...
[2025-01-06 10:33:37,712] [INFO] [comm.py:637:init_distributed] cdb=None
[2025-01-06 10:33:37,712] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
> initializing model parallel with size 1
MPU DP: [0, 1, 2, 3, 4, 5, 6, 7]
MPU PP: [0]
MPU PP: [1]
MPU PP: [2]
MPU PP: [3]
MPU PP: [4]
MPU PP: [5]
MPU PP: [6]
MPU PP: [7]
MPU MP: [0]
MPU MP: [1]
MPU MP: [2]
MPU MP: [3]
MPU MP: [4]
MPU MP: [5]
MPU MP: [6]
MPU MP: [7]
> setting random seeds to 1234 ...
[2025-01-06 10:33:39,777] [INFO] [checkpointing.py:227:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
make: Entering directory '/NS/llm-pretraining/work/afkhan/USC_Colab/gpt-neox/megatron/data'
make: Nothing to be done for 'default'.
make: Leaving directory '/NS/llm-pretraining/work/afkhan/USC_Colab/gpt-neox/megatron/data'
> building train, validation, and test datasets ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > dataset split:
    train:
     document indices in [0, 1) total of 1 documents
    validation:
     document indices in [1, 1) total of 0 documents
    test:
     document indices in [1, 1) total of 0 documents
 > WARNING: could not find index map files, building the indices on rank 0 ...
 > elapsed time to build and save doc-idx mapping (seconds): 0.012978
    using:
     number of documents:       1
     number of epochs:          15131
     sequence length:           2048
     total number of samples:   204803463
 > elapsed time to build and save sample-idx mapping (seconds): 10.012829
 > elapsed time to build and save shuffle-idx mapping (seconds): 13.889172
 > loading doc-idx mapping from data/enwik8/enwik8_text_document_train_indexmap_204800000ns_2048sl_1234s_packedpi_ac_doc_idx.npy
 > loading sample-idx mapping from data/enwik8/enwik8_text_document_train_indexmap_204800000ns_2048sl_1234s_packedpi_ac_sample_idx.npy
 > loading shuffle-idx mapping from data/enwik8/enwik8_text_document_train_indexmap_204800000ns_2048sl_1234s_packedpi_ac_shuffle_idx.npy
    loaded indexed file in 0.102 seconds
    total number of samples: 204803464
    total number of epochs: 15131
building GPT2 model ...
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0, model=0): 0, ProcessCoord(pipe=0, data=1, model=0): 1, ProcessCoord(pipe=0, data=2, model=0): 2, ProcessCoord(pipe=0, data=3, model=0): 3, ProcessCoord(pipe=0, data=4, model=0): 4, ProcessCoord(pipe=0, data=5, model=0): 5, ProcessCoord(pipe=0, data=6, model=0): 6, ProcessCoord(pipe=0, data=7, model=0): 7}
[2025-01-06 10:34:07,350] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:transformer|mlp
stage=0 layers=29
     0: EmbeddingPipe
     1: _pre_transformer_block
     2: ParallelTransformerLayerPipe
     3: ParallelTransformerLayerPipe
     4: ParallelTransformerLayerPipe
     5: ParallelTransformerLayerPipe
     6: ParallelTransformerLayerPipe
     7: ParallelTransformerLayerPipe
     8: ParallelTransformerLayerPipe
     9: ParallelTransformerLayerPipe
    10: ParallelTransformerLayerPipe
    11: ParallelTransformerLayerPipe
    12: ParallelTransformerLayerPipe
    13: ParallelTransformerLayerPipe
    14: ParallelTransformerLayerPipe
    15: ParallelTransformerLayerPipe
    16: ParallelTransformerLayerPipe
    17: ParallelTransformerLayerPipe
    18: ParallelTransformerLayerPipe
    19: ParallelTransformerLayerPipe
    20: ParallelTransformerLayerPipe
    21: ParallelTransformerLayerPipe
    22: ParallelTransformerLayerPipe
    23: ParallelTransformerLayerPipe
    24: ParallelTransformerLayerPipe
    25: ParallelTransformerLayerPipe
    26: _post_transformer_block
    27: NormPipe
    28: ParallelLinearPipe
  loss: partial
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
Configuring Optimizer type: Adam with params: {'lr': 0.0002, 'betas': [0.9, 0.95], 'eps': 1e-08}
WARNING: APEX not installed - defaulting to deepspeed's fused adam
WARNING: APEX not installed - defaulting to deepspeed's fused adam
ninja: no work to do.
Time to load fused_adam op: 8.75899863243103 seconds
Time to load fused_adam op: 8.84139084815979 seconds
Time to load fused_adam op: 8.840434074401855 seconds
Time to load fused_adam op: 8.84412145614624 seconds
Time to load fused_adam op: 8.843689680099487 seconds
Time to load fused_adam op: 8.845224142074585 seconds
Time to load fused_adam op: 8.848340511322021 seconds
Time to load fused_adam op: 8.84970998764038 seconds
> learning rate decay style: cosine
DeepSpeed is enabled.
[2025-01-06 10:34:49,610] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.4+02e2ebf, git-hash=02e2ebf, git-branch=HEAD
[2025-01-06 10:34:49,653] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2025-01-06 10:34:49,654] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2025-01-06 10:34:49,654] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-01-06 10:34:49,662] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-01-06 10:34:49,662] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-01-06 10:34:49,662] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 1 optimizer
[2025-01-06 10:34:49,662] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-01-06 10:34:49,662] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-01-06 10:34:49,662] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-01-06 10:34:49,662] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-01-06 10:35:00,025] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2025-01-06 10:35:00,025] [INFO] [utils.py:803:see_memory_usage] MA 3.3 GB         Max_MA 3.3 GB         CA 3.3 GB         Max_CA 3 GB 
[2025-01-06 10:35:00,025] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 21.21 GB, percent = 1.1%
[2025-01-06 10:35:00,110] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2025-01-06 10:35:00,110] [INFO] [utils.py:803:see_memory_usage] MA 4.61 GB         Max_MA 5.27 GB         CA 5.28 GB         Max_CA 5 GB 
[2025-01-06 10:35:00,111] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 21.21 GB, percent = 1.1%
[2025-01-06 10:35:00,111] [INFO] [stage_1_and_2.py:517:__init__] optimizer state initialized
[2025-01-06 10:35:00,191] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2025-01-06 10:35:00,191] [INFO] [utils.py:803:see_memory_usage] MA 4.61 GB         Max_MA 4.61 GB         CA 5.28 GB         Max_CA 5 GB 
[2025-01-06 10:35:00,191] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 21.21 GB, percent = 1.1%
[2025-01-06 10:35:00,193] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = FusedAdam
[2025-01-06 10:35:00,193] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2025-01-06 10:35:00,193] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.AnnealingLR object at 0x7f2aca232410>
[2025-01-06 10:35:00,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0, 0.0], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:35:00,193] [INFO] [config.py:979:print] DeepSpeedEngine configuration:
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   amp_enabled .................. False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   amp_params ................... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   bfloat16_enabled ............. False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   checkpoint_parallel_write_pipeline  False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   checkpoint_tag_validation_enabled  True
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   checkpoint_tag_validation_fail  False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f299c78ccd0>
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   communication_data_type ...... None
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   curriculum_enabled_legacy .... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   curriculum_params_legacy ..... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   data_efficiency_enabled ...... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   dataloader_drop_last ......... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   disable_allgather ............ False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   dump_state ................... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_enabled ........... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_gas_boundary_resolution  1
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_layer_num ......... 0
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_max_iter .......... 100
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_stability ......... 1e-06
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_tol ............... 0.01
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   eigenvalue_verbose ........... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   elasticity_enabled ........... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   fp16_auto_cast ............... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   fp16_enabled ................. True
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   fp16_master_weights_and_gradients  False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   global_rank .................. 0
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   grad_accum_dtype ............. None
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   gradient_accumulation_steps .. 1
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   gradient_clipping ............ 0.0
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   gradient_predivide_factor .... 1.0
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   initial_dynamic_scale ........ 65536
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   load_universal_checkpoint .... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   loss_scale ................... 0
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   memory_breakdown ............. False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   mics_hierarchial_params_gather  False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   mics_shard_size .............. -1
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   optimizer_legacy_fusion ...... False
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   optimizer_name ............... adam
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   optimizer_params ............. {'lr': 0.0002, 'betas': [0.9, 0.95], 'eps': 1e-08}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-01-06 10:35:00,194] [INFO] [config.py:983:print]   pld_enabled .................. False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   pld_params ................... False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   prescale_gradients ........... False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   scheduler_name ............... None
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   scheduler_params ............. None
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   seq_parallel_communication_data_type  torch.float32
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   sparse_attention ............. None
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   sparse_gradients_enabled ..... False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   steps_per_print .............. 10
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   train_batch_size ............. 640
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   train_micro_batch_size_per_gpu  80
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   use_data_before_expert_parallel_  False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   use_node_local_storage ....... False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   wall_clock_breakdown ......... True
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   weight_quantization_config ... None
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   world_size ................... 8
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   zero_allow_untested_optimizer  False
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   zero_config .................. stage=1 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   zero_enabled ................. True
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   zero_force_ds_cpu_optimizer .. True
[2025-01-06 10:35:00,195] [INFO] [config.py:983:print]   zero_optimization_stage ...... 1
[2025-01-06 10:35:00,195] [INFO] [config.py:969:print_user_config]   json = {
    "train_batch_size": 640, 
    "train_micro_batch_size_per_gpu": 80, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.0002, 
            "betas": [0.9, 0.95], 
            "eps": 1e-08
        }
    }, 
    "fp16": {
        "fp16": true, 
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "zero_optimization": {
        "stage": 1, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 5.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 5.000000e+08, 
        "contiguous_gradients": true
    }, 
    "wall_clock_breakdown": true
}
 > number of parameters on model parallel rank 0: 1414647808
 > total params: 1,414,647,808[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.

[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
Unable to load checkpoint.[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.

Loading checkpoint and starting from iteration 0[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.

[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
[2025-01-06 10:35:02,436] [WARNING] [engine.py:2703:load_checkpoint] Unable to find latest file at checkpoints/latest, if trying to load latest checkpoint please ensure this file exists or pass an explicit checkpoint tag when loading a checkpoint.
setting training data start iteration to 0
done with setups ...
time (ms) | train/valid/test data loaders: 27203.96 | model and optimizer: 55092.09 | train/valid/test data iterators: 272.92
training ...
[2025-01-06 10:35:02,947] [INFO] [checkpointing.py:540:forward] Activation Checkpointing Information
[2025-01-06 10:35:02,947] [INFO] [checkpointing.py:541:forward] ----Partition Activations True, CPU CHECKPOINTING False
[2025-01-06 10:35:02,947] [INFO] [checkpointing.py:542:forward] ----contiguous Memory Checkpointing False with 24 total layers
[2025-01-06 10:35:02,947] [INFO] [checkpointing.py:544:forward] ----Synchronization True
[2025-01-06 10:35:02,947] [INFO] [checkpointing.py:545:forward] ----Profiling time in checkpointing False
[2025-01-06 10:35:17,373] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.46 | optimizer_gradients: 2.59 | optimizer_step: 4.36
[2025-01-06 10:35:17,373] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 3305.77 | bwd_microstep: 9903.10 | bwd_inner_microstep: 9419.92 | bwd_allreduce_microstep: 483.13 | step_microstep: 187.23
[2025-01-06 10:35:17,373] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 3305.76 | bwd: 9903.08 | bwd_inner: 9419.90 | bwd_allreduce: 483.13 | step: 187.23
[2025-01-06 10:35:32,812] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.52 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:35:32,813] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2891.66 | bwd_microstep: 9366.70 | bwd_inner_microstep: 8971.82 | bwd_allreduce_microstep: 394.85 | step_microstep: 175.28
[2025-01-06 10:35:32,813] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2891.61 | bwd: 9366.69 | bwd_inner: 8971.81 | bwd_allreduce: 394.84 | step: 175.28
[2025-01-06 10:35:45,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.66 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:35:45,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2896.29 | bwd_microstep: 9652.79 | bwd_inner_microstep: 9011.17 | bwd_allreduce_microstep: 641.57 | step_microstep: 172.48
[2025-01-06 10:35:45,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2896.28 | bwd: 9652.77 | bwd_inner: 9011.16 | bwd_allreduce: 641.56 | step: 172.48
[2025-01-06 10:35:58,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.46 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 10:35:58,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2902.76 | bwd_microstep: 9752.06 | bwd_inner_microstep: 9044.38 | bwd_allreduce_microstep: 707.64 | step_microstep: 172.22
[2025-01-06 10:35:58,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2902.75 | bwd: 9752.05 | bwd_inner: 9044.38 | bwd_allreduce: 707.64 | step: 172.22
[2025-01-06 10:36:12,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.18 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:36:12,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2913.93 | bwd_microstep: 9690.16 | bwd_inner_microstep: 9016.41 | bwd_allreduce_microstep: 673.71 | step_microstep: 166.06
[2025-01-06 10:36:12,010] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2913.92 | bwd: 9690.15 | bwd_inner: 9016.41 | bwd_allreduce: 673.70 | step: 166.06
[2025-01-06 10:36:25,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.53 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 10:36:25,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2919.57 | bwd_microstep: 9717.89 | bwd_inner_microstep: 9041.13 | bwd_allreduce_microstep: 676.72 | step_microstep: 172.47
[2025-01-06 10:36:25,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2919.55 | bwd: 9717.88 | bwd_inner: 9041.12 | bwd_allreduce: 676.72 | step: 172.47
[2025-01-06 10:36:38,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.14 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:36:38,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2924.27 | bwd_microstep: 9752.30 | bwd_inner_microstep: 9066.41 | bwd_allreduce_microstep: 685.86 | step_microstep: 164.94
[2025-01-06 10:36:38,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2924.25 | bwd: 9752.29 | bwd_inner: 9066.40 | bwd_allreduce: 685.85 | step: 164.94
[2025-01-06 10:36:51,390] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.33 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 10:36:51,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2930.28 | bwd_microstep: 9736.69 | bwd_inner_microstep: 9078.51 | bwd_allreduce_microstep: 658.14 | step_microstep: 168.04
[2025-01-06 10:36:51,391] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2930.27 | bwd: 9736.68 | bwd_inner: 9078.50 | bwd_allreduce: 658.14 | step: 168.04
[2025-01-06 10:37:04,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.14 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 10:37:04,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2928.59 | bwd_microstep: 9721.14 | bwd_inner_microstep: 9070.97 | bwd_allreduce_microstep: 650.12 | step_microstep: 171.02
[2025-01-06 10:37:04,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2928.58 | bwd: 9721.13 | bwd_inner: 9070.96 | bwd_allreduce: 650.12 | step: 171.02
[2025-01-06 10:37:17,711] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.04 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 10:37:17,712] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[6.25e-07, 6.25e-07], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:37:17,712] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=49.11352225769393, CurrSamplesPerSec=48.86252562190603, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:37:17,712] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2930.32 | bwd_microstep: 9776.71 | bwd_inner_microstep: 9099.52 | bwd_allreduce_microstep: 677.14 | step_microstep: 173.19
[2025-01-06 10:37:17,712] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2930.31 | bwd: 9776.69 | bwd_inner: 9099.51 | bwd_allreduce: 677.14 | step: 173.19
 samples/sec: 47.407 | iteration       10/  320000 | elapsed time per iteration (ms): 13500.2 | learning rate: 6.250E-07 | approx flops per GPU: 144.3TFLOPS | MFU: 34.69% | HFU: 46.26% | lm_loss: 1.071999E+01 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
after 10 iterations memory (MB) | allocated: 4739.6943359375 | max allocated: 68558.86669921875 | reserved: 73690.0 | max reserved: 73690.0
time (ms) | forward: 3332.98 | backward: 9707.84 | backward-backward: 9707.79 | backward-allreduce: 0.00 | optimizer: 172.65 | batch generator: 74.27
[2025-01-06 10:37:30,933] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.34 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 10:37:30,933] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2932.00 | bwd_microstep: 9822.72 | bwd_inner_microstep: 9111.41 | bwd_allreduce_microstep: 711.27 | step_microstep: 174.21
[2025-01-06 10:37:30,934] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.99 | bwd: 9822.71 | bwd_inner: 9111.40 | bwd_allreduce: 711.27 | step: 174.21
[2025-01-06 10:37:44,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.53 | optimizer_gradients: 2.58 | optimizer_step: 4.36
[2025-01-06 10:37:44,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2935.15 | bwd_microstep: 9850.51 | bwd_inner_microstep: 9141.75 | bwd_allreduce_microstep: 708.71 | step_microstep: 163.36
[2025-01-06 10:37:44,157] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2935.14 | bwd: 9850.49 | bwd_inner: 9141.74 | bwd_allreduce: 708.71 | step: 163.36
[2025-01-06 10:37:57,348] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.24 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:37:57,348] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2938.78 | bwd_microstep: 9750.28 | bwd_inner_microstep: 9123.21 | bwd_allreduce_microstep: 627.02 | step_microstep: 166.05
[2025-01-06 10:37:57,348] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2938.77 | bwd: 9750.26 | bwd_inner: 9123.20 | bwd_allreduce: 627.02 | step: 166.05
[2025-01-06 10:38:10,539] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.27 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:38:10,540] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2936.97 | bwd_microstep: 9782.39 | bwd_inner_microstep: 9130.07 | bwd_allreduce_microstep: 652.27 | step_microstep: 167.06
[2025-01-06 10:38:10,540] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2936.97 | bwd: 9782.37 | bwd_inner: 9130.06 | bwd_allreduce: 652.27 | step: 167.06
[2025-01-06 10:38:23,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.73 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:38:23,720] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2936.31 | bwd_microstep: 9768.11 | bwd_inner_microstep: 9132.76 | bwd_allreduce_microstep: 635.31 | step_microstep: 163.50
[2025-01-06 10:38:23,720] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2936.29 | bwd: 9768.10 | bwd_inner: 9132.76 | bwd_allreduce: 635.31 | step: 163.50
[2025-01-06 10:38:36,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.04 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 10:38:36,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2935.29 | bwd_microstep: 9734.61 | bwd_inner_microstep: 9152.20 | bwd_allreduce_microstep: 582.37 | step_microstep: 164.01
[2025-01-06 10:38:36,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2935.28 | bwd: 9734.60 | bwd_inner: 9152.19 | bwd_allreduce: 582.37 | step: 164.01
[2025-01-06 10:38:49,984] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.87 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:38:49,985] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2939.23 | bwd_microstep: 9695.64 | bwd_inner_microstep: 9117.97 | bwd_allreduce_microstep: 577.64 | step_microstep: 170.75
[2025-01-06 10:38:49,985] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2939.21 | bwd: 9695.63 | bwd_inner: 9117.96 | bwd_allreduce: 577.64 | step: 170.75
[2025-01-06 10:39:03,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.89 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:39:03,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2933.68 | bwd_microstep: 9745.49 | bwd_inner_microstep: 9137.67 | bwd_allreduce_microstep: 607.78 | step_microstep: 165.81
[2025-01-06 10:39:03,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2933.67 | bwd: 9745.48 | bwd_inner: 9137.67 | bwd_allreduce: 607.78 | step: 165.81
[2025-01-06 10:39:16,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.57 | optimizer_gradients: 2.56 | optimizer_step: 4.41
[2025-01-06 10:39:16,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.63 | bwd_microstep: 9747.09 | bwd_inner_microstep: 9136.52 | bwd_allreduce_microstep: 610.53 | step_microstep: 165.36
[2025-01-06 10:39:16,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.61 | bwd: 9747.08 | bwd_inner: 9136.52 | bwd_allreduce: 610.53 | step: 165.36
[2025-01-06 10:39:29,489] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.84 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:39:29,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[1.25e-06, 1.25e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:39:29,489] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=48.99162176179517, CurrSamplesPerSec=48.88048626236421, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:39:29,490] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2931.57 | bwd_microstep: 9770.41 | bwd_inner_microstep: 9122.40 | bwd_allreduce_microstep: 647.97 | step_microstep: 174.13
[2025-01-06 10:39:29,490] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.56 | bwd: 9770.40 | bwd_inner: 9122.39 | bwd_allreduce: 647.97 | step: 174.13
 samples/sec: 48.556 | iteration       20/  320000 | elapsed time per iteration (ms): 13180.6 | learning rate: 1.250E-06 | approx flops per GPU: 147.8TFLOPS | MFU: 35.54% | HFU: 47.38% | lm_loss: 9.538532E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3228.10 | backward: 9767.06 | backward-backward: 9767.03 | backward-allreduce: 0.00 | optimizer: 167.78 | batch generator: 73.07
[2025-01-06 10:39:42,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.45 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:39:42,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2930.33 | bwd_microstep: 9742.70 | bwd_inner_microstep: 9153.44 | bwd_allreduce_microstep: 589.23 | step_microstep: 166.15
[2025-01-06 10:39:42,649] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2930.31 | bwd: 9742.69 | bwd_inner: 9153.44 | bwd_allreduce: 589.23 | step: 166.15
[2025-01-06 10:39:55,830] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.99 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 10:39:55,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2934.96 | bwd_microstep: 9774.14 | bwd_inner_microstep: 9146.12 | bwd_allreduce_microstep: 627.99 | step_microstep: 168.77
[2025-01-06 10:39:55,831] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2934.95 | bwd: 9774.13 | bwd_inner: 9146.12 | bwd_allreduce: 627.99 | step: 168.77
[2025-01-06 10:40:08,995] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.57 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:40:08,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2931.11 | bwd_microstep: 9752.08 | bwd_inner_microstep: 9119.16 | bwd_allreduce_microstep: 632.88 | step_microstep: 165.31
[2025-01-06 10:40:08,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.10 | bwd: 9752.07 | bwd_inner: 9119.16 | bwd_allreduce: 632.88 | step: 165.31
[2025-01-06 10:40:22,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.77 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:40:22,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2930.46 | bwd_microstep: 9740.39 | bwd_inner_microstep: 9123.51 | bwd_allreduce_microstep: 616.85 | step_microstep: 169.58
[2025-01-06 10:40:22,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2930.45 | bwd: 9740.38 | bwd_inner: 9123.50 | bwd_allreduce: 616.85 | step: 169.58
[2025-01-06 10:40:35,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.59 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 10:40:35,386] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2932.00 | bwd_microstep: 9827.38 | bwd_inner_microstep: 9145.34 | bwd_allreduce_microstep: 682.00 | step_microstep: 163.64
[2025-01-06 10:40:35,387] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.99 | bwd: 9827.37 | bwd_inner: 9145.34 | bwd_allreduce: 682.00 | step: 163.64
[2025-01-06 10:40:48,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.91 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 10:40:48,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2937.70 | bwd_microstep: 9752.98 | bwd_inner_microstep: 9142.36 | bwd_allreduce_microstep: 610.58 | step_microstep: 169.71
[2025-01-06 10:40:48,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2937.69 | bwd: 9752.97 | bwd_inner: 9142.36 | bwd_allreduce: 610.58 | step: 169.71
[2025-01-06 10:41:01,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.12 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 10:41:01,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2931.28 | bwd_microstep: 9727.25 | bwd_inner_microstep: 9142.58 | bwd_allreduce_microstep: 584.64 | step_microstep: 171.98
[2025-01-06 10:41:01,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.27 | bwd: 9727.24 | bwd_inner: 9142.57 | bwd_allreduce: 584.64 | step: 171.98
[2025-01-06 10:41:14,817] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.99 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:41:14,818] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2932.66 | bwd_microstep: 9749.17 | bwd_inner_microstep: 9114.85 | bwd_allreduce_microstep: 634.29 | step_microstep: 167.89
[2025-01-06 10:41:14,818] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2932.65 | bwd: 9749.17 | bwd_inner: 9114.84 | bwd_allreduce: 634.29 | step: 167.89
[2025-01-06 10:41:27,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.09 | optimizer_gradients: 2.55 | optimizer_step: 4.33
[2025-01-06 10:41:27,997] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2934.51 | bwd_microstep: 9766.60 | bwd_inner_microstep: 9121.97 | bwd_allreduce_microstep: 644.58 | step_microstep: 164.81
[2025-01-06 10:41:27,997] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2934.50 | bwd: 9766.58 | bwd_inner: 9121.96 | bwd_allreduce: 644.58 | step: 164.81
[2025-01-06 10:41:41,172] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.81 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:41:41,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[1.875e-06, 1.875e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:41:41,173] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=48.97171039071592, CurrSamplesPerSec=48.89957979605084, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:41:41,173] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2931.85 | bwd_microstep: 9769.53 | bwd_inner_microstep: 9142.98 | bwd_allreduce_microstep: 626.52 | step_microstep: 168.95
[2025-01-06 10:41:41,173] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2931.83 | bwd: 9769.52 | bwd_inner: 9142.97 | bwd_allreduce: 626.52 | step: 168.96
 samples/sec: 48.607 | iteration       30/  320000 | elapsed time per iteration (ms): 13167.0 | learning rate: 1.875E-06 | approx flops per GPU: 148.0TFLOPS | MFU: 35.57% | HFU: 47.43% | lm_loss: 8.922085E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3227.12 | backward: 9760.53 | backward-backward: 9760.50 | backward-allreduce: 0.00 | optimizer: 168.04 | batch generator: 76.41
[2025-01-06 10:41:54,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.34 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 10:41:54,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.15 | bwd_microstep: 9772.75 | bwd_inner_microstep: 9131.37 | bwd_allreduce_microstep: 641.34 | step_microstep: 165.01
[2025-01-06 10:41:54,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.13 | bwd: 9772.74 | bwd_inner: 9131.36 | bwd_allreduce: 641.34 | step: 165.01
[2025-01-06 10:42:07,526] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.10 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 10:42:07,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2935.04 | bwd_microstep: 9763.86 | bwd_inner_microstep: 9124.51 | bwd_allreduce_microstep: 639.32 | step_microstep: 170.98
[2025-01-06 10:42:07,527] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2935.03 | bwd: 9763.85 | bwd_inner: 9124.50 | bwd_allreduce: 639.31 | step: 170.98
[2025-01-06 10:42:20,718] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.91 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:42:20,718] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2934.23 | bwd_microstep: 9779.31 | bwd_inner_microstep: 9126.27 | bwd_allreduce_microstep: 653.01 | step_microstep: 173.69
[2025-01-06 10:42:20,718] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2934.22 | bwd: 9779.30 | bwd_inner: 9126.26 | bwd_allreduce: 653.01 | step: 173.69
[2025-01-06 10:42:33,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.10 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 10:42:33,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2941.63 | bwd_microstep: 9776.30 | bwd_inner_microstep: 9121.17 | bwd_allreduce_microstep: 655.09 | step_microstep: 172.92
[2025-01-06 10:42:33,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2941.62 | bwd: 9776.29 | bwd_inner: 9121.16 | bwd_allreduce: 655.09 | step: 172.92
[2025-01-06 10:42:47,116] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.92 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:42:47,116] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2935.03 | bwd_microstep: 9787.49 | bwd_inner_microstep: 9138.29 | bwd_allreduce_microstep: 649.16 | step_microstep: 173.66
[2025-01-06 10:42:47,116] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2935.02 | bwd: 9787.48 | bwd_inner: 9138.29 | bwd_allreduce: 649.15 | step: 173.66
[2025-01-06 10:43:00,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.34 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 10:43:00,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2932.31 | bwd_microstep: 9788.23 | bwd_inner_microstep: 9124.01 | bwd_allreduce_microstep: 664.19 | step_microstep: 172.12
[2025-01-06 10:43:00,313] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2932.30 | bwd: 9788.22 | bwd_inner: 9124.01 | bwd_allreduce: 664.19 | step: 172.12
[2025-01-06 10:43:13,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.37 | optimizer_gradients: 2.54 | optimizer_step: 4.34
[2025-01-06 10:43:13,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2930.60 | bwd_microstep: 9752.56 | bwd_inner_microstep: 9130.28 | bwd_allreduce_microstep: 622.24 | step_microstep: 174.17
[2025-01-06 10:43:13,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2930.59 | bwd: 9752.55 | bwd_inner: 9130.27 | bwd_allreduce: 622.24 | step: 174.17
[2025-01-06 10:43:26,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.09 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:43:26,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2941.25 | bwd_microstep: 9772.09 | bwd_inner_microstep: 9152.58 | bwd_allreduce_microstep: 619.47 | step_microstep: 166.97
[2025-01-06 10:43:26,668] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2941.24 | bwd: 9772.08 | bwd_inner: 9152.57 | bwd_allreduce: 619.47 | step: 166.97
[2025-01-06 10:43:39,873] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.49 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:43:39,873] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2945.69 | bwd_microstep: 9800.43 | bwd_inner_microstep: 9157.31 | bwd_allreduce_microstep: 643.08 | step_microstep: 163.20
[2025-01-06 10:43:39,873] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2945.68 | bwd: 9800.42 | bwd_inner: 9157.30 | bwd_allreduce: 643.08 | step: 163.20
[2025-01-06 10:43:53,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.08 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 10:43:53,070] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[2.5e-06, 2.5e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:43:53,071] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=48.93478408087366, CurrSamplesPerSec=48.745951932815885, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:43:53,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2935.85 | bwd_microstep: 9810.04 | bwd_inner_microstep: 9165.75 | bwd_allreduce_microstep: 644.25 | step_microstep: 165.22
[2025-01-06 10:43:53,071] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2935.84 | bwd: 9810.03 | bwd_inner: 9165.74 | bwd_allreduce: 644.25 | step: 165.22
 samples/sec: 48.528 | iteration       40/  320000 | elapsed time per iteration (ms): 13188.3 | learning rate: 2.500E-06 | approx flops per GPU: 147.7TFLOPS | MFU: 35.51% | HFU: 47.35% | lm_loss: 8.563602E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3229.96 | backward: 9780.59 | backward-backward: 9780.55 | backward-allreduce: 0.00 | optimizer: 170.11 | batch generator: 73.99
[2025-01-06 10:44:06,288] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.70 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:44:06,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2941.04 | bwd_microstep: 9840.56 | bwd_inner_microstep: 9139.00 | bwd_allreduce_microstep: 701.52 | step_microstep: 174.48
[2025-01-06 10:44:06,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2941.03 | bwd: 9840.55 | bwd_inner: 9139.00 | bwd_allreduce: 701.52 | step: 174.48
[2025-01-06 10:44:19,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.09 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:44:19,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2944.11 | bwd_microstep: 9838.62 | bwd_inner_microstep: 9152.59 | bwd_allreduce_microstep: 685.98 | step_microstep: 173.87
[2025-01-06 10:44:19,538] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2944.09 | bwd: 9838.60 | bwd_inner: 9152.57 | bwd_allreduce: 685.98 | step: 173.87
[2025-01-06 10:44:32,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.39 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 10:44:32,768] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2939.92 | bwd_microstep: 9853.31 | bwd_inner_microstep: 9157.46 | bwd_allreduce_microstep: 695.82 | step_microstep: 169.16
[2025-01-06 10:44:32,769] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2939.91 | bwd: 9853.31 | bwd_inner: 9157.46 | bwd_allreduce: 695.82 | step: 169.16
[2025-01-06 10:44:45,997] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.01 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 10:44:45,998] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2946.07 | bwd_microstep: 9829.45 | bwd_inner_microstep: 9157.46 | bwd_allreduce_microstep: 671.95 | step_microstep: 173.93
[2025-01-06 10:44:45,998] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2946.06 | bwd: 9829.44 | bwd_inner: 9157.45 | bwd_allreduce: 671.95 | step: 173.93
[2025-01-06 10:44:59,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 147.50 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:44:59,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.64 | bwd_microstep: 9827.07 | bwd_inner_microstep: 9170.41 | bwd_allreduce_microstep: 656.62 | step_microstep: 162.43
[2025-01-06 10:44:59,197] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.63 | bwd: 9827.06 | bwd_inner: 9170.41 | bwd_allreduce: 656.62 | step: 162.43
[2025-01-06 10:45:12,427] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.59 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 10:45:12,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2942.75 | bwd_microstep: 9804.10 | bwd_inner_microstep: 9152.99 | bwd_allreduce_microstep: 651.07 | step_microstep: 167.36
[2025-01-06 10:45:12,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2942.74 | bwd: 9804.09 | bwd_inner: 9152.98 | bwd_allreduce: 651.07 | step: 167.36
[2025-01-06 10:45:25,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.54 | optimizer_gradients: 2.57 | optimizer_step: 4.33
[2025-01-06 10:45:25,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.16 | bwd_microstep: 9832.25 | bwd_inner_microstep: 9150.84 | bwd_allreduce_microstep: 681.37 | step_microstep: 174.35
[2025-01-06 10:45:25,650] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.15 | bwd: 9832.24 | bwd_inner: 9150.84 | bwd_allreduce: 681.37 | step: 174.36
[2025-01-06 10:45:38,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.55 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:45:38,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.85 | bwd_microstep: 9830.66 | bwd_inner_microstep: 9154.71 | bwd_allreduce_microstep: 675.92 | step_microstep: 169.30
[2025-01-06 10:45:38,877] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.83 | bwd: 9830.65 | bwd_inner: 9154.70 | bwd_allreduce: 675.92 | step: 169.30
[2025-01-06 10:45:52,125] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.39 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:45:52,126] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.33 | bwd_microstep: 9831.37 | bwd_inner_microstep: 9155.59 | bwd_allreduce_microstep: 675.74 | step_microstep: 172.11
[2025-01-06 10:45:52,126] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.31 | bwd: 9831.36 | bwd_inner: 9155.58 | bwd_allreduce: 675.74 | step: 172.11
[2025-01-06 10:46:05,350] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.68 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:46:05,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[3.125e-06, 3.125e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:46:05,351] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=48.86517163517268, CurrSamplesPerSec=48.56767636879297, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:46:05,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.51 | bwd_microstep: 9842.54 | bwd_inner_microstep: 9179.38 | bwd_allreduce_microstep: 663.12 | step_microstep: 166.03
[2025-01-06 10:46:05,351] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.50 | bwd: 9842.53 | bwd_inner: 9179.37 | bwd_allreduce: 663.12 | step: 166.03
 samples/sec: 48.366 | iteration       50/  320000 | elapsed time per iteration (ms): 13232.3 | learning rate: 3.125E-06 | approx flops per GPU: 147.2TFLOPS | MFU: 35.40% | HFU: 47.20% | lm_loss: 8.201855E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3215.33 | backward: 9833.20 | backward-backward: 9833.16 | backward-allreduce: 0.00 | optimizer: 170.66 | batch generator: 50.20
[2025-01-06 10:46:18,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.08 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:46:18,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.34 | bwd_microstep: 9813.34 | bwd_inner_microstep: 9166.56 | bwd_allreduce_microstep: 646.74 | step_microstep: 167.87
[2025-01-06 10:46:18,577] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.33 | bwd: 9813.33 | bwd_inner: 9166.56 | bwd_allreduce: 646.74 | step: 167.87
[2025-01-06 10:46:31,838] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.64 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:46:31,838] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2946.98 | bwd_microstep: 9815.63 | bwd_inner_microstep: 9154.15 | bwd_allreduce_microstep: 661.45 | step_microstep: 169.40
[2025-01-06 10:46:31,838] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2946.97 | bwd: 9815.63 | bwd_inner: 9154.14 | bwd_allreduce: 661.45 | step: 169.40
[2025-01-06 10:46:45,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.98 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:46:45,068] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.60 | bwd_microstep: 9798.64 | bwd_inner_microstep: 9169.49 | bwd_allreduce_microstep: 629.11 | step_microstep: 172.85
[2025-01-06 10:46:45,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.58 | bwd: 9798.63 | bwd_inner: 9169.49 | bwd_allreduce: 629.11 | step: 172.85
[2025-01-06 10:46:58,309] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.64 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:46:58,310] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.18 | bwd_microstep: 9847.90 | bwd_inner_microstep: 9169.80 | bwd_allreduce_microstep: 678.06 | step_microstep: 168.95
[2025-01-06 10:46:58,310] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.17 | bwd: 9847.89 | bwd_inner: 9169.80 | bwd_allreduce: 678.06 | step: 168.96
[2025-01-06 10:47:11,565] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.13 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:47:11,566] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2970.12 | bwd_microstep: 9834.57 | bwd_inner_microstep: 9170.00 | bwd_allreduce_microstep: 664.53 | step_microstep: 172.02
[2025-01-06 10:47:11,566] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2970.11 | bwd: 9834.56 | bwd_inner: 9170.00 | bwd_allreduce: 664.53 | step: 172.03
[2025-01-06 10:47:24,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.93 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 10:47:24,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.01 | bwd_microstep: 9858.83 | bwd_inner_microstep: 9152.81 | bwd_allreduce_microstep: 705.98 | step_microstep: 163.64
[2025-01-06 10:47:24,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.00 | bwd: 9858.82 | bwd_inner: 9152.81 | bwd_allreduce: 705.98 | step: 163.64
[2025-01-06 10:47:38,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.81 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 10:47:38,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.08 | bwd_microstep: 9788.73 | bwd_inner_microstep: 9162.24 | bwd_allreduce_microstep: 626.45 | step_microstep: 174.48
[2025-01-06 10:47:38,003] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.07 | bwd: 9788.72 | bwd_inner: 9162.23 | bwd_allreduce: 626.45 | step: 174.48
[2025-01-06 10:47:51,221] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.50 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 10:47:51,221] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.31 | bwd_microstep: 9778.61 | bwd_inner_microstep: 9158.97 | bwd_allreduce_microstep: 619.61 | step_microstep: 173.44
[2025-01-06 10:47:51,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.29 | bwd: 9778.60 | bwd_inner: 9158.96 | bwd_allreduce: 619.61 | step: 173.44
[2025-01-06 10:48:04,447] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.95 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 10:48:04,448] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.64 | bwd_microstep: 9792.63 | bwd_inner_microstep: 9183.10 | bwd_allreduce_microstep: 609.50 | step_microstep: 171.62
[2025-01-06 10:48:04,448] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.63 | bwd: 9792.62 | bwd_inner: 9183.09 | bwd_allreduce: 609.50 | step: 171.62
[2025-01-06 10:48:17,666] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.46 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:48:17,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[3.75e-06, 3.75e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:48:17,666] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=48.82836128034493, CurrSamplesPerSec=48.70183765463626, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:48:17,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.16 | bwd_microstep: 9800.59 | bwd_inner_microstep: 9159.23 | bwd_allreduce_microstep: 641.32 | step_microstep: 170.71
[2025-01-06 10:48:17,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.14 | bwd: 9800.58 | bwd_inner: 9159.23 | bwd_allreduce: 641.32 | step: 170.71
 samples/sec: 48.377 | iteration       60/  320000 | elapsed time per iteration (ms): 13229.4 | learning rate: 3.750E-06 | approx flops per GPU: 147.3TFLOPS | MFU: 35.40% | HFU: 47.21% | lm_loss: 7.818069E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3227.46 | backward: 9813.11 | backward-backward: 9813.08 | backward-allreduce: 0.00 | optimizer: 170.86 | batch generator: 55.92
[2025-01-06 10:48:30,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.20 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:48:30,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.24 | bwd_microstep: 9819.38 | bwd_inner_microstep: 9155.10 | bwd_allreduce_microstep: 664.24 | step_microstep: 170.01
[2025-01-06 10:48:30,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.22 | bwd: 9819.37 | bwd_inner: 9155.10 | bwd_allreduce: 664.24 | step: 170.01
[2025-01-06 10:48:44,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.08 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 10:48:44,120] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.59 | bwd_microstep: 9806.06 | bwd_inner_microstep: 9153.11 | bwd_allreduce_microstep: 652.92 | step_microstep: 163.88
[2025-01-06 10:48:44,120] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.58 | bwd: 9806.05 | bwd_inner: 9153.10 | bwd_allreduce: 652.92 | step: 163.88
[2025-01-06 10:48:57,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.36 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 10:48:57,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.43 | bwd_microstep: 9825.16 | bwd_inner_microstep: 9168.83 | bwd_allreduce_microstep: 656.30 | step_microstep: 166.27
[2025-01-06 10:48:57,361] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.42 | bwd: 9825.15 | bwd_inner: 9168.82 | bwd_allreduce: 656.30 | step: 166.28
[2025-01-06 10:49:10,586] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.33 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:49:10,586] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.62 | bwd_microstep: 9840.26 | bwd_inner_microstep: 9150.26 | bwd_allreduce_microstep: 689.97 | step_microstep: 173.14
[2025-01-06 10:49:10,587] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.61 | bwd: 9840.26 | bwd_inner: 9150.26 | bwd_allreduce: 689.97 | step: 173.15
[2025-01-06 10:49:23,868] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.20 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 10:49:23,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.85 | bwd_microstep: 9884.07 | bwd_inner_microstep: 9151.28 | bwd_allreduce_microstep: 732.75 | step_microstep: 175.05
[2025-01-06 10:49:23,869] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.83 | bwd: 9884.06 | bwd_inner: 9151.27 | bwd_allreduce: 732.75 | step: 175.05
[2025-01-06 10:49:37,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.31 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 10:49:37,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.42 | bwd_microstep: 9881.13 | bwd_inner_microstep: 9157.37 | bwd_allreduce_microstep: 723.72 | step_microstep: 171.22
[2025-01-06 10:49:37,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.40 | bwd: 9881.12 | bwd_inner: 9157.37 | bwd_allreduce: 723.72 | step: 171.22
[2025-01-06 10:49:50,389] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.76 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:49:50,389] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.93 | bwd_microstep: 9854.58 | bwd_inner_microstep: 9151.58 | bwd_allreduce_microstep: 702.97 | step_microstep: 173.75
[2025-01-06 10:49:50,389] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.92 | bwd: 9854.57 | bwd_inner: 9151.57 | bwd_allreduce: 702.97 | step: 173.75
[2025-01-06 10:50:03,616] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.98 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:50:03,616] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.13 | bwd_microstep: 9834.69 | bwd_inner_microstep: 9169.31 | bwd_allreduce_microstep: 665.34 | step_microstep: 163.72
[2025-01-06 10:50:03,617] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.11 | bwd: 9834.68 | bwd_inner: 9169.31 | bwd_allreduce: 665.34 | step: 163.72
[2025-01-06 10:50:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.00 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:50:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.25 | bwd_microstep: 9828.12 | bwd_inner_microstep: 9158.40 | bwd_allreduce_microstep: 669.68 | step_microstep: 168.82
[2025-01-06 10:50:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.23 | bwd: 9828.11 | bwd_inner: 9158.40 | bwd_allreduce: 669.68 | step: 168.83
[2025-01-06 10:50:30,075] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.40 | optimizer_gradients: 2.57 | optimizer_step: 4.41
[2025-01-06 10:50:30,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[4.3750000000000005e-06, 4.3750000000000005e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:50:30,076] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=48.78761992471833, CurrSamplesPerSec=48.693164112472516, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:50:30,076] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.93 | bwd_microstep: 9797.94 | bwd_inner_microstep: 9152.70 | bwd_allreduce_microstep: 645.21 | step_microstep: 165.66
[2025-01-06 10:50:30,076] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.91 | bwd: 9797.93 | bwd_inner: 9152.70 | bwd_allreduce: 645.21 | step: 165.67
 samples/sec: 48.340 | iteration       70/  320000 | elapsed time per iteration (ms): 13239.6 | learning rate: 4.375E-06 | approx flops per GPU: 147.2TFLOPS | MFU: 35.38% | HFU: 47.17% | lm_loss: 7.552005E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3222.01 | backward: 9837.42 | backward-backward: 9837.39 | backward-allreduce: 0.00 | optimizer: 169.53 | batch generator: 46.89
[2025-01-06 10:50:43,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.61 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:50:43,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.32 | bwd_microstep: 9792.61 | bwd_inner_microstep: 9152.33 | bwd_allreduce_microstep: 640.25 | step_microstep: 171.50
[2025-01-06 10:50:43,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.31 | bwd: 9792.60 | bwd_inner: 9152.32 | bwd_allreduce: 640.25 | step: 171.51
[2025-01-06 10:50:56,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.33 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:50:56,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.65 | bwd_microstep: 9786.92 | bwd_inner_microstep: 9144.97 | bwd_allreduce_microstep: 641.91 | step_microstep: 170.15
[2025-01-06 10:50:56,487] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.64 | bwd: 9786.91 | bwd_inner: 9144.96 | bwd_allreduce: 641.91 | step: 170.15
[2025-01-06 10:51:09,725] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.46 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:51:09,725] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.97 | bwd_microstep: 9800.35 | bwd_inner_microstep: 9167.73 | bwd_allreduce_microstep: 632.58 | step_microstep: 173.46
[2025-01-06 10:51:09,725] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.96 | bwd: 9800.34 | bwd_inner: 9167.72 | bwd_allreduce: 632.58 | step: 173.46
[2025-01-06 10:51:22,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.72 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 10:51:22,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.64 | bwd_microstep: 9818.07 | bwd_inner_microstep: 9162.96 | bwd_allreduce_microstep: 655.07 | step_microstep: 165.37
[2025-01-06 10:51:22,939] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.62 | bwd: 9818.06 | bwd_inner: 9162.96 | bwd_allreduce: 655.07 | step: 165.38
[2025-01-06 10:51:36,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.41 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:51:36,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2977.92 | bwd_microstep: 9812.59 | bwd_inner_microstep: 9169.80 | bwd_allreduce_microstep: 642.76 | step_microstep: 171.22
[2025-01-06 10:51:36,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2977.91 | bwd: 9812.58 | bwd_inner: 9169.79 | bwd_allreduce: 642.76 | step: 171.21
[2025-01-06 10:51:49,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.68 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:51:49,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.54 | bwd_microstep: 9802.35 | bwd_inner_microstep: 9174.38 | bwd_allreduce_microstep: 627.93 | step_microstep: 167.93
[2025-01-06 10:51:49,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.52 | bwd: 9802.34 | bwd_inner: 9174.38 | bwd_allreduce: 627.93 | step: 167.93
[2025-01-06 10:52:02,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.42 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:52:02,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.87 | bwd_microstep: 9802.83 | bwd_inner_microstep: 9175.87 | bwd_allreduce_microstep: 626.93 | step_microstep: 171.28
[2025-01-06 10:52:02,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.85 | bwd: 9802.83 | bwd_inner: 9175.87 | bwd_allreduce: 626.93 | step: 171.28
[2025-01-06 10:52:15,899] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.45 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:52:15,900] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.06 | bwd_microstep: 9789.99 | bwd_inner_microstep: 9185.16 | bwd_allreduce_microstep: 604.79 | step_microstep: 172.34
[2025-01-06 10:52:15,900] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.04 | bwd: 9789.98 | bwd_inner: 9185.15 | bwd_allreduce: 604.79 | step: 172.34
[2025-01-06 10:52:29,179] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.97 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 10:52:29,180] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.76 | bwd_microstep: 9842.18 | bwd_inner_microstep: 9185.72 | bwd_allreduce_microstep: 656.43 | step_microstep: 171.81
[2025-01-06 10:52:29,180] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.75 | bwd: 9842.17 | bwd_inner: 9185.72 | bwd_allreduce: 656.42 | step: 171.81
[2025-01-06 10:52:42,416] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.47 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:52:42,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[5e-06, 5e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:52:42,416] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=48.77168336284687, CurrSamplesPerSec=48.737575035103575, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:52:42,417] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.01 | bwd_microstep: 9780.00 | bwd_inner_microstep: 9167.32 | bwd_allreduce_microstep: 612.64 | step_microstep: 174.76
[2025-01-06 10:52:42,417] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.99 | bwd: 9779.99 | bwd_inner: 9167.32 | bwd_allreduce: 612.64 | step: 174.77
 samples/sec: 48.363 | iteration       80/  320000 | elapsed time per iteration (ms): 13233.3 | learning rate: 5.000E-06 | approx flops per GPU: 147.2TFLOPS | MFU: 35.39% | HFU: 47.19% | lm_loss: 7.348213E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3242.44 | backward: 9803.18 | backward-backward: 9803.14 | backward-allreduce: 0.00 | optimizer: 171.35 | batch generator: 64.96
[2025-01-06 10:52:55,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.63 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:52:55,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.48 | bwd_microstep: 9800.00 | bwd_inner_microstep: 9169.93 | bwd_allreduce_microstep: 630.03 | step_microstep: 170.37
[2025-01-06 10:52:55,659] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.47 | bwd: 9799.99 | bwd_inner: 9169.92 | bwd_allreduce: 630.03 | step: 170.37
[2025-01-06 10:53:08,917] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.95 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:53:08,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.39 | bwd_microstep: 9831.94 | bwd_inner_microstep: 9195.09 | bwd_allreduce_microstep: 636.82 | step_microstep: 172.77
[2025-01-06 10:53:08,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.38 | bwd: 9831.94 | bwd_inner: 9195.08 | bwd_allreduce: 636.82 | step: 172.75
[2025-01-06 10:53:22,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.26 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:53:22,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.12 | bwd_microstep: 9815.55 | bwd_inner_microstep: 9162.29 | bwd_allreduce_microstep: 653.23 | step_microstep: 166.18
[2025-01-06 10:53:22,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.10 | bwd: 9815.55 | bwd_inner: 9162.29 | bwd_allreduce: 653.23 | step: 166.19
[2025-01-06 10:53:35,387] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.05 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:53:35,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.78 | bwd_microstep: 9810.18 | bwd_inner_microstep: 9163.33 | bwd_allreduce_microstep: 646.82 | step_microstep: 170.04
[2025-01-06 10:53:35,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.77 | bwd: 9810.18 | bwd_inner: 9163.33 | bwd_allreduce: 646.82 | step: 170.04
[2025-01-06 10:53:48,605] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.64 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 10:53:48,605] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.25 | bwd_microstep: 9778.05 | bwd_inner_microstep: 9159.87 | bwd_allreduce_microstep: 618.15 | step_microstep: 174.49
[2025-01-06 10:53:48,605] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.25 | bwd: 9778.04 | bwd_inner: 9159.87 | bwd_allreduce: 618.15 | step: 174.49
[2025-01-06 10:54:01,828] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.80 | optimizer_gradients: 2.54 | optimizer_step: 4.33
[2025-01-06 10:54:01,828] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.64 | bwd_microstep: 9778.49 | bwd_inner_microstep: 9159.65 | bwd_allreduce_microstep: 618.80 | step_microstep: 171.55
[2025-01-06 10:54:01,828] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.63 | bwd: 9778.48 | bwd_inner: 9159.65 | bwd_allreduce: 618.80 | step: 171.55
[2025-01-06 10:54:15,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.99 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:54:15,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.37 | bwd_microstep: 9825.25 | bwd_inner_microstep: 9153.66 | bwd_allreduce_microstep: 671.56 | step_microstep: 172.80
[2025-01-06 10:54:15,085] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.35 | bwd: 9825.24 | bwd_inner: 9153.65 | bwd_allreduce: 671.56 | step: 172.80
[2025-01-06 10:54:28,319] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.99 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:54:28,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2946.56 | bwd_microstep: 9792.18 | bwd_inner_microstep: 9163.34 | bwd_allreduce_microstep: 628.81 | step_microstep: 174.77
[2025-01-06 10:54:28,320] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2946.55 | bwd: 9792.18 | bwd_inner: 9163.33 | bwd_allreduce: 628.81 | step: 174.77
[2025-01-06 10:54:41,516] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.36 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 10:54:41,516] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2948.84 | bwd_microstep: 9740.59 | bwd_inner_microstep: 9170.25 | bwd_allreduce_microstep: 570.30 | step_microstep: 170.16
[2025-01-06 10:54:41,516] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2948.82 | bwd: 9740.58 | bwd_inner: 9170.24 | bwd_allreduce: 570.30 | step: 170.17
[2025-01-06 10:54:54,730] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.29 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 10:54:54,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[5.625e-06, 5.625e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:54:54,731] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=48.764845024430436, CurrSamplesPerSec=48.732899739220834, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:54:54,731] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.74 | bwd_microstep: 9795.19 | bwd_inner_microstep: 9157.31 | bwd_allreduce_microstep: 637.85 | step_microstep: 167.53
[2025-01-06 10:54:54,732] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.72 | bwd: 9795.18 | bwd_inner: 9157.30 | bwd_allreduce: 637.85 | step: 167.53
 samples/sec: 48.362 | iteration       90/  320000 | elapsed time per iteration (ms): 13233.6 | learning rate: 5.625E-06 | approx flops per GPU: 147.2TFLOPS | MFU: 35.39% | HFU: 47.19% | lm_loss: 7.182165E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3251.37 | backward: 9797.03 | backward-backward: 9796.99 | backward-allreduce: 0.00 | optimizer: 171.41 | batch generator: 80.77
[2025-01-06 10:55:07,988] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.60 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:55:07,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.07 | bwd_microstep: 9844.94 | bwd_inner_microstep: 9167.28 | bwd_allreduce_microstep: 677.62 | step_microstep: 172.39
[2025-01-06 10:55:07,989] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.05 | bwd: 9844.93 | bwd_inner: 9167.27 | bwd_allreduce: 677.62 | step: 172.40
[2025-01-06 10:55:21,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.79 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 10:55:21,235] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.62 | bwd_microstep: 9806.69 | bwd_inner_microstep: 9159.98 | bwd_allreduce_microstep: 646.68 | step_microstep: 164.54
[2025-01-06 10:55:21,236] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.61 | bwd: 9806.69 | bwd_inner: 9159.98 | bwd_allreduce: 646.68 | step: 164.54
[2025-01-06 10:55:34,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.60 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:55:34,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.74 | bwd_microstep: 9814.89 | bwd_inner_microstep: 9178.27 | bwd_allreduce_microstep: 636.58 | step_microstep: 167.35
[2025-01-06 10:55:34,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.73 | bwd: 9814.88 | bwd_inner: 9178.27 | bwd_allreduce: 636.58 | step: 167.36
[2025-01-06 10:55:47,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.25 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 10:55:47,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2970.30 | bwd_microstep: 9813.04 | bwd_inner_microstep: 9187.60 | bwd_allreduce_microstep: 625.41 | step_microstep: 172.17
[2025-01-06 10:55:47,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2970.28 | bwd: 9813.03 | bwd_inner: 9187.59 | bwd_allreduce: 625.41 | step: 172.17
[2025-01-06 10:56:00,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.10 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 10:56:00,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.97 | bwd_microstep: 9797.76 | bwd_inner_microstep: 9170.91 | bwd_allreduce_microstep: 626.80 | step_microstep: 166.69
[2025-01-06 10:56:00,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.96 | bwd: 9797.74 | bwd_inner: 9170.90 | bwd_allreduce: 626.80 | step: 166.68
[2025-01-06 10:56:14,220] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.03 | optimizer_gradients: 2.56 | optimizer_step: 4.39
[2025-01-06 10:56:14,220] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.53 | bwd_microstep: 9817.28 | bwd_inner_microstep: 9177.50 | bwd_allreduce_microstep: 639.74 | step_microstep: 167.87
[2025-01-06 10:56:14,220] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.52 | bwd: 9817.27 | bwd_inner: 9177.50 | bwd_allreduce: 639.73 | step: 167.87
[2025-01-06 10:56:27,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.91 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:56:27,481] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.19 | bwd_microstep: 9868.73 | bwd_inner_microstep: 9184.21 | bwd_allreduce_microstep: 684.49 | step_microstep: 163.63
[2025-01-06 10:56:27,482] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.18 | bwd: 9868.72 | bwd_inner: 9184.20 | bwd_allreduce: 684.49 | step: 163.63
[2025-01-06 10:56:40,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.35 | optimizer_gradients: 2.55 | optimizer_step: 4.40
[2025-01-06 10:56:40,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.66 | bwd_microstep: 9796.48 | bwd_inner_microstep: 9163.20 | bwd_allreduce_microstep: 633.25 | step_microstep: 167.99
[2025-01-06 10:56:40,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.64 | bwd: 9796.47 | bwd_inner: 9163.20 | bwd_allreduce: 633.24 | step: 167.99
[2025-01-06 10:56:53,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.78 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 10:56:53,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.18 | bwd_microstep: 9868.35 | bwd_inner_microstep: 9169.87 | bwd_allreduce_microstep: 698.45 | step_microstep: 169.47
[2025-01-06 10:56:53,962] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.17 | bwd: 9868.35 | bwd_inner: 9169.87 | bwd_allreduce: 698.45 | step: 169.47
[2025-01-06 10:57:07,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.97 | optimizer_gradients: 2.58 | optimizer_step: 4.37
[2025-01-06 10:57:07,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[6.25e-06, 6.25e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:57:07,222] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=48.74585280963498, CurrSamplesPerSec=48.419862364337675, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:57:07,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2980.98 | bwd_microstep: 9848.45 | bwd_inner_microstep: 9151.52 | bwd_allreduce_microstep: 696.89 | step_microstep: 169.23
[2025-01-06 10:57:07,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2980.96 | bwd: 9848.44 | bwd_inner: 9151.51 | bwd_allreduce: 696.89 | step: 169.24
 samples/sec: 48.313 | iteration      100/  320000 | elapsed time per iteration (ms): 13247.0 | learning rate: 6.250E-06 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.14% | lm_loss: 7.042821E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3245.97 | backward: 9827.90 | backward-backward: 9827.86 | backward-allreduce: 0.00 | optimizer: 168.48 | batch generator: 67.56
[2025-01-06 10:57:20,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.93 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 10:57:20,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.94 | bwd_microstep: 9878.97 | bwd_inner_microstep: 9193.97 | bwd_allreduce_microstep: 684.97 | step_microstep: 172.81
[2025-01-06 10:57:20,507] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.92 | bwd: 9878.97 | bwd_inner: 9193.97 | bwd_allreduce: 684.97 | step: 172.81
[2025-01-06 10:57:33,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.25 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 10:57:33,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.23 | bwd_microstep: 9877.79 | bwd_inner_microstep: 9197.36 | bwd_allreduce_microstep: 680.40 | step_microstep: 172.09
[2025-01-06 10:57:33,823] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.22 | bwd: 9877.78 | bwd_inner: 9197.36 | bwd_allreduce: 680.40 | step: 172.09
[2025-01-06 10:57:47,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.31 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:57:47,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2984.10 | bwd_microstep: 9897.67 | bwd_inner_microstep: 9205.44 | bwd_allreduce_microstep: 692.20 | step_microstep: 170.11
[2025-01-06 10:57:47,149] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2984.09 | bwd: 9897.67 | bwd_inner: 9205.43 | bwd_allreduce: 692.20 | step: 170.11
[2025-01-06 10:58:00,490] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.52 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:58:00,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2981.63 | bwd_microstep: 9928.18 | bwd_inner_microstep: 9216.47 | bwd_allreduce_microstep: 711.68 | step_microstep: 168.35
[2025-01-06 10:58:00,491] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2981.62 | bwd: 9928.17 | bwd_inner: 9216.46 | bwd_allreduce: 711.68 | step: 168.35
[2025-01-06 10:58:13,829] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.51 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 10:58:13,829] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2983.51 | bwd_microstep: 9891.82 | bwd_inner_microstep: 9210.58 | bwd_allreduce_microstep: 681.21 | step_microstep: 168.46
[2025-01-06 10:58:13,830] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2983.50 | bwd: 9891.82 | bwd_inner: 9210.58 | bwd_allreduce: 681.21 | step: 168.46
[2025-01-06 10:58:27,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.31 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 10:58:27,120] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.40 | bwd_microstep: 9903.60 | bwd_inner_microstep: 9178.06 | bwd_allreduce_microstep: 725.50 | step_microstep: 166.12
[2025-01-06 10:58:27,120] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.39 | bwd: 9903.59 | bwd_inner: 9178.05 | bwd_allreduce: 725.50 | step: 166.13
[2025-01-06 10:58:40,423] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.06 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:58:40,424] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.81 | bwd_microstep: 9897.40 | bwd_inner_microstep: 9216.08 | bwd_allreduce_microstep: 681.29 | step_microstep: 165.04
[2025-01-06 10:58:40,424] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.80 | bwd: 9897.40 | bwd_inner: 9216.08 | bwd_allreduce: 681.29 | step: 165.04
[2025-01-06 10:58:53,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.01 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 10:58:53,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2987.49 | bwd_microstep: 9802.01 | bwd_inner_microstep: 9171.97 | bwd_allreduce_microstep: 630.00 | step_microstep: 171.75
[2025-01-06 10:58:53,661] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2987.48 | bwd: 9801.99 | bwd_inner: 9171.96 | bwd_allreduce: 629.99 | step: 171.76
[2025-01-06 10:59:06,902] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.18 | optimizer_gradients: 2.58 | optimizer_step: 4.38
[2025-01-06 10:59:06,903] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.48 | bwd_microstep: 9801.94 | bwd_inner_microstep: 9171.47 | bwd_allreduce_microstep: 630.44 | step_microstep: 164.98
[2025-01-06 10:59:06,903] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.47 | bwd: 9801.93 | bwd_inner: 9171.46 | bwd_allreduce: 630.44 | step: 164.99
[2025-01-06 10:59:20,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.82 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 10:59:20,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[6.875000000000001e-06, 6.875000000000001e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 10:59:20,112] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=48.713305761735384, CurrSamplesPerSec=48.80823115186993, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 10:59:20,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.02 | bwd_microstep: 9764.11 | bwd_inner_microstep: 9159.29 | bwd_allreduce_microstep: 604.78 | step_microstep: 172.96
[2025-01-06 10:59:20,112] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.01 | bwd: 9764.11 | bwd_inner: 9159.29 | bwd_allreduce: 604.78 | step: 172.96
 samples/sec: 48.160 | iteration      110/  320000 | elapsed time per iteration (ms): 13288.9 | learning rate: 6.875E-06 | approx flops per GPU: 146.6TFLOPS | MFU: 35.25% | HFU: 46.99% | lm_loss: 6.866448E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3245.05 | backward: 9864.73 | backward-backward: 9864.69 | backward-allreduce: 0.00 | optimizer: 169.65 | batch generator: 54.88
[2025-01-06 10:59:33,353] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.65 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 10:59:33,354] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.41 | bwd_microstep: 9810.45 | bwd_inner_microstep: 9163.46 | bwd_allreduce_microstep: 646.94 | step_microstep: 174.35
[2025-01-06 10:59:33,354] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.40 | bwd: 9810.44 | bwd_inner: 9163.45 | bwd_allreduce: 646.94 | step: 174.35
[2025-01-06 10:59:46,594] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.70 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 10:59:46,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.41 | bwd_microstep: 9798.08 | bwd_inner_microstep: 9145.14 | bwd_allreduce_microstep: 652.90 | step_microstep: 165.57
[2025-01-06 10:59:46,595] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.40 | bwd: 9798.07 | bwd_inner: 9145.14 | bwd_allreduce: 652.90 | step: 165.57
[2025-01-06 10:59:59,793] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.61 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 10:59:59,794] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.60 | bwd_microstep: 9748.88 | bwd_inner_microstep: 9143.74 | bwd_allreduce_microstep: 605.11 | step_microstep: 172.49
[2025-01-06 10:59:59,794] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.59 | bwd: 9748.88 | bwd_inner: 9143.74 | bwd_allreduce: 605.10 | step: 172.49
[2025-01-06 11:00:12,976] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.53 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:00:12,977] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.53 | bwd_microstep: 9741.02 | bwd_inner_microstep: 9148.84 | bwd_allreduce_microstep: 592.14 | step_microstep: 174.34
[2025-01-06 11:00:12,977] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.51 | bwd: 9741.01 | bwd_inner: 9148.83 | bwd_allreduce: 592.14 | step: 174.34
[2025-01-06 11:00:26,198] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.18 | optimizer_gradients: 2.56 | optimizer_step: 4.41
[2025-01-06 11:00:26,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.56 | bwd_microstep: 9800.27 | bwd_inner_microstep: 9160.58 | bwd_allreduce_microstep: 639.65 | step_microstep: 174.05
[2025-01-06 11:00:26,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.54 | bwd: 9800.27 | bwd_inner: 9160.58 | bwd_allreduce: 639.65 | step: 174.05
[2025-01-06 11:00:39,430] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.18 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:00:39,431] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.38 | bwd_microstep: 9797.92 | bwd_inner_microstep: 9164.66 | bwd_allreduce_microstep: 633.23 | step_microstep: 173.10
[2025-01-06 11:00:39,431] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.37 | bwd: 9797.92 | bwd_inner: 9164.65 | bwd_allreduce: 633.23 | step: 173.10
[2025-01-06 11:00:52,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.85 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:00:52,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.00 | bwd_microstep: 9796.43 | bwd_inner_microstep: 9151.12 | bwd_allreduce_microstep: 645.28 | step_microstep: 163.74
[2025-01-06 11:00:52,657] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.99 | bwd: 9796.42 | bwd_inner: 9151.11 | bwd_allreduce: 645.28 | step: 163.74
[2025-01-06 11:01:05,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.94 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:01:05,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.21 | bwd_microstep: 9854.43 | bwd_inner_microstep: 9154.60 | bwd_allreduce_microstep: 699.79 | step_microstep: 166.82
[2025-01-06 11:01:05,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.20 | bwd: 9854.42 | bwd_inner: 9154.60 | bwd_allreduce: 699.79 | step: 166.83
[2025-01-06 11:01:19,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.65 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:01:19,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.19 | bwd_microstep: 9783.93 | bwd_inner_microstep: 9145.02 | bwd_allreduce_microstep: 638.87 | step_microstep: 168.31
[2025-01-06 11:01:19,111] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.17 | bwd: 9783.93 | bwd_inner: 9145.02 | bwd_allreduce: 638.87 | step: 168.32
[2025-01-06 11:01:32,331] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.89 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:01:32,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[7.5e-06, 7.5e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:01:32,332] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=48.71387490094717, CurrSamplesPerSec=48.79122723101136, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:01:32,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.17 | bwd_microstep: 9774.44 | bwd_inner_microstep: 9156.93 | bwd_allreduce_microstep: 617.47 | step_microstep: 173.24
[2025-01-06 11:01:32,332] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.16 | bwd: 9774.43 | bwd_inner: 9156.93 | bwd_allreduce: 617.47 | step: 173.25
 samples/sec: 48.404 | iteration      120/  320000 | elapsed time per iteration (ms): 13222.0 | learning rate: 7.500E-06 | approx flops per GPU: 147.4TFLOPS | MFU: 35.42% | HFU: 47.23% | lm_loss: 6.736889E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3244.64 | backward: 9790.99 | backward-backward: 9790.95 | backward-allreduce: 0.00 | optimizer: 170.96 | batch generator: 69.83
[2025-01-06 11:01:45,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.91 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:01:45,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.39 | bwd_microstep: 9860.47 | bwd_inner_microstep: 9166.24 | bwd_allreduce_microstep: 694.19 | step_microstep: 174.84
[2025-01-06 11:01:45,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.37 | bwd: 9860.46 | bwd_inner: 9166.23 | bwd_allreduce: 694.19 | step: 174.84
[2025-01-06 11:01:58,875] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.96 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:01:58,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.39 | bwd_microstep: 9833.76 | bwd_inner_microstep: 9165.23 | bwd_allreduce_microstep: 668.49 | step_microstep: 173.72
[2025-01-06 11:01:58,876] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.38 | bwd: 9833.75 | bwd_inner: 9165.23 | bwd_allreduce: 668.49 | step: 173.72
[2025-01-06 11:02:12,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.85 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:02:12,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2967.56 | bwd_microstep: 9841.18 | bwd_inner_microstep: 9155.67 | bwd_allreduce_microstep: 685.47 | step_microstep: 171.78
[2025-01-06 11:02:12,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2967.55 | bwd: 9841.17 | bwd_inner: 9155.67 | bwd_allreduce: 685.47 | step: 171.78
[2025-01-06 11:02:25,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.09 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:02:25,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.19 | bwd_microstep: 9816.19 | bwd_inner_microstep: 9167.70 | bwd_allreduce_microstep: 648.44 | step_microstep: 164.83
[2025-01-06 11:02:25,382] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.18 | bwd: 9816.17 | bwd_inner: 9167.69 | bwd_allreduce: 648.44 | step: 164.83
[2025-01-06 11:02:38,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.59 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:02:38,646] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.08 | bwd_microstep: 9852.32 | bwd_inner_microstep: 9161.08 | bwd_allreduce_microstep: 691.20 | step_microstep: 173.32
[2025-01-06 11:02:38,647] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.07 | bwd: 9852.31 | bwd_inner: 9161.07 | bwd_allreduce: 691.20 | step: 173.32
[2025-01-06 11:02:51,909] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.51 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:02:51,910] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.59 | bwd_microstep: 9871.06 | bwd_inner_microstep: 9170.45 | bwd_allreduce_microstep: 700.58 | step_microstep: 171.32
[2025-01-06 11:02:51,910] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.58 | bwd: 9871.05 | bwd_inner: 9170.44 | bwd_allreduce: 700.58 | step: 171.32
[2025-01-06 11:03:05,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.31 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:03:05,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.94 | bwd_microstep: 9839.93 | bwd_inner_microstep: 9189.42 | bwd_allreduce_microstep: 650.47 | step_microstep: 165.15
[2025-01-06 11:03:05,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.92 | bwd: 9839.92 | bwd_inner: 9189.41 | bwd_allreduce: 650.47 | step: 165.16
[2025-01-06 11:03:18,434] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.70 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:03:18,435] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.11 | bwd_microstep: 9832.72 | bwd_inner_microstep: 9174.89 | bwd_allreduce_microstep: 657.79 | step_microstep: 165.57
[2025-01-06 11:03:18,435] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2972.10 | bwd: 9832.72 | bwd_inner: 9174.89 | bwd_allreduce: 657.79 | step: 165.57
[2025-01-06 11:03:31,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.87 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:03:31,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.67 | bwd_microstep: 9758.74 | bwd_inner_microstep: 9154.61 | bwd_allreduce_microstep: 604.10 | step_microstep: 165.69
[2025-01-06 11:03:31,638] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.66 | bwd: 9758.74 | bwd_inner: 9154.61 | bwd_allreduce: 604.10 | step: 165.69
[2025-01-06 11:03:44,900] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.98 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 11:03:44,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[8.125000000000001e-06, 8.125000000000001e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:03:44,901] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=48.70030634457962, CurrSamplesPerSec=48.505679582868666, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:03:44,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.65 | bwd_microstep: 9838.18 | bwd_inner_microstep: 9184.54 | bwd_allreduce_microstep: 653.61 | step_microstep: 173.20
[2025-01-06 11:03:44,901] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.64 | bwd: 9838.18 | bwd_inner: 9184.54 | bwd_allreduce: 653.60 | step: 173.20
 samples/sec: 48.269 | iteration      130/  320000 | elapsed time per iteration (ms): 13259.0 | learning rate: 8.125E-06 | approx flops per GPU: 147.0TFLOPS | MFU: 35.33% | HFU: 47.10% | lm_loss: 6.607964E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3241.52 | backward: 9834.81 | backward-backward: 9834.78 | backward-allreduce: 0.00 | optimizer: 170.31 | batch generator: 61.36
[2025-01-06 11:03:58,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.14 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:03:58,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.80 | bwd_microstep: 9804.92 | bwd_inner_microstep: 9158.23 | bwd_allreduce_microstep: 646.66 | step_microstep: 172.06
[2025-01-06 11:03:58,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.78 | bwd: 9804.91 | bwd_inner: 9158.23 | bwd_allreduce: 646.66 | step: 172.06
[2025-01-06 11:04:11,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.24 | optimizer_gradients: 2.57 | optimizer_step: 4.41
[2025-01-06 11:04:11,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.06 | bwd_microstep: 9820.43 | bwd_inner_microstep: 9148.46 | bwd_allreduce_microstep: 671.94 | step_microstep: 172.05
[2025-01-06 11:04:11,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.05 | bwd: 9820.43 | bwd_inner: 9148.45 | bwd_allreduce: 671.94 | step: 172.05
[2025-01-06 11:04:24,691] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.20 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:04:24,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.30 | bwd_microstep: 9852.03 | bwd_inner_microstep: 9148.55 | bwd_allreduce_microstep: 703.45 | step_microstep: 169.97
[2025-01-06 11:04:24,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.28 | bwd: 9852.03 | bwd_inner: 9148.54 | bwd_allreduce: 703.45 | step: 169.97
[2025-01-06 11:04:37,942] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.25 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:04:37,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.30 | bwd_microstep: 9820.45 | bwd_inner_microstep: 9175.93 | bwd_allreduce_microstep: 644.49 | step_microstep: 174.02
[2025-01-06 11:04:37,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.28 | bwd: 9820.44 | bwd_inner: 9175.92 | bwd_allreduce: 644.49 | step: 174.02
[2025-01-06 11:04:51,188] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.33 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:04:51,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.86 | bwd_microstep: 9804.71 | bwd_inner_microstep: 9153.92 | bwd_allreduce_microstep: 650.75 | step_microstep: 174.23
[2025-01-06 11:04:51,189] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.84 | bwd: 9804.70 | bwd_inner: 9153.92 | bwd_allreduce: 650.75 | step: 174.23
[2025-01-06 11:05:04,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.30 | optimizer_gradients: 2.57 | optimizer_step: 4.33
[2025-01-06 11:05:04,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.24 | bwd_microstep: 9815.00 | bwd_inner_microstep: 9151.26 | bwd_allreduce_microstep: 663.70 | step_microstep: 168.14
[2025-01-06 11:05:04,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.23 | bwd: 9814.99 | bwd_inner: 9151.26 | bwd_allreduce: 663.70 | step: 168.14
[2025-01-06 11:05:17,691] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.65 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:05:17,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.02 | bwd_microstep: 9824.77 | bwd_inner_microstep: 9176.90 | bwd_allreduce_microstep: 647.83 | step_microstep: 167.17
[2025-01-06 11:05:17,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.00 | bwd: 9824.76 | bwd_inner: 9176.90 | bwd_allreduce: 647.83 | step: 167.18
[2025-01-06 11:05:30,937] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.35 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:05:30,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2970.64 | bwd_microstep: 9829.61 | bwd_inner_microstep: 9158.22 | bwd_allreduce_microstep: 671.36 | step_microstep: 167.15
[2025-01-06 11:05:30,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2970.62 | bwd: 9829.60 | bwd_inner: 9158.22 | bwd_allreduce: 671.35 | step: 167.13
[2025-01-06 11:05:44,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.60 | optimizer_gradients: 2.54 | optimizer_step: 4.35
[2025-01-06 11:05:44,199] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.24 | bwd_microstep: 9824.54 | bwd_inner_microstep: 9162.66 | bwd_allreduce_microstep: 661.85 | step_microstep: 166.32
[2025-01-06 11:05:44,200] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.23 | bwd: 9824.54 | bwd_inner: 9162.66 | bwd_allreduce: 661.84 | step: 166.31
[2025-01-06 11:05:57,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.42 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:05:57,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[8.750000000000001e-06, 8.750000000000001e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:05:57,437] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=48.692499994470445, CurrSamplesPerSec=48.578309555153666, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:05:57,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.75 | bwd_microstep: 9830.47 | bwd_inner_microstep: 9155.01 | bwd_allreduce_microstep: 675.43 | step_microstep: 164.87
[2025-01-06 11:05:57,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.74 | bwd: 9830.46 | bwd_inner: 9155.00 | bwd_allreduce: 675.43 | step: 164.87
 samples/sec: 48.295 | iteration      140/  320000 | elapsed time per iteration (ms): 13252.0 | learning rate: 8.750E-06 | approx flops per GPU: 147.0TFLOPS | MFU: 35.34% | HFU: 47.13% | lm_loss: 6.455469E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3252.18 | backward: 9823.01 | backward-backward: 9822.97 | backward-allreduce: 0.00 | optimizer: 169.97 | batch generator: 73.98
[2025-01-06 11:06:10,688] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.07 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:06:10,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.09 | bwd_microstep: 9813.87 | bwd_inner_microstep: 9143.64 | bwd_allreduce_microstep: 670.19 | step_microstep: 173.95
[2025-01-06 11:06:10,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.07 | bwd: 9813.86 | bwd_inner: 9143.63 | bwd_allreduce: 670.19 | step: 173.95
[2025-01-06 11:06:23,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.41 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:06:23,919] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.95 | bwd_microstep: 9787.90 | bwd_inner_microstep: 9178.70 | bwd_allreduce_microstep: 609.17 | step_microstep: 174.29
[2025-01-06 11:06:23,919] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.93 | bwd: 9787.89 | bwd_inner: 9178.69 | bwd_allreduce: 609.16 | step: 174.30
[2025-01-06 11:06:37,144] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.48 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:06:37,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2949.85 | bwd_microstep: 9786.31 | bwd_inner_microstep: 9137.16 | bwd_allreduce_microstep: 649.12 | step_microstep: 168.51
[2025-01-06 11:06:37,145] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2949.84 | bwd: 9786.31 | bwd_inner: 9137.15 | bwd_allreduce: 649.12 | step: 168.51
[2025-01-06 11:06:50,376] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.51 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:06:50,376] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.98 | bwd_microstep: 9785.76 | bwd_inner_microstep: 9160.79 | bwd_allreduce_microstep: 624.94 | step_microstep: 173.36
[2025-01-06 11:06:50,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.96 | bwd: 9785.76 | bwd_inner: 9160.78 | bwd_allreduce: 624.94 | step: 173.36
[2025-01-06 11:07:03,613] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.24 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:07:03,613] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.89 | bwd_microstep: 9800.80 | bwd_inner_microstep: 9152.95 | bwd_allreduce_microstep: 647.82 | step_microstep: 172.10
[2025-01-06 11:07:03,613] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.87 | bwd: 9800.80 | bwd_inner: 9152.95 | bwd_allreduce: 647.82 | step: 172.10
[2025-01-06 11:07:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.79 | optimizer_gradients: 2.55 | optimizer_step: 4.41
[2025-01-06 11:07:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.75 | bwd_microstep: 9852.74 | bwd_inner_microstep: 9170.64 | bwd_allreduce_microstep: 682.06 | step_microstep: 165.56
[2025-01-06 11:07:16,861] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.74 | bwd: 9852.73 | bwd_inner: 9170.63 | bwd_allreduce: 682.05 | step: 165.55
[2025-01-06 11:07:30,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.10 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:07:30,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.23 | bwd_microstep: 9848.73 | bwd_inner_microstep: 9158.75 | bwd_allreduce_microstep: 689.94 | step_microstep: 170.77
[2025-01-06 11:07:30,106] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.22 | bwd: 9848.72 | bwd_inner: 9158.74 | bwd_allreduce: 689.94 | step: 170.78
[2025-01-06 11:07:43,377] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.00 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:07:43,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.87 | bwd_microstep: 9879.14 | bwd_inner_microstep: 9160.88 | bwd_allreduce_microstep: 718.22 | step_microstep: 162.76
[2025-01-06 11:07:43,378] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.87 | bwd: 9879.13 | bwd_inner: 9160.88 | bwd_allreduce: 718.22 | step: 162.76
[2025-01-06 11:07:56,605] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.25 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:07:56,606] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.66 | bwd_microstep: 9819.45 | bwd_inner_microstep: 9155.95 | bwd_allreduce_microstep: 663.47 | step_microstep: 173.11
[2025-01-06 11:07:56,606] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.65 | bwd: 9819.44 | bwd_inner: 9155.95 | bwd_allreduce: 663.46 | step: 173.11
[2025-01-06 11:08:09,888] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.04 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:08:09,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[9.375000000000001e-06, 9.375000000000001e-06], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:08:09,889] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=48.686529744613665, CurrSamplesPerSec=48.46384592583563, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:08:09,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.47 | bwd_microstep: 9849.12 | bwd_inner_microstep: 9180.95 | bwd_allreduce_microstep: 668.14 | step_microstep: 174.43
[2025-01-06 11:08:09,889] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.46 | bwd: 9849.12 | bwd_inner: 9180.94 | bwd_allreduce: 668.14 | step: 174.44
 samples/sec: 48.311 | iteration      150/  320000 | elapsed time per iteration (ms): 13247.5 | learning rate: 9.375E-06 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.14% | lm_loss: 6.309781E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3239.40 | backward: 9822.65 | backward-backward: 9822.61 | backward-allreduce: 0.00 | optimizer: 171.23 | batch generator: 65.24
[2025-01-06 11:08:23,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.46 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:08:23,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.34 | bwd_microstep: 9836.82 | bwd_inner_microstep: 9156.81 | bwd_allreduce_microstep: 679.98 | step_microstep: 165.32
[2025-01-06 11:08:23,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.33 | bwd: 9836.82 | bwd_inner: 9156.80 | bwd_allreduce: 679.98 | step: 165.32
[2025-01-06 11:08:36,418] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.10 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:08:36,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.10 | bwd_microstep: 9843.00 | bwd_inner_microstep: 9173.01 | bwd_allreduce_microstep: 669.94 | step_microstep: 171.77
[2025-01-06 11:08:36,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.09 | bwd: 9842.99 | bwd_inner: 9173.00 | bwd_allreduce: 669.94 | step: 171.78
[2025-01-06 11:08:49,674] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.22 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:08:49,675] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.88 | bwd_microstep: 9831.58 | bwd_inner_microstep: 9154.54 | bwd_allreduce_microstep: 677.01 | step_microstep: 166.08
[2025-01-06 11:08:49,675] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.87 | bwd: 9831.57 | bwd_inner: 9154.53 | bwd_allreduce: 677.01 | step: 166.08
[2025-01-06 11:09:02,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.54 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:09:02,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.08 | bwd_microstep: 9823.90 | bwd_inner_microstep: 9155.39 | bwd_allreduce_microstep: 668.48 | step_microstep: 170.43
[2025-01-06 11:09:02,938] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.06 | bwd: 9823.89 | bwd_inner: 9155.38 | bwd_allreduce: 668.48 | step: 170.44
[2025-01-06 11:09:16,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.35 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:09:16,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.94 | bwd_microstep: 9784.23 | bwd_inner_microstep: 9162.25 | bwd_allreduce_microstep: 621.94 | step_microstep: 171.32
[2025-01-06 11:09:16,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.92 | bwd: 9784.22 | bwd_inner: 9162.24 | bwd_allreduce: 621.94 | step: 171.33
[2025-01-06 11:09:29,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.40 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:09:29,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.29 | bwd_microstep: 9812.54 | bwd_inner_microstep: 9159.32 | bwd_allreduce_microstep: 653.18 | step_microstep: 172.37
[2025-01-06 11:09:29,407] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.27 | bwd: 9812.53 | bwd_inner: 9159.31 | bwd_allreduce: 653.18 | step: 172.37
[2025-01-06 11:09:42,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.26 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:09:42,680] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.72 | bwd_microstep: 9847.55 | bwd_inner_microstep: 9184.29 | bwd_allreduce_microstep: 663.22 | step_microstep: 164.12
[2025-01-06 11:09:42,680] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.70 | bwd: 9847.54 | bwd_inner: 9184.29 | bwd_allreduce: 663.22 | step: 164.12
[2025-01-06 11:09:55,965] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.09 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:09:55,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.87 | bwd_microstep: 9847.50 | bwd_inner_microstep: 9168.28 | bwd_allreduce_microstep: 679.18 | step_microstep: 173.98
[2025-01-06 11:09:55,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2962.85 | bwd: 9847.49 | bwd_inner: 9168.28 | bwd_allreduce: 679.18 | step: 173.98
[2025-01-06 11:10:09,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 146.90 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:10:09,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.56 | bwd_microstep: 9785.87 | bwd_inner_microstep: 9146.33 | bwd_allreduce_microstep: 639.51 | step_microstep: 161.81
[2025-01-06 11:10:09,196] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.54 | bwd: 9785.86 | bwd_inner: 9146.32 | bwd_allreduce: 639.51 | step: 161.81
[2025-01-06 11:10:22,427] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.85 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:10:22,427] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[1e-05, 1e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:10:22,428] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=48.68172057131102, CurrSamplesPerSec=48.67519785694947, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:10:22,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.41 | bwd_microstep: 9801.91 | bwd_inner_microstep: 9156.06 | bwd_allreduce_microstep: 645.81 | step_microstep: 170.07
[2025-01-06 11:10:22,428] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.39 | bwd: 9801.90 | bwd_inner: 9156.06 | bwd_allreduce: 645.81 | step: 170.07
 samples/sec: 48.298 | iteration      160/  320000 | elapsed time per iteration (ms): 13251.1 | learning rate: 1.000E-05 | approx flops per GPU: 147.0TFLOPS | MFU: 35.35% | HFU: 47.13% | lm_loss: 6.177504E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3245.79 | backward: 9821.73 | backward-backward: 9821.70 | backward-allreduce: 0.00 | optimizer: 169.11 | batch generator: 70.28
[2025-01-06 11:10:35,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.02 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:10:35,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.11 | bwd_microstep: 9832.60 | bwd_inner_microstep: 9161.00 | bwd_allreduce_microstep: 671.55 | step_microstep: 172.87
[2025-01-06 11:10:35,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.63 | bwd: 9832.59 | bwd_inner: 9161.00 | bwd_allreduce: 671.55 | step: 172.87
[2025-01-06 11:10:48,902] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.45 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:10:48,903] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.89 | bwd_microstep: 9789.78 | bwd_inner_microstep: 9166.78 | bwd_allreduce_microstep: 622.96 | step_microstep: 172.22
[2025-01-06 11:10:48,903] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.88 | bwd: 9789.76 | bwd_inner: 9166.77 | bwd_allreduce: 622.95 | step: 172.23
[2025-01-06 11:11:02,141] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.30 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:11:02,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.50 | bwd_microstep: 9821.86 | bwd_inner_microstep: 9149.79 | bwd_allreduce_microstep: 672.03 | step_microstep: 172.11
[2025-01-06 11:11:02,142] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.49 | bwd: 9821.85 | bwd_inner: 9149.79 | bwd_allreduce: 672.03 | step: 172.12
[2025-01-06 11:11:15,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.71 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:11:15,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.23 | bwd_microstep: 9800.55 | bwd_inner_microstep: 9157.98 | bwd_allreduce_microstep: 642.53 | step_microstep: 169.54
[2025-01-06 11:11:15,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.22 | bwd: 9800.54 | bwd_inner: 9157.98 | bwd_allreduce: 642.53 | step: 169.55
[2025-01-06 11:11:28,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.05 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:11:28,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.19 | bwd_microstep: 9806.39 | bwd_inner_microstep: 9159.79 | bwd_allreduce_microstep: 646.56 | step_microstep: 172.96
[2025-01-06 11:11:28,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.18 | bwd: 9806.38 | bwd_inner: 9159.78 | bwd_allreduce: 646.56 | step: 172.97
[2025-01-06 11:11:41,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.46 | optimizer_gradients: 2.54 | optimizer_step: 4.35
[2025-01-06 11:11:41,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.86 | bwd_microstep: 9846.19 | bwd_inner_microstep: 9152.91 | bwd_allreduce_microstep: 693.23 | step_microstep: 173.17
[2025-01-06 11:11:41,897] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.85 | bwd: 9846.17 | bwd_inner: 9152.90 | bwd_allreduce: 693.23 | step: 173.17
[2025-01-06 11:11:55,137] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.49 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:11:55,137] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.52 | bwd_microstep: 9808.57 | bwd_inner_microstep: 9184.54 | bwd_allreduce_microstep: 623.98 | step_microstep: 171.23
[2025-01-06 11:11:55,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.51 | bwd: 9808.55 | bwd_inner: 9184.53 | bwd_allreduce: 623.98 | step: 171.23
[2025-01-06 11:12:08,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.18 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:12:08,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.05 | bwd_microstep: 9827.17 | bwd_inner_microstep: 9144.85 | bwd_allreduce_microstep: 682.29 | step_microstep: 166.03
[2025-01-06 11:12:08,398] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.04 | bwd: 9827.16 | bwd_inner: 9144.85 | bwd_allreduce: 682.29 | step: 166.03
[2025-01-06 11:12:21,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.64 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:12:21,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.32 | bwd_microstep: 9829.11 | bwd_inner_microstep: 9153.68 | bwd_allreduce_microstep: 675.40 | step_microstep: 172.46
[2025-01-06 11:12:21,648] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.30 | bwd: 9829.10 | bwd_inner: 9153.67 | bwd_allreduce: 675.40 | step: 172.46
[2025-01-06 11:12:34,832] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.37 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:12:34,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.0625e-05, 1.0625e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:12:34,833] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=48.679132149476935, CurrSamplesPerSec=48.77142422909222, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:12:34,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.87 | bwd_microstep: 9781.59 | bwd_inner_microstep: 9142.40 | bwd_allreduce_microstep: 639.16 | step_microstep: 163.76
[2025-01-06 11:12:34,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.85 | bwd: 9781.58 | bwd_inner: 9142.39 | bwd_allreduce: 639.16 | step: 163.77
 samples/sec: 48.318 | iteration      170/  320000 | elapsed time per iteration (ms): 13245.6 | learning rate: 1.063E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.15% | lm_loss: 6.083454E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3249.28 | backward: 9814.61 | backward-backward: 9814.58 | backward-allreduce: 0.00 | optimizer: 170.98 | batch generator: 74.36
[2025-01-06 11:12:48,041] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 147.43 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:12:48,041] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.93 | bwd_microstep: 9773.36 | bwd_inner_microstep: 9147.10 | bwd_allreduce_microstep: 626.22 | step_microstep: 162.25
[2025-01-06 11:12:48,041] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.92 | bwd: 9773.34 | bwd_inner: 9147.09 | bwd_allreduce: 626.22 | step: 162.26
[2025-01-06 11:13:01,246] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.83 | optimizer_gradients: 2.56 | optimizer_step: 4.40
[2025-01-06 11:13:01,247] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.95 | bwd_microstep: 9766.61 | bwd_inner_microstep: 9169.76 | bwd_allreduce_microstep: 596.81 | step_microstep: 172.74
[2025-01-06 11:13:01,247] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.95 | bwd: 9766.60 | bwd_inner: 9169.76 | bwd_allreduce: 596.81 | step: 172.74
[2025-01-06 11:13:14,466] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.85 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:13:14,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.63 | bwd_microstep: 9785.84 | bwd_inner_microstep: 9161.03 | bwd_allreduce_microstep: 624.77 | step_microstep: 171.62
[2025-01-06 11:13:14,467] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.62 | bwd: 9785.83 | bwd_inner: 9161.01 | bwd_allreduce: 624.77 | step: 171.62
[2025-01-06 11:13:27,722] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.38 | optimizer_gradients: 2.56 | optimizer_step: 4.39
[2025-01-06 11:13:27,722] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.27 | bwd_microstep: 9815.03 | bwd_inner_microstep: 9162.87 | bwd_allreduce_microstep: 652.13 | step_microstep: 176.84
[2025-01-06 11:13:27,723] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.26 | bwd: 9815.02 | bwd_inner: 9162.86 | bwd_allreduce: 652.13 | step: 176.84
[2025-01-06 11:13:40,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.49 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:13:40,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.27 | bwd_microstep: 9766.33 | bwd_inner_microstep: 9168.49 | bwd_allreduce_microstep: 597.80 | step_microstep: 164.35
[2025-01-06 11:13:40,932] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.26 | bwd: 9766.32 | bwd_inner: 9168.49 | bwd_allreduce: 597.80 | step: 164.35
[2025-01-06 11:13:54,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.09 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:13:54,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2967.51 | bwd_microstep: 9810.26 | bwd_inner_microstep: 9146.11 | bwd_allreduce_microstep: 664.12 | step_microstep: 170.08
[2025-01-06 11:13:54,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2967.50 | bwd: 9810.26 | bwd_inner: 9146.10 | bwd_allreduce: 664.12 | step: 170.08
[2025-01-06 11:14:07,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.01 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:14:07,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.59 | bwd_microstep: 9825.90 | bwd_inner_microstep: 9171.18 | bwd_allreduce_microstep: 654.69 | step_microstep: 169.90
[2025-01-06 11:14:07,405] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.57 | bwd: 9825.90 | bwd_inner: 9171.17 | bwd_allreduce: 654.69 | step: 169.89
[2025-01-06 11:14:20,675] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.57 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:14:20,675] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.81 | bwd_microstep: 9843.48 | bwd_inner_microstep: 9163.61 | bwd_allreduce_microstep: 679.84 | step_microstep: 173.34
[2025-01-06 11:14:20,676] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.79 | bwd: 9843.47 | bwd_inner: 9163.61 | bwd_allreduce: 679.84 | step: 173.35
[2025-01-06 11:14:33,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.13 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:14:33,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2970.71 | bwd_microstep: 9804.42 | bwd_inner_microstep: 9153.42 | bwd_allreduce_microstep: 650.96 | step_microstep: 168.04
[2025-01-06 11:14:33,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2970.69 | bwd: 9804.41 | bwd_inner: 9153.42 | bwd_allreduce: 650.96 | step: 168.03
[2025-01-06 11:14:47,146] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.23 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:14:47,146] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.125e-05, 1.125e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:14:47,146] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=48.6798673841054, CurrSamplesPerSec=48.70938821849038, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:14:47,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.48 | bwd_microstep: 9793.46 | bwd_inner_microstep: 9163.58 | bwd_allreduce_microstep: 629.84 | step_microstep: 169.55
[2025-01-06 11:14:47,147] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.46 | bwd: 9793.45 | bwd_inner: 9163.58 | bwd_allreduce: 629.84 | step: 169.55
 samples/sec: 48.373 | iteration      180/  320000 | elapsed time per iteration (ms): 13230.5 | learning rate: 1.125E-05 | approx flops per GPU: 147.3TFLOPS | MFU: 35.40% | HFU: 47.20% | lm_loss: 5.920867E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3244.59 | backward: 9798.68 | backward-backward: 9798.65 | backward-allreduce: 0.00 | optimizer: 170.25 | batch generator: 69.23
[2025-01-06 11:15:00,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.26 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:15:00,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.04 | bwd_microstep: 9809.19 | bwd_inner_microstep: 9177.41 | bwd_allreduce_microstep: 631.75 | step_microstep: 164.03
[2025-01-06 11:15:00,399] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.02 | bwd: 9809.18 | bwd_inner: 9177.40 | bwd_allreduce: 631.75 | step: 164.03
[2025-01-06 11:15:13,691] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.51 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:15:13,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.13 | bwd_microstep: 9838.25 | bwd_inner_microstep: 9190.92 | bwd_allreduce_microstep: 647.28 | step_microstep: 167.06
[2025-01-06 11:15:13,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.11 | bwd: 9838.24 | bwd_inner: 9190.91 | bwd_allreduce: 647.28 | step: 167.06
[2025-01-06 11:15:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 145.90 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:15:26,966] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.18 | bwd_microstep: 9842.53 | bwd_inner_microstep: 9161.81 | bwd_allreduce_microstep: 680.67 | step_microstep: 160.55
[2025-01-06 11:15:26,967] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.17 | bwd: 9842.52 | bwd_inner: 9161.81 | bwd_allreduce: 680.67 | step: 160.54
[2025-01-06 11:15:40,244] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.32 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:15:40,244] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.27 | bwd_microstep: 9830.34 | bwd_inner_microstep: 9191.49 | bwd_allreduce_microstep: 638.81 | step_microstep: 174.09
[2025-01-06 11:15:40,245] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.26 | bwd: 9830.33 | bwd_inner: 9191.48 | bwd_allreduce: 638.81 | step: 174.09
[2025-01-06 11:15:53,453] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.42 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:15:53,454] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2982.45 | bwd_microstep: 9777.78 | bwd_inner_microstep: 9164.75 | bwd_allreduce_microstep: 612.99 | step_microstep: 172.22
[2025-01-06 11:15:53,454] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2982.44 | bwd: 9777.77 | bwd_inner: 9164.74 | bwd_allreduce: 612.99 | step: 172.23
[2025-01-06 11:16:06,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.48 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:16:06,668] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.37 | bwd_microstep: 9806.04 | bwd_inner_microstep: 9157.40 | bwd_allreduce_microstep: 648.60 | step_microstep: 165.34
[2025-01-06 11:16:06,668] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.36 | bwd: 9806.03 | bwd_inner: 9157.39 | bwd_allreduce: 648.60 | step: 165.34
[2025-01-06 11:16:19,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.52 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:16:19,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.18 | bwd_microstep: 9821.20 | bwd_inner_microstep: 9140.80 | bwd_allreduce_microstep: 680.37 | step_microstep: 171.35
[2025-01-06 11:16:19,892] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.17 | bwd: 9821.19 | bwd_inner: 9140.79 | bwd_allreduce: 680.37 | step: 171.35
[2025-01-06 11:16:33,132] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.75 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:16:33,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.45 | bwd_microstep: 9804.36 | bwd_inner_microstep: 9166.05 | bwd_allreduce_microstep: 638.27 | step_microstep: 174.48
[2025-01-06 11:16:33,133] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.43 | bwd: 9804.35 | bwd_inner: 9166.04 | bwd_allreduce: 638.27 | step: 174.48
[2025-01-06 11:16:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.50 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:16:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.47 | bwd_microstep: 9854.47 | bwd_inner_microstep: 9165.20 | bwd_allreduce_microstep: 689.23 | step_microstep: 164.11
[2025-01-06 11:16:46,392] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.46 | bwd: 9854.46 | bwd_inner: 9165.19 | bwd_allreduce: 689.23 | step: 164.12
[2025-01-06 11:16:59,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.21 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:16:59,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[1.1874999999999999e-05, 1.1874999999999999e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:16:59,609] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=48.676066505601604, CurrSamplesPerSec=48.65639641155359, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:16:59,609] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.06 | bwd_microstep: 9810.92 | bwd_inner_microstep: 9159.63 | bwd_allreduce_microstep: 651.25 | step_microstep: 164.38
[2025-01-06 11:16:59,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.05 | bwd: 9810.91 | bwd_inner: 9159.63 | bwd_allreduce: 651.25 | step: 164.38
 samples/sec: 48.331 | iteration      190/  320000 | elapsed time per iteration (ms): 13242.0 | learning rate: 1.187E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.37% | HFU: 47.16% | lm_loss: 5.770014E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3247.54 | backward: 9819.73 | backward-backward: 9819.69 | backward-allreduce: 0.00 | optimizer: 168.07 | batch generator: 68.02
[2025-01-06 11:17:12,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.96 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:17:12,852] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.59 | bwd_microstep: 9825.67 | bwd_inner_microstep: 9149.82 | bwd_allreduce_microstep: 675.82 | step_microstep: 166.66
[2025-01-06 11:17:12,852] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.58 | bwd: 9825.67 | bwd_inner: 9149.81 | bwd_allreduce: 675.82 | step: 166.66
[2025-01-06 11:17:26,069] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.90 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:17:26,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.12 | bwd_microstep: 9791.47 | bwd_inner_microstep: 9157.05 | bwd_allreduce_microstep: 634.38 | step_microstep: 173.58
[2025-01-06 11:17:26,070] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.10 | bwd: 9791.46 | bwd_inner: 9157.04 | bwd_allreduce: 634.38 | step: 173.58
[2025-01-06 11:17:39,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.63 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:17:39,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.98 | bwd_microstep: 9806.99 | bwd_inner_microstep: 9182.48 | bwd_allreduce_microstep: 624.48 | step_microstep: 163.50
[2025-01-06 11:17:39,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.97 | bwd: 9806.98 | bwd_inner: 9182.47 | bwd_allreduce: 624.48 | step: 163.50
[2025-01-06 11:17:52,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.32 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:17:52,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2975.56 | bwd_microstep: 9825.08 | bwd_inner_microstep: 9147.67 | bwd_allreduce_microstep: 677.38 | step_microstep: 175.18
[2025-01-06 11:17:52,532] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2975.54 | bwd: 9825.08 | bwd_inner: 9147.66 | bwd_allreduce: 677.38 | step: 175.18
[2025-01-06 11:18:05,782] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.48 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:18:05,783] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.79 | bwd_microstep: 9853.03 | bwd_inner_microstep: 9174.61 | bwd_allreduce_microstep: 678.38 | step_microstep: 163.29
[2025-01-06 11:18:05,783] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.78 | bwd: 9853.02 | bwd_inner: 9174.61 | bwd_allreduce: 678.38 | step: 163.29
[2025-01-06 11:18:19,011] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.90 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:18:19,012] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.28 | bwd_microstep: 9833.66 | bwd_inner_microstep: 9160.06 | bwd_allreduce_microstep: 673.56 | step_microstep: 165.76
[2025-01-06 11:18:19,012] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.27 | bwd: 9833.65 | bwd_inner: 9160.06 | bwd_allreduce: 673.56 | step: 165.76
[2025-01-06 11:18:32,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.90 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:18:32,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2967.43 | bwd_microstep: 9827.84 | bwd_inner_microstep: 9150.51 | bwd_allreduce_microstep: 677.30 | step_microstep: 167.70
[2025-01-06 11:18:32,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2967.42 | bwd: 9827.83 | bwd_inner: 9150.50 | bwd_allreduce: 677.30 | step: 167.70
[2025-01-06 11:18:45,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.87 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:18:45,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.42 | bwd_microstep: 9832.73 | bwd_inner_microstep: 9158.44 | bwd_allreduce_microstep: 674.26 | step_microstep: 174.66
[2025-01-06 11:18:45,537] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.40 | bwd: 9832.73 | bwd_inner: 9158.43 | bwd_allreduce: 674.26 | step: 174.66
[2025-01-06 11:18:58,797] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.15 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:18:58,797] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2980.08 | bwd_microstep: 9828.30 | bwd_inner_microstep: 9155.49 | bwd_allreduce_microstep: 672.77 | step_microstep: 165.99
[2025-01-06 11:18:58,798] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2980.06 | bwd: 9828.29 | bwd_inner: 9155.48 | bwd_allreduce: 672.77 | step: 165.98
[2025-01-06 11:19:11,997] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.58 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:19:11,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[1.25e-05, 1.25e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:19:11,998] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=48.67218333550824, CurrSamplesPerSec=48.82632240968055, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:19:11,998] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.56 | bwd_microstep: 9759.66 | bwd_inner_microstep: 9166.15 | bwd_allreduce_microstep: 593.47 | step_microstep: 174.97
[2025-01-06 11:19:11,998] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.55 | bwd: 9759.65 | bwd_inner: 9166.14 | bwd_allreduce: 593.47 | step: 174.98
 samples/sec: 48.342 | iteration      200/  320000 | elapsed time per iteration (ms): 13238.9 | learning rate: 1.250E-05 | approx flops per GPU: 147.2TFLOPS | MFU: 35.38% | HFU: 47.17% | lm_loss: 5.650142E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3240.42 | backward: 9818.65 | backward-backward: 9818.61 | backward-allreduce: 0.00 | optimizer: 169.50 | batch generator: 59.16
[2025-01-06 11:19:25,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.99 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:19:25,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.01 | bwd_microstep: 9826.86 | bwd_inner_microstep: 9157.90 | bwd_allreduce_microstep: 668.93 | step_microstep: 164.75
[2025-01-06 11:19:25,254] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.99 | bwd: 9826.86 | bwd_inner: 9157.89 | bwd_allreduce: 668.93 | step: 164.75
[2025-01-06 11:19:38,517] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.36 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:19:38,517] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2968.24 | bwd_microstep: 9860.85 | bwd_inner_microstep: 9142.82 | bwd_allreduce_microstep: 718.00 | step_microstep: 164.16
[2025-01-06 11:19:38,517] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2968.23 | bwd: 9860.84 | bwd_inner: 9142.81 | bwd_allreduce: 718.00 | step: 164.16
[2025-01-06 11:19:51,819] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.26 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:19:51,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2969.66 | bwd_microstep: 9868.43 | bwd_inner_microstep: 9165.01 | bwd_allreduce_microstep: 703.38 | step_microstep: 172.98
[2025-01-06 11:19:51,820] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2969.64 | bwd: 9868.42 | bwd_inner: 9165.00 | bwd_allreduce: 703.38 | step: 172.98
[2025-01-06 11:20:05,088] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.39 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:20:05,088] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.63 | bwd_microstep: 9830.69 | bwd_inner_microstep: 9140.33 | bwd_allreduce_microstep: 690.33 | step_microstep: 173.23
[2025-01-06 11:20:05,088] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.62 | bwd: 9830.69 | bwd_inner: 9140.33 | bwd_allreduce: 690.33 | step: 173.24
[2025-01-06 11:20:18,335] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.65 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:20:18,336] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.94 | bwd_microstep: 9833.81 | bwd_inner_microstep: 9166.22 | bwd_allreduce_microstep: 667.55 | step_microstep: 169.56
[2025-01-06 11:20:18,336] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.93 | bwd: 9833.80 | bwd_inner: 9166.21 | bwd_allreduce: 667.55 | step: 169.56
[2025-01-06 11:20:31,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.96 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:20:31,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.67 | bwd_microstep: 9828.78 | bwd_inner_microstep: 9166.15 | bwd_allreduce_microstep: 662.59 | step_microstep: 173.76
[2025-01-06 11:20:31,611] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.66 | bwd: 9828.77 | bwd_inner: 9166.15 | bwd_allreduce: 662.58 | step: 173.75
[2025-01-06 11:20:44,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.02 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:20:44,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.23 | bwd_microstep: 9827.77 | bwd_inner_microstep: 9163.21 | bwd_allreduce_microstep: 664.52 | step_microstep: 173.87
[2025-01-06 11:20:44,893] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.21 | bwd: 9827.76 | bwd_inner: 9163.21 | bwd_allreduce: 664.52 | step: 173.88
[2025-01-06 11:20:58,171] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.91 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:20:58,172] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.20 | bwd_microstep: 9829.54 | bwd_inner_microstep: 9170.31 | bwd_allreduce_microstep: 659.20 | step_microstep: 165.67
[2025-01-06 11:20:58,172] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.19 | bwd: 9829.53 | bwd_inner: 9170.31 | bwd_allreduce: 659.20 | step: 165.67
[2025-01-06 11:21:11,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.06 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:21:11,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.14 | bwd_microstep: 9747.46 | bwd_inner_microstep: 9153.59 | bwd_allreduce_microstep: 593.84 | step_microstep: 165.82
[2025-01-06 11:21:11,371] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.13 | bwd: 9747.45 | bwd_inner: 9153.58 | bwd_allreduce: 593.84 | step: 165.82
[2025-01-06 11:21:24,620] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.37 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:21:24,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[1.3125e-05, 1.3125e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:21:24,621] [INFO] [timer.py:260:stop] epoch=0/micro_step=210/global_step=210, RunningAvgSamplesPerSec=48.667183897027265, CurrSamplesPerSec=48.66730142153023, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:21:24,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.39 | bwd_microstep: 9806.86 | bwd_inner_microstep: 9161.72 | bwd_allreduce_microstep: 645.09 | step_microstep: 170.66
[2025-01-06 11:21:24,621] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.38 | bwd: 9806.85 | bwd_inner: 9161.72 | bwd_allreduce: 645.09 | step: 170.67
 samples/sec: 48.257 | iteration      210/  320000 | elapsed time per iteration (ms): 13262.3 | learning rate: 1.313E-05 | approx flops per GPU: 146.9TFLOPS | MFU: 35.32% | HFU: 47.09% | lm_loss: 5.505239E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3246.44 | backward: 9826.41 | backward-backward: 9826.37 | backward-allreduce: 0.00 | optimizer: 169.82 | batch generator: 64.88
[2025-01-06 11:21:37,827] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.35 | optimizer_gradients: 2.58 | optimizer_step: 4.35
[2025-01-06 11:21:37,828] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.99 | bwd_microstep: 9785.70 | bwd_inner_microstep: 9154.04 | bwd_allreduce_microstep: 631.62 | step_microstep: 173.15
[2025-01-06 11:21:37,828] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.98 | bwd: 9785.69 | bwd_inner: 9154.04 | bwd_allreduce: 631.62 | step: 173.16
[2025-01-06 11:21:51,073] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.69 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:21:51,073] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.13 | bwd_microstep: 9825.66 | bwd_inner_microstep: 9148.11 | bwd_allreduce_microstep: 677.51 | step_microstep: 166.43
[2025-01-06 11:21:51,074] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.12 | bwd: 9825.65 | bwd_inner: 9148.10 | bwd_allreduce: 677.51 | step: 166.43
[2025-01-06 11:22:04,290] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.53 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:22:04,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.77 | bwd_microstep: 9787.47 | bwd_inner_microstep: 9169.92 | bwd_allreduce_microstep: 617.51 | step_microstep: 171.30
[2025-01-06 11:22:04,291] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.76 | bwd: 9787.46 | bwd_inner: 9169.91 | bwd_allreduce: 617.51 | step: 171.30
[2025-01-06 11:22:17,535] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.87 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:22:17,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.14 | bwd_microstep: 9808.12 | bwd_inner_microstep: 9167.04 | bwd_allreduce_microstep: 641.04 | step_microstep: 173.59
[2025-01-06 11:22:17,536] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.12 | bwd: 9808.11 | bwd_inner: 9167.04 | bwd_allreduce: 641.04 | step: 173.59
[2025-01-06 11:22:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.27 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:22:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.38 | bwd_microstep: 9794.52 | bwd_inner_microstep: 9151.31 | bwd_allreduce_microstep: 643.17 | step_microstep: 164.07
[2025-01-06 11:22:30,760] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2962.37 | bwd: 9794.51 | bwd_inner: 9151.30 | bwd_allreduce: 643.17 | step: 164.08
[2025-01-06 11:22:44,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.44 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:22:44,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.22 | bwd_microstep: 9816.60 | bwd_inner_microstep: 9168.20 | bwd_allreduce_microstep: 648.36 | step_microstep: 167.24
[2025-01-06 11:22:44,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2962.21 | bwd: 9816.59 | bwd_inner: 9168.19 | bwd_allreduce: 648.37 | step: 167.24
[2025-01-06 11:22:57,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.16 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:22:57,273] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.80 | bwd_microstep: 9823.09 | bwd_inner_microstep: 9148.54 | bwd_allreduce_microstep: 674.52 | step_microstep: 178.68
[2025-01-06 11:22:57,274] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.79 | bwd: 9823.08 | bwd_inner: 9148.53 | bwd_allreduce: 674.52 | step: 178.68
[2025-01-06 11:23:10,513] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.53 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:23:10,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.49 | bwd_microstep: 9806.04 | bwd_inner_microstep: 9162.44 | bwd_allreduce_microstep: 643.56 | step_microstep: 169.28
[2025-01-06 11:23:10,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.48 | bwd: 9806.03 | bwd_inner: 9162.44 | bwd_allreduce: 643.56 | step: 169.27
[2025-01-06 11:23:23,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.04 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:23:23,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.17 | bwd_microstep: 9850.45 | bwd_inner_microstep: 9149.70 | bwd_allreduce_microstep: 700.71 | step_microstep: 171.97
[2025-01-06 11:23:23,789] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.15 | bwd: 9850.44 | bwd_inner: 9149.69 | bwd_allreduce: 700.71 | step: 171.97
[2025-01-06 11:23:37,035] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.06 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:23:37,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[1.3750000000000002e-05, 1.3750000000000002e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:23:37,036] [INFO] [timer.py:260:stop] epoch=0/micro_step=220/global_step=220, RunningAvgSamplesPerSec=48.6661774913919, CurrSamplesPerSec=48.66994416532425, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:23:37,036] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.44 | bwd_microstep: 9804.19 | bwd_inner_microstep: 9165.86 | bwd_allreduce_microstep: 638.30 | step_microstep: 172.45
[2025-01-06 11:23:37,036] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.42 | bwd: 9804.19 | bwd_inner: 9165.85 | bwd_allreduce: 638.30 | step: 172.45
 samples/sec: 48.330 | iteration      220/  320000 | elapsed time per iteration (ms): 13242.2 | learning rate: 1.375E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.37% | HFU: 47.16% | lm_loss: 5.420271E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3246.13 | backward: 9810.52 | backward-backward: 9810.49 | backward-allreduce: 0.00 | optimizer: 171.19 | batch generator: 70.88
[2025-01-06 11:23:50,275] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.92 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:23:50,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.46 | bwd_microstep: 9833.68 | bwd_inner_microstep: 9163.88 | bwd_allreduce_microstep: 669.75 | step_microstep: 163.60
[2025-01-06 11:23:50,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.45 | bwd: 9833.67 | bwd_inner: 9163.88 | bwd_allreduce: 669.75 | step: 163.60
[2025-01-06 11:24:03,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.38 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:24:03,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.84 | bwd_microstep: 9863.56 | bwd_inner_microstep: 9152.06 | bwd_allreduce_microstep: 711.46 | step_microstep: 170.21
[2025-01-06 11:24:03,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.83 | bwd: 9863.55 | bwd_inner: 9152.05 | bwd_allreduce: 711.46 | step: 170.21
[2025-01-06 11:24:16,822] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.81 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:24:16,822] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.38 | bwd_microstep: 9834.71 | bwd_inner_microstep: 9179.20 | bwd_allreduce_microstep: 655.47 | step_microstep: 172.46
[2025-01-06 11:24:16,822] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.37 | bwd: 9834.70 | bwd_inner: 9179.19 | bwd_allreduce: 655.47 | step: 172.45
[2025-01-06 11:24:30,047] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.13 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:24:30,047] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2968.59 | bwd_microstep: 9807.28 | bwd_inner_microstep: 9162.16 | bwd_allreduce_microstep: 645.09 | step_microstep: 164.03
[2025-01-06 11:24:30,047] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2968.58 | bwd: 9807.27 | bwd_inner: 9162.15 | bwd_allreduce: 645.09 | step: 164.04
[2025-01-06 11:24:43,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.65 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:24:43,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.07 | bwd_microstep: 9785.39 | bwd_inner_microstep: 9142.98 | bwd_allreduce_microstep: 642.37 | step_microstep: 173.68
[2025-01-06 11:24:43,289] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.05 | bwd: 9785.38 | bwd_inner: 9142.98 | bwd_allreduce: 642.37 | step: 173.68
[2025-01-06 11:24:56,513] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.97 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:24:56,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.86 | bwd_microstep: 9777.36 | bwd_inner_microstep: 9158.66 | bwd_allreduce_microstep: 618.66 | step_microstep: 163.69
[2025-01-06 11:24:56,514] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.85 | bwd: 9777.35 | bwd_inner: 9158.65 | bwd_allreduce: 618.66 | step: 163.69
[2025-01-06 11:25:09,710] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.28 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:25:09,711] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.84 | bwd_microstep: 9768.53 | bwd_inner_microstep: 9153.92 | bwd_allreduce_microstep: 614.57 | step_microstep: 172.95
[2025-01-06 11:25:09,711] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.83 | bwd: 9768.52 | bwd_inner: 9153.91 | bwd_allreduce: 614.57 | step: 172.94
[2025-01-06 11:25:22,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.39 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:25:22,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.71 | bwd_microstep: 9822.92 | bwd_inner_microstep: 9176.65 | bwd_allreduce_microstep: 646.23 | step_microstep: 168.12
[2025-01-06 11:25:22,956] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.69 | bwd: 9822.91 | bwd_inner: 9176.64 | bwd_allreduce: 646.23 | step: 168.12
[2025-01-06 11:25:36,233] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.52 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:25:36,233] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.81 | bwd_microstep: 9861.93 | bwd_inner_microstep: 9168.50 | bwd_allreduce_microstep: 693.39 | step_microstep: 173.29
[2025-01-06 11:25:36,233] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.79 | bwd: 9861.92 | bwd_inner: 9168.50 | bwd_allreduce: 693.39 | step: 173.30
[2025-01-06 11:25:49,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.62 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:25:49,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[1.4375e-05, 1.4375e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:25:49,461] [INFO] [timer.py:260:stop] epoch=0/micro_step=230/global_step=230, RunningAvgSamplesPerSec=48.66358069213686, CurrSamplesPerSec=48.66219322462661, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:25:49,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.91 | bwd_microstep: 9800.76 | bwd_inner_microstep: 9157.78 | bwd_allreduce_microstep: 642.94 | step_microstep: 169.04
[2025-01-06 11:25:49,462] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.90 | bwd: 9800.75 | bwd_inner: 9157.77 | bwd_allreduce: 642.94 | step: 169.05
 samples/sec: 48.332 | iteration      230/  320000 | elapsed time per iteration (ms): 13241.8 | learning rate: 1.438E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.37% | HFU: 47.16% | lm_loss: 5.352230E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3242.85 | backward: 9815.92 | backward-backward: 9815.88 | backward-allreduce: 0.00 | optimizer: 169.46 | batch generator: 60.93
[2025-01-06 11:26:02,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.89 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:26:02,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.76 | bwd_microstep: 9796.56 | bwd_inner_microstep: 9165.83 | bwd_allreduce_microstep: 630.70 | step_microstep: 169.62
[2025-01-06 11:26:02,667] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.75 | bwd: 9796.55 | bwd_inner: 9165.83 | bwd_allreduce: 630.70 | step: 169.62
[2025-01-06 11:26:15,880] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.01 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:26:15,881] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.20 | bwd_microstep: 9795.68 | bwd_inner_microstep: 9140.24 | bwd_allreduce_microstep: 655.40 | step_microstep: 164.63
[2025-01-06 11:26:15,881] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.18 | bwd: 9795.67 | bwd_inner: 9140.23 | bwd_allreduce: 655.40 | step: 164.62
[2025-01-06 11:26:29,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.44 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:26:29,102] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.14 | bwd_microstep: 9816.60 | bwd_inner_microstep: 9164.61 | bwd_allreduce_microstep: 651.96 | step_microstep: 169.18
[2025-01-06 11:26:29,103] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.13 | bwd: 9816.59 | bwd_inner: 9164.60 | bwd_allreduce: 651.96 | step: 169.19
[2025-01-06 11:26:42,343] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.54 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:26:42,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.19 | bwd_microstep: 9808.57 | bwd_inner_microstep: 9167.38 | bwd_allreduce_microstep: 641.15 | step_microstep: 168.59
[2025-01-06 11:26:42,344] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.17 | bwd: 9808.56 | bwd_inner: 9167.38 | bwd_allreduce: 641.15 | step: 168.60
[2025-01-06 11:26:55,553] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.95 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:26:55,553] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.57 | bwd_microstep: 9794.00 | bwd_inner_microstep: 9150.68 | bwd_allreduce_microstep: 643.27 | step_microstep: 164.74
[2025-01-06 11:26:55,553] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.56 | bwd: 9793.98 | bwd_inner: 9150.67 | bwd_allreduce: 643.27 | step: 164.75
[2025-01-06 11:27:08,739] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.58 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:27:08,739] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.77 | bwd_microstep: 9761.31 | bwd_inner_microstep: 9170.16 | bwd_allreduce_microstep: 591.11 | step_microstep: 172.34
[2025-01-06 11:27:08,739] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.76 | bwd: 9761.30 | bwd_inner: 9170.16 | bwd_allreduce: 591.11 | step: 172.34
[2025-01-06 11:27:21,943] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.53 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:27:21,944] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.94 | bwd_microstep: 9757.80 | bwd_inner_microstep: 9153.10 | bwd_allreduce_microstep: 604.66 | step_microstep: 174.26
[2025-01-06 11:27:21,944] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.93 | bwd: 9757.79 | bwd_inner: 9153.10 | bwd_allreduce: 604.66 | step: 174.26
[2025-01-06 11:27:35,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.37 | optimizer_gradients: 2.61 | optimizer_step: 4.36
[2025-01-06 11:27:35,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.33 | bwd_microstep: 9820.96 | bwd_inner_microstep: 9141.77 | bwd_allreduce_microstep: 679.16 | step_microstep: 168.30
[2025-01-06 11:27:35,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.32 | bwd: 9820.95 | bwd_inner: 9141.76 | bwd_allreduce: 679.16 | step: 168.30
[2025-01-06 11:27:48,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.29 | optimizer_gradients: 2.56 | optimizer_step: 4.40
[2025-01-06 11:27:48,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.82 | bwd_microstep: 9897.97 | bwd_inner_microstep: 9170.17 | bwd_allreduce_microstep: 727.76 | step_microstep: 165.13
[2025-01-06 11:27:48,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.81 | bwd: 9897.96 | bwd_inner: 9170.16 | bwd_allreduce: 727.76 | step: 165.12
[2025-01-06 11:28:01,689] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.80 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:28:01,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[1.5e-05, 1.5e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:28:01,690] [INFO] [timer.py:260:stop] epoch=0/micro_step=240/global_step=240, RunningAvgSamplesPerSec=48.6633560215604, CurrSamplesPerSec=48.584001602408726, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:28:01,690] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.68 | bwd_microstep: 9825.48 | bwd_inner_microstep: 9144.25 | bwd_allreduce_microstep: 681.20 | step_microstep: 175.13
[2025-01-06 11:28:01,690] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.67 | bwd: 9825.47 | bwd_inner: 9144.24 | bwd_allreduce: 681.20 | step: 175.14
 samples/sec: 48.401 | iteration      240/  320000 | elapsed time per iteration (ms): 13222.9 | learning rate: 1.500E-05 | approx flops per GPU: 147.4TFLOPS | MFU: 35.42% | HFU: 47.23% | lm_loss: 5.240322E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3229.25 | backward: 9807.77 | backward-backward: 9807.73 | backward-allreduce: 0.00 | optimizer: 169.56 | batch generator: 53.13
[2025-01-06 11:28:14,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.76 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:28:14,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.16 | bwd_microstep: 9804.82 | bwd_inner_microstep: 9149.50 | bwd_allreduce_microstep: 655.28 | step_microstep: 166.50
[2025-01-06 11:28:14,907] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.14 | bwd: 9804.81 | bwd_inner: 9149.50 | bwd_allreduce: 655.28 | step: 166.50
[2025-01-06 11:28:28,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.72 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:28:28,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.62 | bwd_microstep: 9802.27 | bwd_inner_microstep: 9161.92 | bwd_allreduce_microstep: 640.32 | step_microstep: 164.62
[2025-01-06 11:28:28,143] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.61 | bwd: 9802.26 | bwd_inner: 9161.91 | bwd_allreduce: 640.32 | step: 164.62
[2025-01-06 11:28:41,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.89 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:28:41,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2974.82 | bwd_microstep: 9839.33 | bwd_inner_microstep: 9155.24 | bwd_allreduce_microstep: 684.04 | step_microstep: 174.65
[2025-01-06 11:28:41,408] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2974.81 | bwd: 9839.31 | bwd_inner: 9155.23 | bwd_allreduce: 684.04 | step: 174.66
[2025-01-06 11:28:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.55 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:28:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.06 | bwd_microstep: 9825.12 | bwd_inner_microstep: 9167.65 | bwd_allreduce_microstep: 657.43 | step_microstep: 173.25
[2025-01-06 11:28:54,658] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.05 | bwd: 9825.11 | bwd_inner: 9167.64 | bwd_allreduce: 657.43 | step: 173.25
[2025-01-06 11:29:07,917] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.95 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:29:07,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.39 | bwd_microstep: 9826.16 | bwd_inner_microstep: 9147.18 | bwd_allreduce_microstep: 678.94 | step_microstep: 171.85
[2025-01-06 11:29:07,918] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.38 | bwd: 9826.15 | bwd_inner: 9147.18 | bwd_allreduce: 678.94 | step: 171.85
[2025-01-06 11:29:21,201] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.09 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:29:21,201] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.69 | bwd_microstep: 9851.90 | bwd_inner_microstep: 9151.92 | bwd_allreduce_microstep: 699.93 | step_microstep: 165.93
[2025-01-06 11:29:21,202] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.68 | bwd: 9851.89 | bwd_inner: 9151.92 | bwd_allreduce: 699.93 | step: 165.94
[2025-01-06 11:29:34,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.71 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:29:34,476] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.12 | bwd_microstep: 9835.70 | bwd_inner_microstep: 9162.05 | bwd_allreduce_microstep: 673.62 | step_microstep: 166.44
[2025-01-06 11:29:34,477] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.11 | bwd: 9835.70 | bwd_inner: 9162.05 | bwd_allreduce: 673.62 | step: 166.44
[2025-01-06 11:29:47,749] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.07 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:29:47,750] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.58 | bwd_microstep: 9828.81 | bwd_inner_microstep: 9164.49 | bwd_allreduce_microstep: 664.28 | step_microstep: 168.82
[2025-01-06 11:29:47,750] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.57 | bwd: 9828.80 | bwd_inner: 9164.49 | bwd_allreduce: 664.28 | step: 168.82
[2025-01-06 11:30:00,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.77 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:30:00,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.39 | bwd_microstep: 9806.76 | bwd_inner_microstep: 9143.77 | bwd_allreduce_microstep: 662.95 | step_microstep: 172.59
[2025-01-06 11:30:00,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.38 | bwd: 9806.75 | bwd_inner: 9143.77 | bwd_allreduce: 662.95 | step: 172.59
[2025-01-06 11:30:14,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.13 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:30:14,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[1.5625e-05, 1.5625e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:30:14,222] [INFO] [timer.py:260:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=48.66084006581201, CurrSamplesPerSec=48.72312645571517, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:30:14,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.87 | bwd_microstep: 9787.67 | bwd_inner_microstep: 9158.24 | bwd_allreduce_microstep: 629.39 | step_microstep: 172.33
[2025-01-06 11:30:14,222] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.86 | bwd: 9787.66 | bwd_inner: 9158.24 | bwd_allreduce: 629.39 | step: 172.33
 samples/sec: 48.290 | iteration      250/  320000 | elapsed time per iteration (ms): 13253.2 | learning rate: 1.563E-05 | approx flops per GPU: 147.0TFLOPS | MFU: 35.34% | HFU: 47.12% | lm_loss: 5.167937E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3254.02 | backward: 9821.12 | backward-backward: 9821.09 | backward-allreduce: 0.00 | optimizer: 170.05 | batch generator: 74.17
[2025-01-06 11:30:27,445] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 146.28 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:30:27,445] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.07 | bwd_microstep: 9796.31 | bwd_inner_microstep: 9149.75 | bwd_allreduce_microstep: 646.53 | step_microstep: 161.02
[2025-01-06 11:30:27,446] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.07 | bwd: 9796.31 | bwd_inner: 9149.75 | bwd_allreduce: 646.53 | step: 161.02
[2025-01-06 11:30:40,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.55 | optimizer_gradients: 2.55 | optimizer_step: 4.40
[2025-01-06 11:30:40,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.19 | bwd_microstep: 9790.12 | bwd_inner_microstep: 9162.90 | bwd_allreduce_microstep: 627.18 | step_microstep: 167.30
[2025-01-06 11:30:40,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.17 | bwd: 9790.11 | bwd_inner: 9162.90 | bwd_allreduce: 627.18 | step: 167.29
[2025-01-06 11:30:53,925] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.50 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:30:53,925] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.04 | bwd_microstep: 9816.75 | bwd_inner_microstep: 9158.69 | bwd_allreduce_microstep: 658.02 | step_microstep: 174.34
[2025-01-06 11:30:53,926] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.03 | bwd: 9816.74 | bwd_inner: 9158.68 | bwd_allreduce: 658.02 | step: 174.35
[2025-01-06 11:31:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.71 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:31:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.58 | bwd_microstep: 9814.61 | bwd_inner_microstep: 9163.64 | bwd_allreduce_microstep: 650.94 | step_microstep: 174.71
[2025-01-06 11:31:07,183] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.56 | bwd: 9814.60 | bwd_inner: 9163.63 | bwd_allreduce: 650.94 | step: 174.70
[2025-01-06 11:31:20,418] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.85 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:31:20,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.52 | bwd_microstep: 9829.50 | bwd_inner_microstep: 9143.53 | bwd_allreduce_microstep: 685.94 | step_microstep: 166.70
[2025-01-06 11:31:20,419] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.50 | bwd: 9829.49 | bwd_inner: 9143.52 | bwd_allreduce: 685.94 | step: 166.70
[2025-01-06 11:31:33,635] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.59 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:31:33,636] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.55 | bwd_microstep: 9786.88 | bwd_inner_microstep: 9165.87 | bwd_allreduce_microstep: 620.97 | step_microstep: 165.32
[2025-01-06 11:31:33,636] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.53 | bwd: 9786.87 | bwd_inner: 9165.87 | bwd_allreduce: 620.97 | step: 165.32
[2025-01-06 11:31:46,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.82 | optimizer_gradients: 2.54 | optimizer_step: 4.40
[2025-01-06 11:31:46,857] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.04 | bwd_microstep: 9789.88 | bwd_inner_microstep: 9149.61 | bwd_allreduce_microstep: 640.24 | step_microstep: 169.62
[2025-01-06 11:31:46,858] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.03 | bwd: 9789.88 | bwd_inner: 9149.60 | bwd_allreduce: 640.24 | step: 169.62
[2025-01-06 11:32:00,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.86 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:32:00,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2986.93 | bwd_microstep: 9837.26 | bwd_inner_microstep: 9213.09 | bwd_allreduce_microstep: 624.12 | step_microstep: 164.58
[2025-01-06 11:32:00,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2986.91 | bwd: 9837.25 | bwd_inner: 9213.08 | bwd_allreduce: 624.12 | step: 164.58
[2025-01-06 11:32:13,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.77 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:32:13,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.49 | bwd_microstep: 9863.93 | bwd_inner_microstep: 9180.97 | bwd_allreduce_microstep: 682.92 | step_microstep: 164.61
[2025-01-06 11:32:13,420] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.48 | bwd: 9863.92 | bwd_inner: 9180.97 | bwd_allreduce: 682.92 | step: 164.61
[2025-01-06 11:32:26,692] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.13 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:32:26,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[1.6250000000000002e-05, 1.6250000000000002e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:32:26,693] [INFO] [timer.py:260:stop] epoch=0/micro_step=260/global_step=260, RunningAvgSamplesPerSec=48.6591572140183, CurrSamplesPerSec=48.528685116303684, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:32:26,693] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.21 | bwd_microstep: 9821.54 | bwd_inner_microstep: 9146.44 | bwd_allreduce_microstep: 675.06 | step_microstep: 174.48
[2025-01-06 11:32:26,693] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.20 | bwd: 9821.53 | bwd_inner: 9146.44 | bwd_allreduce: 675.06 | step: 174.48
 samples/sec: 48.312 | iteration      260/  320000 | elapsed time per iteration (ms): 13247.1 | learning rate: 1.625E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.14% | lm_loss: 5.113612E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3252.33 | backward: 9814.93 | backward-backward: 9814.89 | backward-allreduce: 0.00 | optimizer: 168.61 | batch generator: 71.41
[2025-01-06 11:32:39,967] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.81 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:32:39,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.66 | bwd_microstep: 9830.49 | bwd_inner_microstep: 9168.08 | bwd_allreduce_microstep: 662.36 | step_microstep: 163.92
[2025-01-06 11:32:39,968] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2962.65 | bwd: 9830.48 | bwd_inner: 9168.08 | bwd_allreduce: 662.36 | step: 163.92
[2025-01-06 11:32:53,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.80 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:32:53,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.48 | bwd_microstep: 9829.54 | bwd_inner_microstep: 9151.56 | bwd_allreduce_microstep: 677.94 | step_microstep: 163.55
[2025-01-06 11:32:53,223] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.47 | bwd: 9829.53 | bwd_inner: 9151.56 | bwd_allreduce: 677.94 | step: 163.55
[2025-01-06 11:33:06,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.67 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:33:06,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.93 | bwd_microstep: 9821.77 | bwd_inner_microstep: 9149.76 | bwd_allreduce_microstep: 671.98 | step_microstep: 165.64
[2025-01-06 11:33:06,463] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.92 | bwd: 9821.76 | bwd_inner: 9149.76 | bwd_allreduce: 671.98 | step: 165.64
[2025-01-06 11:33:19,723] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.07 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:33:19,723] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.49 | bwd_microstep: 9830.60 | bwd_inner_microstep: 9179.08 | bwd_allreduce_microstep: 651.47 | step_microstep: 176.46
[2025-01-06 11:33:19,724] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.47 | bwd: 9830.58 | bwd_inner: 9179.07 | bwd_allreduce: 651.47 | step: 176.46
[2025-01-06 11:33:32,973] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.99 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 11:33:32,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.84 | bwd_microstep: 9827.78 | bwd_inner_microstep: 9155.24 | bwd_allreduce_microstep: 672.51 | step_microstep: 174.88
[2025-01-06 11:33:32,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.82 | bwd: 9827.77 | bwd_inner: 9155.23 | bwd_allreduce: 672.51 | step: 174.88
[2025-01-06 11:33:46,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.94 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:33:46,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.80 | bwd_microstep: 9839.93 | bwd_inner_microstep: 9153.03 | bwd_allreduce_microstep: 686.86 | step_microstep: 167.66
[2025-01-06 11:33:46,215] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.79 | bwd: 9839.92 | bwd_inner: 9153.03 | bwd_allreduce: 686.86 | step: 167.66
[2025-01-06 11:33:59,452] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.11 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:33:59,452] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.51 | bwd_microstep: 9809.28 | bwd_inner_microstep: 9150.03 | bwd_allreduce_microstep: 659.20 | step_microstep: 173.76
[2025-01-06 11:33:59,452] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.50 | bwd: 9809.26 | bwd_inner: 9150.02 | bwd_allreduce: 659.20 | step: 173.76
[2025-01-06 11:34:12,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.39 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:34:12,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.35 | bwd_microstep: 9816.10 | bwd_inner_microstep: 9150.02 | bwd_allreduce_microstep: 666.04 | step_microstep: 173.25
[2025-01-06 11:34:12,683] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.34 | bwd: 9816.09 | bwd_inner: 9150.02 | bwd_allreduce: 666.04 | step: 173.25
[2025-01-06 11:34:25,930] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.61 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 11:34:25,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.64 | bwd_microstep: 9815.05 | bwd_inner_microstep: 9157.07 | bwd_allreduce_microstep: 657.95 | step_microstep: 169.68
[2025-01-06 11:34:25,931] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.62 | bwd: 9815.05 | bwd_inner: 9157.07 | bwd_allreduce: 657.95 | step: 169.68
[2025-01-06 11:34:39,154] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.19 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:34:39,154] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[1.6875e-05, 1.6875e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:34:39,155] [INFO] [timer.py:260:stop] epoch=0/micro_step=270/global_step=270, RunningAvgSamplesPerSec=48.65721465025409, CurrSamplesPerSec=48.75857449050024, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:34:39,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.08 | bwd_microstep: 9788.12 | bwd_inner_microstep: 9137.15 | bwd_allreduce_microstep: 650.94 | step_microstep: 164.59
[2025-01-06 11:34:39,155] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.07 | bwd: 9788.12 | bwd_inner: 9137.15 | bwd_allreduce: 650.94 | step: 164.59
 samples/sec: 48.313 | iteration      270/  320000 | elapsed time per iteration (ms): 13246.9 | learning rate: 1.688E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.14% | lm_loss: 5.046814E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3250.44 | backward: 9821.12 | backward-backward: 9821.08 | backward-allreduce: 0.00 | optimizer: 169.70 | batch generator: 73.98
[2025-01-06 11:34:52,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.00 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:34:52,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.13 | bwd_microstep: 9801.75 | bwd_inner_microstep: 9148.88 | bwd_allreduce_microstep: 652.83 | step_microstep: 173.79
[2025-01-06 11:34:52,370] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.11 | bwd: 9801.74 | bwd_inner: 9148.87 | bwd_allreduce: 652.83 | step: 173.80
[2025-01-06 11:35:05,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.11 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:35:05,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.03 | bwd_microstep: 9835.71 | bwd_inner_microstep: 9150.56 | bwd_allreduce_microstep: 685.11 | step_microstep: 170.84
[2025-01-06 11:35:05,610] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.02 | bwd: 9835.70 | bwd_inner: 9150.56 | bwd_allreduce: 685.11 | step: 170.84
[2025-01-06 11:35:18,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.32 | optimizer_gradients: 2.55 | optimizer_step: 4.42
[2025-01-06 11:35:18,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2968.35 | bwd_microstep: 9814.73 | bwd_inner_microstep: 9134.85 | bwd_allreduce_microstep: 679.84 | step_microstep: 172.04
[2025-01-06 11:35:18,851] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2968.34 | bwd: 9814.72 | bwd_inner: 9134.84 | bwd_allreduce: 679.84 | step: 172.03
[2025-01-06 11:35:32,123] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.40 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:35:32,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.33 | bwd_microstep: 9862.41 | bwd_inner_microstep: 9174.14 | bwd_allreduce_microstep: 688.24 | step_microstep: 171.15
[2025-01-06 11:35:32,124] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.32 | bwd: 9862.40 | bwd_inner: 9174.13 | bwd_allreduce: 688.24 | step: 171.15
[2025-01-06 11:35:45,432] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.96 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:35:45,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2975.81 | bwd_microstep: 9894.63 | bwd_inner_microstep: 9176.24 | bwd_allreduce_microstep: 718.36 | step_microstep: 169.84
[2025-01-06 11:35:45,433] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2975.80 | bwd: 9894.63 | bwd_inner: 9176.24 | bwd_allreduce: 718.35 | step: 169.83
[2025-01-06 11:35:58,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.71 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:35:58,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.36 | bwd_microstep: 9891.75 | bwd_inner_microstep: 9174.67 | bwd_allreduce_microstep: 717.05 | step_microstep: 169.43
[2025-01-06 11:35:58,720] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.35 | bwd: 9891.74 | bwd_inner: 9174.66 | bwd_allreduce: 717.05 | step: 169.43
[2025-01-06 11:36:11,993] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.88 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:36:11,993] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.21 | bwd_microstep: 9874.40 | bwd_inner_microstep: 9196.23 | bwd_allreduce_microstep: 678.13 | step_microstep: 165.66
[2025-01-06 11:36:11,993] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2972.19 | bwd: 9874.39 | bwd_inner: 9196.22 | bwd_allreduce: 678.13 | step: 165.67
[2025-01-06 11:36:25,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.33 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:36:25,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2969.56 | bwd_microstep: 9891.64 | bwd_inner_microstep: 9206.32 | bwd_allreduce_microstep: 685.29 | step_microstep: 167.24
[2025-01-06 11:36:25,296] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2969.55 | bwd: 9891.64 | bwd_inner: 9206.31 | bwd_allreduce: 685.29 | step: 167.24
[2025-01-06 11:36:38,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.46 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:36:38,577] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.16 | bwd_microstep: 9878.79 | bwd_inner_microstep: 9166.54 | bwd_allreduce_microstep: 712.22 | step_microstep: 174.24
[2025-01-06 11:36:38,577] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.14 | bwd: 9878.78 | bwd_inner: 9166.53 | bwd_allreduce: 712.22 | step: 174.24
[2025-01-06 11:36:51,832] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.87 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:36:51,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[1.7500000000000002e-05, 1.7500000000000002e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:36:51,833] [INFO] [timer.py:260:stop] epoch=0/micro_step=280/global_step=280, RunningAvgSamplesPerSec=48.64905495925603, CurrSamplesPerSec=48.48993598222974, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:36:51,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.59 | bwd_microstep: 9836.63 | bwd_inner_microstep: 9159.62 | bwd_allreduce_microstep: 676.98 | step_microstep: 170.24
[2025-01-06 11:36:51,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.57 | bwd: 9836.62 | bwd_inner: 9159.62 | bwd_allreduce: 676.98 | step: 170.25
 samples/sec: 48.230 | iteration      280/  320000 | elapsed time per iteration (ms): 13269.7 | learning rate: 1.750E-05 | approx flops per GPU: 146.8TFLOPS | MFU: 35.30% | HFU: 47.06% | lm_loss: 4.948593E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3232.13 | backward: 9858.53 | backward-backward: 9858.49 | backward-allreduce: 0.00 | optimizer: 170.80 | batch generator: 46.41
[2025-01-06 11:37:05,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.10 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:37:05,053] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.27 | bwd_microstep: 9816.70 | bwd_inner_microstep: 9148.13 | bwd_allreduce_microstep: 668.54 | step_microstep: 170.91
[2025-01-06 11:37:05,054] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.26 | bwd: 9816.70 | bwd_inner: 9148.12 | bwd_allreduce: 668.54 | step: 170.92
[2025-01-06 11:37:18,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.23 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:37:18,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.97 | bwd_microstep: 9764.62 | bwd_inner_microstep: 9149.29 | bwd_allreduce_microstep: 615.30 | step_microstep: 175.16
[2025-01-06 11:37:18,261] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.95 | bwd: 9764.61 | bwd_inner: 9149.28 | bwd_allreduce: 615.30 | step: 175.16
[2025-01-06 11:37:31,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.88 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:37:31,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.65 | bwd_microstep: 9779.92 | bwd_inner_microstep: 9158.32 | bwd_allreduce_microstep: 621.57 | step_microstep: 175.04
[2025-01-06 11:37:31,486] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.63 | bwd: 9779.92 | bwd_inner: 9158.32 | bwd_allreduce: 621.57 | step: 175.04
[2025-01-06 11:37:44,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.94 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:37:44,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.41 | bwd_microstep: 9813.82 | bwd_inner_microstep: 9142.63 | bwd_allreduce_microstep: 671.16 | step_microstep: 168.82
[2025-01-06 11:37:44,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.40 | bwd: 9813.81 | bwd_inner: 9142.63 | bwd_allreduce: 671.16 | step: 168.82
[2025-01-06 11:37:57,995] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.54 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:37:57,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.15 | bwd_microstep: 9798.67 | bwd_inner_microstep: 9164.64 | bwd_allreduce_microstep: 634.00 | step_microstep: 172.21
[2025-01-06 11:37:57,996] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.14 | bwd: 9798.66 | bwd_inner: 9164.63 | bwd_allreduce: 634.00 | step: 172.21
[2025-01-06 11:38:11,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.38 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:38:11,280] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.73 | bwd_microstep: 9867.99 | bwd_inner_microstep: 9168.52 | bwd_allreduce_microstep: 699.44 | step_microstep: 165.14
[2025-01-06 11:38:11,281] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.72 | bwd: 9867.99 | bwd_inner: 9168.52 | bwd_allreduce: 699.44 | step: 165.14
[2025-01-06 11:38:24,569] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.94 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:38:24,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.52 | bwd_microstep: 9865.47 | bwd_inner_microstep: 9170.64 | bwd_allreduce_microstep: 694.79 | step_microstep: 174.86
[2025-01-06 11:38:24,570] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.51 | bwd: 9865.46 | bwd_inner: 9170.64 | bwd_allreduce: 694.79 | step: 174.87
[2025-01-06 11:38:37,866] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.28 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:38:37,867] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.29 | bwd_microstep: 9883.42 | bwd_inner_microstep: 9139.90 | bwd_allreduce_microstep: 743.48 | step_microstep: 172.95
[2025-01-06 11:38:37,867] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.28 | bwd: 9883.41 | bwd_inner: 9139.90 | bwd_allreduce: 743.48 | step: 172.95
[2025-01-06 11:38:51,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.39 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:38:51,166] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.14 | bwd_microstep: 9845.52 | bwd_inner_microstep: 9180.19 | bwd_allreduce_microstep: 665.29 | step_microstep: 171.34
[2025-01-06 11:38:51,167] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.12 | bwd: 9845.52 | bwd_inner: 9180.19 | bwd_allreduce: 665.29 | step: 171.34
[2025-01-06 11:39:04,472] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.93 | optimizer_gradients: 2.61 | optimizer_step: 4.39
[2025-01-06 11:39:04,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[1.8125e-05, 1.8125e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:39:04,473] [INFO] [timer.py:260:stop] epoch=0/micro_step=290/global_step=290, RunningAvgSamplesPerSec=48.64600308734099, CurrSamplesPerSec=48.398887434189184, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:39:04,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.15 | bwd_microstep: 9873.58 | bwd_inner_microstep: 9189.54 | bwd_allreduce_microstep: 684.00 | step_microstep: 167.39
[2025-01-06 11:39:04,473] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.14 | bwd: 9873.57 | bwd_inner: 9189.54 | bwd_allreduce: 684.00 | step: 167.39
 samples/sec: 48.260 | iteration      290/  320000 | elapsed time per iteration (ms): 13261.4 | learning rate: 1.813E-05 | approx flops per GPU: 146.9TFLOPS | MFU: 35.32% | HFU: 47.09% | lm_loss: 4.939920E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3247.09 | backward: 9831.31 | backward-backward: 9831.27 | backward-allreduce: 0.00 | optimizer: 171.75 | batch generator: 70.44
[2025-01-06 11:39:17,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.76 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:39:17,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2967.67 | bwd_microstep: 9879.97 | bwd_inner_microstep: 9145.41 | bwd_allreduce_microstep: 734.52 | step_microstep: 170.67
[2025-01-06 11:39:17,767] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2967.65 | bwd: 9879.96 | bwd_inner: 9145.41 | bwd_allreduce: 734.52 | step: 170.67
[2025-01-06 11:39:31,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.15 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:39:31,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2985.46 | bwd_microstep: 9806.92 | bwd_inner_microstep: 9181.90 | bwd_allreduce_microstep: 624.97 | step_microstep: 165.94
[2025-01-06 11:39:31,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2985.45 | bwd: 9806.90 | bwd_inner: 9181.89 | bwd_allreduce: 624.97 | step: 165.94
[2025-01-06 11:39:44,267] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.67 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:39:44,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.64 | bwd_microstep: 9817.04 | bwd_inner_microstep: 9163.48 | bwd_allreduce_microstep: 653.53 | step_microstep: 167.49
[2025-01-06 11:39:44,268] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.63 | bwd: 9817.03 | bwd_inner: 9163.47 | bwd_allreduce: 653.53 | step: 167.49
[2025-01-06 11:39:57,478] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.22 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:39:57,478] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.78 | bwd_microstep: 9776.71 | bwd_inner_microstep: 9148.39 | bwd_allreduce_microstep: 628.27 | step_microstep: 168.84
[2025-01-06 11:39:57,479] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.77 | bwd: 9776.69 | bwd_inner: 9148.38 | bwd_allreduce: 628.27 | step: 168.83
[2025-01-06 11:40:10,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.76 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:40:10,728] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.76 | bwd_microstep: 9832.31 | bwd_inner_microstep: 9165.13 | bwd_allreduce_microstep: 667.14 | step_microstep: 173.46
[2025-01-06 11:40:10,729] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.74 | bwd: 9832.30 | bwd_inner: 9165.13 | bwd_allreduce: 667.14 | step: 173.46
[2025-01-06 11:40:23,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.87 | optimizer_gradients: 2.58 | optimizer_step: 4.36
[2025-01-06 11:40:23,974] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.67 | bwd_microstep: 9819.57 | bwd_inner_microstep: 9146.40 | bwd_allreduce_microstep: 673.14 | step_microstep: 169.48
[2025-01-06 11:40:23,975] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.66 | bwd: 9819.57 | bwd_inner: 9146.39 | bwd_allreduce: 673.14 | step: 169.48
[2025-01-06 11:40:37,193] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.95 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:40:37,193] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.02 | bwd_microstep: 9763.87 | bwd_inner_microstep: 9150.16 | bwd_allreduce_microstep: 613.68 | step_microstep: 170.77
[2025-01-06 11:40:37,193] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.01 | bwd: 9763.86 | bwd_inner: 9150.16 | bwd_allreduce: 613.68 | step: 170.77
[2025-01-06 11:40:50,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.82 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:40:50,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2969.96 | bwd_microstep: 9760.79 | bwd_inner_microstep: 9159.09 | bwd_allreduce_microstep: 601.66 | step_microstep: 164.36
[2025-01-06 11:40:50,388] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2969.95 | bwd: 9760.78 | bwd_inner: 9159.08 | bwd_allreduce: 601.66 | step: 164.36
[2025-01-06 11:41:03,639] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.28 | optimizer_gradients: 2.54 | optimizer_step: 4.37
[2025-01-06 11:41:03,639] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.30 | bwd_microstep: 9816.10 | bwd_inner_microstep: 9147.93 | bwd_allreduce_microstep: 668.13 | step_microstep: 172.06
[2025-01-06 11:41:03,639] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.29 | bwd: 9816.09 | bwd_inner: 9147.93 | bwd_allreduce: 668.13 | step: 172.07
[2025-01-06 11:41:16,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.69 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:41:16,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[1.8750000000000002e-05, 1.8750000000000002e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:41:16,921] [INFO] [timer.py:260:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=48.64470883634651, CurrSamplesPerSec=48.37591235975925, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:41:16,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.66 | bwd_microstep: 9885.74 | bwd_inner_microstep: 9162.55 | bwd_allreduce_microstep: 723.15 | step_microstep: 165.17
[2025-01-06 11:41:16,922] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.65 | bwd: 9885.73 | bwd_inner: 9162.54 | bwd_allreduce: 723.15 | step: 165.17
 samples/sec: 48.319 | iteration      300/  320000 | elapsed time per iteration (ms): 13245.3 | learning rate: 1.875E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.36% | HFU: 47.15% | lm_loss: 4.849804E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3247.02 | backward: 9816.24 | backward-backward: 9816.20 | backward-allreduce: 0.00 | optimizer: 169.18 | batch generator: 65.25
[2025-01-06 11:41:30,186] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.21 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:41:30,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.44 | bwd_microstep: 9825.31 | bwd_inner_microstep: 9140.55 | bwd_allreduce_microstep: 684.73 | step_microstep: 169.11
[2025-01-06 11:41:30,187] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.42 | bwd: 9825.31 | bwd_inner: 9140.54 | bwd_allreduce: 684.73 | step: 169.11
[2025-01-06 11:41:43,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.71 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:41:43,436] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.57 | bwd_microstep: 9849.28 | bwd_inner_microstep: 9151.84 | bwd_allreduce_microstep: 697.40 | step_microstep: 168.51
[2025-01-06 11:41:43,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.56 | bwd: 9849.27 | bwd_inner: 9151.84 | bwd_allreduce: 697.40 | step: 168.51
[2025-01-06 11:41:56,694] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.42 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 11:41:56,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.74 | bwd_microstep: 9833.73 | bwd_inner_microstep: 9143.49 | bwd_allreduce_microstep: 690.20 | step_microstep: 174.76
[2025-01-06 11:41:56,695] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.72 | bwd: 9833.72 | bwd_inner: 9143.48 | bwd_allreduce: 690.20 | step: 174.76
[2025-01-06 11:42:09,920] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.64 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:42:09,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.40 | bwd_microstep: 9795.18 | bwd_inner_microstep: 9155.63 | bwd_allreduce_microstep: 639.52 | step_microstep: 165.59
[2025-01-06 11:42:09,921] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.38 | bwd: 9795.18 | bwd_inner: 9155.62 | bwd_allreduce: 639.52 | step: 165.59
[2025-01-06 11:42:23,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.40 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:42:23,139] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.57 | bwd_microstep: 9771.43 | bwd_inner_microstep: 9176.18 | bwd_allreduce_microstep: 595.22 | step_microstep: 173.19
[2025-01-06 11:42:23,139] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.57 | bwd: 9771.42 | bwd_inner: 9176.18 | bwd_allreduce: 595.22 | step: 173.19
[2025-01-06 11:42:36,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.95 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:42:36,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.65 | bwd_microstep: 9784.04 | bwd_inner_microstep: 9158.16 | bwd_allreduce_microstep: 625.85 | step_microstep: 173.66
[2025-01-06 11:42:36,374] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.64 | bwd: 9784.04 | bwd_inner: 9158.15 | bwd_allreduce: 625.85 | step: 173.66
[2025-01-06 11:42:49,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.39 | optimizer_gradients: 2.56 | optimizer_step: 4.39
[2025-01-06 11:42:49,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.83 | bwd_microstep: 9791.93 | bwd_inner_microstep: 9159.48 | bwd_allreduce_microstep: 632.41 | step_microstep: 167.87
[2025-01-06 11:42:49,593] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.82 | bwd: 9791.92 | bwd_inner: 9159.48 | bwd_allreduce: 632.41 | step: 167.87
[2025-01-06 11:43:02,832] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.88 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:43:02,832] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.49 | bwd_microstep: 9834.95 | bwd_inner_microstep: 9151.38 | bwd_allreduce_microstep: 683.53 | step_microstep: 166.83
[2025-01-06 11:43:02,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.48 | bwd: 9834.94 | bwd_inner: 9151.38 | bwd_allreduce: 683.53 | step: 166.83
[2025-01-06 11:43:16,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.55 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:43:16,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2951.23 | bwd_microstep: 9815.61 | bwd_inner_microstep: 9147.22 | bwd_allreduce_microstep: 668.36 | step_microstep: 167.43
[2025-01-06 11:43:16,065] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2951.22 | bwd: 9815.60 | bwd_inner: 9147.21 | bwd_allreduce: 668.36 | step: 167.44
[2025-01-06 11:43:29,276] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.98 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:43:29,276] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[1.9375e-05, 1.9375e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:43:29,277] [INFO] [timer.py:260:stop] epoch=0/micro_step=310/global_step=310, RunningAvgSamplesPerSec=48.645432876325415, CurrSamplesPerSec=48.801943457035556, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:43:29,277] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.24 | bwd_microstep: 9765.46 | bwd_inner_microstep: 9139.07 | bwd_allreduce_microstep: 626.36 | step_microstep: 173.35
[2025-01-06 11:43:29,277] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.23 | bwd: 9765.45 | bwd_inner: 9139.07 | bwd_allreduce: 626.35 | step: 173.35
 samples/sec: 48.356 | iteration      310/  320000 | elapsed time per iteration (ms): 13235.0 | learning rate: 1.937E-05 | approx flops per GPU: 147.2TFLOPS | MFU: 35.39% | HFU: 47.19% | lm_loss: 4.779752E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3241.51 | backward: 9807.00 | backward-backward: 9806.96 | backward-allreduce: 0.00 | optimizer: 170.38 | batch generator: 67.83
[2025-01-06 11:43:42,510] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.37 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:43:42,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.17 | bwd_microstep: 9836.99 | bwd_inner_microstep: 9136.70 | bwd_allreduce_microstep: 700.26 | step_microstep: 167.19
[2025-01-06 11:43:42,511] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2972.16 | bwd: 9836.98 | bwd_inner: 9136.70 | bwd_allreduce: 700.26 | step: 167.19
[2025-01-06 11:43:55,743] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.44 | optimizer_gradients: 2.56 | optimizer_step: 4.33
[2025-01-06 11:43:55,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.21 | bwd_microstep: 9828.98 | bwd_inner_microstep: 9149.56 | bwd_allreduce_microstep: 679.38 | step_microstep: 168.27
[2025-01-06 11:43:55,744] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.19 | bwd: 9828.97 | bwd_inner: 9149.56 | bwd_allreduce: 679.38 | step: 168.27
[2025-01-06 11:44:09,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.14 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:44:09,005] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.87 | bwd_microstep: 9845.79 | bwd_inner_microstep: 9160.78 | bwd_allreduce_microstep: 684.97 | step_microstep: 171.14
[2025-01-06 11:44:09,006] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.86 | bwd: 9845.78 | bwd_inner: 9160.77 | bwd_allreduce: 684.97 | step: 171.15
[2025-01-06 11:44:22,249] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.26 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:44:22,249] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.14 | bwd_microstep: 9818.81 | bwd_inner_microstep: 9153.50 | bwd_allreduce_microstep: 665.28 | step_microstep: 167.19
[2025-01-06 11:44:22,249] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.13 | bwd: 9818.80 | bwd_inner: 9153.50 | bwd_allreduce: 665.28 | step: 167.19
[2025-01-06 11:44:35,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.66 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:44:35,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.33 | bwd_microstep: 9808.49 | bwd_inner_microstep: 9161.54 | bwd_allreduce_microstep: 646.91 | step_microstep: 174.36
[2025-01-06 11:44:35,502] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.32 | bwd: 9808.48 | bwd_inner: 9161.54 | bwd_allreduce: 646.91 | step: 174.36
[2025-01-06 11:44:48,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.64 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:44:48,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.68 | bwd_microstep: 9827.51 | bwd_inner_microstep: 9148.14 | bwd_allreduce_microstep: 679.33 | step_microstep: 167.52
[2025-01-06 11:44:48,762] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.66 | bwd: 9827.50 | bwd_inner: 9148.14 | bwd_allreduce: 679.33 | step: 167.52
[2025-01-06 11:45:02,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.23 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:45:02,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.54 | bwd_microstep: 9835.37 | bwd_inner_microstep: 9164.59 | bwd_allreduce_microstep: 670.74 | step_microstep: 174.16
[2025-01-06 11:45:02,009] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.53 | bwd: 9835.36 | bwd_inner: 9164.58 | bwd_allreduce: 670.74 | step: 174.16
[2025-01-06 11:45:15,231] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 147.32 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:45:15,232] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.62 | bwd_microstep: 9847.68 | bwd_inner_microstep: 9175.94 | bwd_allreduce_microstep: 671.70 | step_microstep: 162.10
[2025-01-06 11:45:15,232] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.60 | bwd: 9847.67 | bwd_inner: 9175.94 | bwd_allreduce: 671.70 | step: 162.10
[2025-01-06 11:45:28,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.10 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:45:28,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2975.71 | bwd_microstep: 9801.98 | bwd_inner_microstep: 9138.41 | bwd_allreduce_microstep: 663.54 | step_microstep: 172.87
[2025-01-06 11:45:28,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2975.66 | bwd: 9801.98 | bwd_inner: 9138.40 | bwd_allreduce: 663.54 | step: 172.87
[2025-01-06 11:45:41,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.47 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:45:41,679] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[2e-05, 2e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:45:41,679] [INFO] [timer.py:260:stop] epoch=0/micro_step=320/global_step=320, RunningAvgSamplesPerSec=48.64298057438678, CurrSamplesPerSec=48.62586511224054, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:45:41,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.90 | bwd_microstep: 9811.90 | bwd_inner_microstep: 9164.92 | bwd_allreduce_microstep: 646.94 | step_microstep: 164.63
[2025-01-06 11:45:41,679] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.88 | bwd: 9811.89 | bwd_inner: 9164.91 | bwd_allreduce: 646.94 | step: 164.63
 samples/sec: 48.338 | iteration      320/  320000 | elapsed time per iteration (ms): 13240.2 | learning rate: 2.000E-05 | approx flops per GPU: 147.2TFLOPS | MFU: 35.38% | HFU: 47.17% | lm_loss: 4.761799E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3228.76 | backward: 9826.64 | backward-backward: 9826.60 | backward-allreduce: 0.00 | optimizer: 169.31 | batch generator: 46.70
[2025-01-06 11:45:54,927] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.67 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:45:54,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.25 | bwd_microstep: 9812.80 | bwd_inner_microstep: 9152.14 | bwd_allreduce_microstep: 660.62 | step_microstep: 168.62
[2025-01-06 11:45:54,928] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.23 | bwd: 9812.79 | bwd_inner: 9152.13 | bwd_allreduce: 660.62 | step: 168.62
[2025-01-06 11:46:08,176] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.16 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:46:08,176] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2962.73 | bwd_microstep: 9819.80 | bwd_inner_microstep: 9166.92 | bwd_allreduce_microstep: 652.85 | step_microstep: 175.15
[2025-01-06 11:46:08,177] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2962.71 | bwd: 9819.79 | bwd_inner: 9166.91 | bwd_allreduce: 652.85 | step: 175.15
[2025-01-06 11:46:21,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.87 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:46:21,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.62 | bwd_microstep: 9806.54 | bwd_inner_microstep: 9148.57 | bwd_allreduce_microstep: 657.94 | step_microstep: 166.65
[2025-01-06 11:46:21,404] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.60 | bwd: 9806.54 | bwd_inner: 9148.56 | bwd_allreduce: 657.94 | step: 166.65
[2025-01-06 11:46:34,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.12 | optimizer_gradients: 2.57 | optimizer_step: 4.36
[2025-01-06 11:46:34,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2970.51 | bwd_microstep: 9791.73 | bwd_inner_microstep: 9154.49 | bwd_allreduce_microstep: 637.21 | step_microstep: 167.91
[2025-01-06 11:46:34,630] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2970.50 | bwd: 9791.72 | bwd_inner: 9154.49 | bwd_allreduce: 637.21 | step: 167.92
[2025-01-06 11:46:47,847] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.57 | optimizer_gradients: 2.62 | optimizer_step: 4.35
[2025-01-06 11:46:47,847] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.86 | bwd_microstep: 9768.95 | bwd_inner_microstep: 9163.84 | bwd_allreduce_microstep: 605.07 | step_microstep: 174.28
[2025-01-06 11:46:47,847] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.84 | bwd: 9768.94 | bwd_inner: 9163.84 | bwd_allreduce: 605.07 | step: 174.28
[2025-01-06 11:47:01,089] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 154.20 | optimizer_gradients: 2.56 | optimizer_step: 4.34
[2025-01-06 11:47:01,090] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.62 | bwd_microstep: 9805.28 | bwd_inner_microstep: 9149.09 | bwd_allreduce_microstep: 656.15 | step_microstep: 168.94
[2025-01-06 11:47:01,090] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.61 | bwd: 9805.27 | bwd_inner: 9149.09 | bwd_allreduce: 656.15 | step: 168.95
[2025-01-06 11:47:14,300] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.17 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:47:14,301] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.20 | bwd_microstep: 9804.02 | bwd_inner_microstep: 9139.25 | bwd_allreduce_microstep: 664.74 | step_microstep: 167.87
[2025-01-06 11:47:14,301] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.19 | bwd: 9804.01 | bwd_inner: 9139.24 | bwd_allreduce: 664.74 | step: 167.87
[2025-01-06 11:47:27,575] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 147.70 | optimizer_gradients: 2.57 | optimizer_step: 4.40
[2025-01-06 11:47:27,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.37 | bwd_microstep: 9837.25 | bwd_inner_microstep: 9149.40 | bwd_allreduce_microstep: 687.82 | step_microstep: 162.64
[2025-01-06 11:47:27,576] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.35 | bwd: 9837.24 | bwd_inner: 9149.39 | bwd_allreduce: 687.82 | step: 162.63
[2025-01-06 11:47:40,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.57 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:47:40,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.99 | bwd_microstep: 9812.10 | bwd_inner_microstep: 9159.28 | bwd_allreduce_microstep: 652.78 | step_microstep: 171.44
[2025-01-06 11:47:40,839] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.97 | bwd: 9812.09 | bwd_inner: 9159.27 | bwd_allreduce: 652.78 | step: 171.45
[2025-01-06 11:47:54,118] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.27 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:47:54,118] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[2.0625e-05, 2.0625e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:47:54,119] [INFO] [timer.py:260:stop] epoch=0/micro_step=330/global_step=330, RunningAvgSamplesPerSec=48.64244404243413, CurrSamplesPerSec=48.35459570710778, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:47:54,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2964.80 | bwd_microstep: 9885.65 | bwd_inner_microstep: 9172.85 | bwd_allreduce_microstep: 712.75 | step_microstep: 166.46
[2025-01-06 11:47:54,119] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2964.79 | bwd: 9885.64 | bwd_inner: 9172.84 | bwd_allreduce: 712.75 | step: 166.46
 samples/sec: 48.324 | iteration      330/  320000 | elapsed time per iteration (ms): 13244.0 | learning rate: 2.062E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.37% | HFU: 47.15% | lm_loss: 4.716234E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3250.24 | backward: 9814.69 | backward-backward: 9814.65 | backward-allreduce: 0.00 | optimizer: 169.38 | batch generator: 71.95
[2025-01-06 11:48:07,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.20 | optimizer_gradients: 2.56 | optimizer_step: 4.37
[2025-01-06 11:48:07,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.39 | bwd_microstep: 9934.92 | bwd_inner_microstep: 9189.43 | bwd_allreduce_microstep: 745.45 | step_microstep: 166.08
[2025-01-06 11:48:07,443] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.39 | bwd: 9934.91 | bwd_inner: 9189.43 | bwd_allreduce: 745.45 | step: 166.08
[2025-01-06 11:48:20,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.92 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:48:20,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.79 | bwd_microstep: 9862.92 | bwd_inner_microstep: 9179.57 | bwd_allreduce_microstep: 683.30 | step_microstep: 165.61
[2025-01-06 11:48:20,719] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.78 | bwd: 9862.91 | bwd_inner: 9179.56 | bwd_allreduce: 683.30 | step: 165.61
[2025-01-06 11:48:34,013] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.38 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:48:34,014] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2969.88 | bwd_microstep: 9875.25 | bwd_inner_microstep: 9163.19 | bwd_allreduce_microstep: 712.02 | step_microstep: 171.31
[2025-01-06 11:48:34,014] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2969.86 | bwd: 9875.24 | bwd_inner: 9163.19 | bwd_allreduce: 712.02 | step: 171.32
[2025-01-06 11:48:47,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.65 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:48:47,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.29 | bwd_microstep: 9858.91 | bwd_inner_microstep: 9173.86 | bwd_allreduce_microstep: 685.02 | step_microstep: 165.40
[2025-01-06 11:48:47,295] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.27 | bwd: 9858.90 | bwd_inner: 9173.85 | bwd_allreduce: 685.02 | step: 165.40
[2025-01-06 11:49:00,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.16 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:49:00,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.17 | bwd_microstep: 9825.98 | bwd_inner_microstep: 9209.19 | bwd_allreduce_microstep: 616.76 | step_microstep: 173.12
[2025-01-06 11:49:00,552] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.16 | bwd: 9825.97 | bwd_inner: 9209.18 | bwd_allreduce: 616.76 | step: 173.12
[2025-01-06 11:49:13,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 160.28 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:49:13,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.49 | bwd_microstep: 9819.16 | bwd_inner_microstep: 9169.42 | bwd_allreduce_microstep: 649.70 | step_microstep: 175.03
[2025-01-06 11:49:13,833] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.48 | bwd: 9819.15 | bwd_inner: 9169.42 | bwd_allreduce: 649.69 | step: 175.03
[2025-01-06 11:49:27,137] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.80 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:49:27,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.41 | bwd_microstep: 9851.72 | bwd_inner_microstep: 9164.94 | bwd_allreduce_microstep: 686.74 | step_microstep: 163.41
[2025-01-06 11:49:27,138] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.40 | bwd: 9851.71 | bwd_inner: 9164.94 | bwd_allreduce: 686.74 | step: 163.41
[2025-01-06 11:49:40,409] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.43 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:49:40,410] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.90 | bwd_microstep: 9826.45 | bwd_inner_microstep: 9156.51 | bwd_allreduce_microstep: 669.90 | step_microstep: 166.44
[2025-01-06 11:49:40,410] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.89 | bwd: 9826.44 | bwd_inner: 9156.50 | bwd_allreduce: 669.90 | step: 166.45
[2025-01-06 11:49:53,713] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.83 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:49:53,714] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2993.17 | bwd_microstep: 9880.25 | bwd_inner_microstep: 9180.64 | bwd_allreduce_microstep: 699.58 | step_microstep: 171.83
[2025-01-06 11:49:53,714] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2993.16 | bwd: 9880.24 | bwd_inner: 9180.63 | bwd_allreduce: 699.58 | step: 171.84
[2025-01-06 11:50:07,017] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.02 | optimizer_gradients: 2.57 | optimizer_step: 4.35
[2025-01-06 11:50:07,017] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[2.125e-05, 2.125e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:50:07,018] [INFO] [timer.py:260:stop] epoch=0/micro_step=340/global_step=340, RunningAvgSamplesPerSec=48.63597622699298, CurrSamplesPerSec=48.39569294118553, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:50:07,018] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.75 | bwd_microstep: 9882.58 | bwd_inner_microstep: 9147.84 | bwd_allreduce_microstep: 734.71 | step_microstep: 166.36
[2025-01-06 11:50:07,018] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.74 | bwd: 9882.57 | bwd_inner: 9147.83 | bwd_allreduce: 734.71 | step: 166.37
 samples/sec: 48.154 | iteration      340/  320000 | elapsed time per iteration (ms): 13290.7 | learning rate: 2.125E-05 | approx flops per GPU: 146.6TFLOPS | MFU: 35.24% | HFU: 46.99% | lm_loss: 4.620387E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3243.86 | backward: 9862.08 | backward-backward: 9862.04 | backward-allreduce: 0.00 | optimizer: 168.80 | batch generator: 57.91
[2025-01-06 11:50:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.06 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:50:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2959.80 | bwd_microstep: 9856.02 | bwd_inner_microstep: 9167.19 | bwd_allreduce_microstep: 688.80 | step_microstep: 165.86
[2025-01-06 11:50:20,312] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2959.79 | bwd: 9856.01 | bwd_inner: 9167.18 | bwd_allreduce: 688.80 | step: 165.86
[2025-01-06 11:50:33,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.81 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:50:33,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.49 | bwd_microstep: 9824.64 | bwd_inner_microstep: 9155.13 | bwd_allreduce_microstep: 669.47 | step_microstep: 168.58
[2025-01-06 11:50:33,584] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.47 | bwd: 9824.63 | bwd_inner: 9155.13 | bwd_allreduce: 669.47 | step: 168.58
[2025-01-06 11:50:46,819] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.57 | optimizer_gradients: 2.54 | optimizer_step: 4.36
[2025-01-06 11:50:46,819] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.82 | bwd_microstep: 9800.02 | bwd_inner_microstep: 9168.26 | bwd_allreduce_microstep: 631.72 | step_microstep: 164.26
[2025-01-06 11:50:46,819] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2972.80 | bwd: 9800.01 | bwd_inner: 9168.26 | bwd_allreduce: 631.72 | step: 164.26
[2025-01-06 11:51:00,059] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.44 | optimizer_gradients: 2.55 | optimizer_step: 4.38
[2025-01-06 11:51:00,060] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.36 | bwd_microstep: 9808.90 | bwd_inner_microstep: 9145.87 | bwd_allreduce_microstep: 663.00 | step_microstep: 170.15
[2025-01-06 11:51:00,060] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.35 | bwd: 9808.90 | bwd_inner: 9145.87 | bwd_allreduce: 663.00 | step: 170.15
[2025-01-06 11:51:13,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.70 | optimizer_gradients: 2.56 | optimizer_step: 4.33
[2025-01-06 11:51:13,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2958.50 | bwd_microstep: 9832.18 | bwd_inner_microstep: 9157.31 | bwd_allreduce_microstep: 674.84 | step_microstep: 168.34
[2025-01-06 11:51:13,303] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2958.49 | bwd: 9832.17 | bwd_inner: 9157.31 | bwd_allreduce: 674.84 | step: 168.34
[2025-01-06 11:51:26,547] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.28 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:51:26,548] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2955.43 | bwd_microstep: 9805.09 | bwd_inner_microstep: 9165.94 | bwd_allreduce_microstep: 639.12 | step_microstep: 174.14
[2025-01-06 11:51:26,548] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2955.42 | bwd: 9805.09 | bwd_inner: 9165.93 | bwd_allreduce: 639.12 | step: 174.14
[2025-01-06 11:51:39,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.52 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:51:39,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.14 | bwd_microstep: 9810.73 | bwd_inner_microstep: 9152.49 | bwd_allreduce_microstep: 658.21 | step_microstep: 163.27
[2025-01-06 11:51:39,776] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.13 | bwd: 9810.72 | bwd_inner: 9152.48 | bwd_allreduce: 658.20 | step: 163.27
[2025-01-06 11:51:53,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.55 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:51:53,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2950.03 | bwd_microstep: 9803.08 | bwd_inner_microstep: 9152.18 | bwd_allreduce_microstep: 650.87 | step_microstep: 174.37
[2025-01-06 11:51:53,016] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2950.02 | bwd: 9803.07 | bwd_inner: 9152.17 | bwd_allreduce: 650.87 | step: 174.37
[2025-01-06 11:52:06,270] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.51 | optimizer_gradients: 2.55 | optimizer_step: 4.37
[2025-01-06 11:52:06,270] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2960.15 | bwd_microstep: 9829.58 | bwd_inner_microstep: 9147.64 | bwd_allreduce_microstep: 681.89 | step_microstep: 174.30
[2025-01-06 11:52:06,270] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2960.15 | bwd: 9829.56 | bwd_inner: 9147.63 | bwd_allreduce: 681.88 | step: 174.30
[2025-01-06 11:52:19,560] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.63 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:52:19,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[2.1875000000000003e-05, 2.1875000000000003e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:52:19,561] [INFO] [timer.py:260:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=48.63459085969923, CurrSamplesPerSec=48.376329085278854, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:52:19,561] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2973.61 | bwd_microstep: 9865.78 | bwd_inner_microstep: 9158.40 | bwd_allreduce_microstep: 707.34 | step_microstep: 171.91
[2025-01-06 11:52:19,562] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2973.60 | bwd: 9865.77 | bwd_inner: 9158.40 | bwd_allreduce: 707.34 | step: 171.92
 samples/sec: 48.278 | iteration      350/  320000 | elapsed time per iteration (ms): 13256.7 | learning rate: 2.188E-05 | approx flops per GPU: 147.0TFLOPS | MFU: 35.33% | HFU: 47.11% | lm_loss: 4.659266E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3250.17 | backward: 9823.87 | backward-backward: 9823.83 | backward-allreduce: 0.00 | optimizer: 169.87 | batch generator: 71.40
[2025-01-06 11:52:32,805] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.37 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:52:32,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.10 | bwd_microstep: 9827.90 | bwd_inner_microstep: 9160.63 | bwd_allreduce_microstep: 667.24 | step_microstep: 170.08
[2025-01-06 11:52:32,806] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.09 | bwd: 9827.89 | bwd_inner: 9160.62 | bwd_allreduce: 667.24 | step: 170.09
[2025-01-06 11:52:46,049] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 147.40 | optimizer_gradients: 2.57 | optimizer_step: 4.37
[2025-01-06 11:52:46,049] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.27 | bwd_microstep: 9830.37 | bwd_inner_microstep: 9177.47 | bwd_allreduce_microstep: 652.86 | step_microstep: 162.27
[2025-01-06 11:52:46,049] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.26 | bwd: 9830.36 | bwd_inner: 9177.46 | bwd_allreduce: 652.86 | step: 162.28
[2025-01-06 11:52:59,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.92 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:52:59,259] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.69 | bwd_microstep: 9755.40 | bwd_inner_microstep: 9169.38 | bwd_allreduce_microstep: 585.99 | step_microstep: 174.78
[2025-01-06 11:52:59,260] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.68 | bwd: 9755.39 | bwd_inner: 9169.38 | bwd_allreduce: 585.99 | step: 174.78
[2025-01-06 11:53:12,460] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.64 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:53:12,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.69 | bwd_microstep: 9767.07 | bwd_inner_microstep: 9148.33 | bwd_allreduce_microstep: 618.71 | step_microstep: 167.34
[2025-01-06 11:53:12,461] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.67 | bwd: 9767.07 | bwd_inner: 9148.32 | bwd_allreduce: 618.71 | step: 167.35
[2025-01-06 11:53:25,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 158.29 | optimizer_gradients: 2.57 | optimizer_step: 4.38
[2025-01-06 11:53:25,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.73 | bwd_microstep: 9815.31 | bwd_inner_microstep: 9142.80 | bwd_allreduce_microstep: 672.48 | step_microstep: 173.18
[2025-01-06 11:53:25,705] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.71 | bwd: 9815.30 | bwd_inner: 9142.79 | bwd_allreduce: 672.48 | step: 173.18
[2025-01-06 11:53:38,957] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.21 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:53:38,957] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.39 | bwd_microstep: 9865.07 | bwd_inner_microstep: 9159.81 | bwd_allreduce_microstep: 705.23 | step_microstep: 174.02
[2025-01-06 11:53:38,957] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.38 | bwd: 9865.07 | bwd_inner: 9159.80 | bwd_allreduce: 705.23 | step: 174.02
[2025-01-06 11:53:52,258] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 157.63 | optimizer_gradients: 2.58 | optimizer_step: 4.37
[2025-01-06 11:53:52,258] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2956.38 | bwd_microstep: 9909.73 | bwd_inner_microstep: 9151.59 | bwd_allreduce_microstep: 758.11 | step_microstep: 172.49
[2025-01-06 11:53:52,258] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2956.37 | bwd: 9909.72 | bwd_inner: 9151.58 | bwd_allreduce: 758.10 | step: 172.49
[2025-01-06 11:54:05,495] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.86 | optimizer_gradients: 2.58 | optimizer_step: 4.37
[2025-01-06 11:54:05,496] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2965.86 | bwd_microstep: 9837.69 | bwd_inner_microstep: 9148.70 | bwd_allreduce_microstep: 688.96 | step_microstep: 167.71
[2025-01-06 11:54:05,496] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2965.85 | bwd: 9837.68 | bwd_inner: 9148.69 | bwd_allreduce: 688.96 | step: 167.71
[2025-01-06 11:54:18,725] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.13 | optimizer_gradients: 2.57 | optimizer_step: 4.34
[2025-01-06 11:54:18,726] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.05 | bwd_microstep: 9783.75 | bwd_inner_microstep: 9134.69 | bwd_allreduce_microstep: 649.02 | step_microstep: 167.88
[2025-01-06 11:54:18,726] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.03 | bwd: 9783.74 | bwd_inner: 9134.69 | bwd_allreduce: 649.02 | step: 167.89
[2025-01-06 11:54:31,971] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 153.03 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:54:31,971] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[2.25e-05, 2.25e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:54:31,971] [INFO] [timer.py:260:stop] epoch=0/micro_step=360/global_step=360, RunningAvgSamplesPerSec=48.633733353309445, CurrSamplesPerSec=48.61207073867803, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:54:31,972] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2966.44 | bwd_microstep: 9812.28 | bwd_inner_microstep: 9146.73 | bwd_allreduce_microstep: 665.52 | step_microstep: 168.32
[2025-01-06 11:54:31,972] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2966.42 | bwd: 9812.27 | bwd_inner: 9146.72 | bwd_allreduce: 665.51 | step: 168.31
 samples/sec: 48.346 | iteration      360/  320000 | elapsed time per iteration (ms): 13237.9 | learning rate: 2.250E-05 | approx flops per GPU: 147.2TFLOPS | MFU: 35.38% | HFU: 47.18% | lm_loss: 4.611439E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3236.27 | backward: 9820.76 | backward-backward: 9820.72 | backward-allreduce: 0.00 | optimizer: 170.18 | batch generator: 59.05
[2025-01-06 11:54:45,209] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 151.14 | optimizer_gradients: 2.56 | optimizer_step: 4.35
[2025-01-06 11:54:45,210] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.05 | bwd_microstep: 9792.53 | bwd_inner_microstep: 9158.65 | bwd_allreduce_microstep: 633.85 | step_microstep: 166.07
[2025-01-06 11:54:45,210] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.04 | bwd: 9792.52 | bwd_inner: 9158.64 | bwd_allreduce: 633.85 | step: 166.07
[2025-01-06 11:54:58,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.88 | optimizer_gradients: 2.55 | optimizer_step: 4.36
[2025-01-06 11:54:58,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.21 | bwd_microstep: 9837.20 | bwd_inner_microstep: 9147.74 | bwd_allreduce_microstep: 689.42 | step_microstep: 164.54
[2025-01-06 11:54:58,451] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.20 | bwd: 9837.19 | bwd_inner: 9147.72 | bwd_allreduce: 689.42 | step: 164.54
[2025-01-06 11:55:11,707] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.23 | optimizer_gradients: 2.56 | optimizer_step: 4.36
[2025-01-06 11:55:11,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2953.34 | bwd_microstep: 9823.92 | bwd_inner_microstep: 9158.23 | bwd_allreduce_microstep: 665.65 | step_microstep: 171.05
[2025-01-06 11:55:11,708] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2953.33 | bwd: 9823.91 | bwd_inner: 9158.22 | bwd_allreduce: 665.65 | step: 171.06
[2025-01-06 11:55:24,929] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.55 | optimizer_gradients: 2.57 | optimizer_step: 4.39
[2025-01-06 11:55:24,930] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2972.20 | bwd_microstep: 9761.35 | bwd_inner_microstep: 9156.17 | bwd_allreduce_microstep: 605.15 | step_microstep: 164.38
[2025-01-06 11:55:24,930] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2972.17 | bwd: 9761.34 | bwd_inner: 9156.17 | bwd_allreduce: 605.15 | step: 164.38
[2025-01-06 11:55:38,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 159.66 | optimizer_gradients: 2.56 | optimizer_step: 4.39
[2025-01-06 11:55:38,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2957.18 | bwd_microstep: 9819.89 | bwd_inner_microstep: 9153.60 | bwd_allreduce_microstep: 666.25 | step_microstep: 174.50
[2025-01-06 11:55:38,191] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2957.17 | bwd: 9819.88 | bwd_inner: 9153.60 | bwd_allreduce: 666.25 | step: 174.50
[2025-01-06 11:55:51,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 150.86 | optimizer_gradients: 2.55 | optimizer_step: 4.35
[2025-01-06 11:55:51,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2954.94 | bwd_microstep: 9807.85 | bwd_inner_microstep: 9165.17 | bwd_allreduce_microstep: 642.63 | step_microstep: 165.56
[2025-01-06 11:55:51,437] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2954.93 | bwd: 9807.83 | bwd_inner: 9165.16 | bwd_allreduce: 642.63 | step: 165.56
[2025-01-06 11:56:04,663] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 149.20 | optimizer_gradients: 2.56 | optimizer_step: 4.39
[2025-01-06 11:56:04,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2952.99 | bwd_microstep: 9818.12 | bwd_inner_microstep: 9149.51 | bwd_allreduce_microstep: 668.58 | step_microstep: 163.95
[2025-01-06 11:56:04,664] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2952.98 | bwd: 9818.12 | bwd_inner: 9149.50 | bwd_allreduce: 668.58 | step: 163.95
[2025-01-06 11:56:17,914] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 152.01 | optimizer_gradients: 2.56 | optimizer_step: 4.38
[2025-01-06 11:56:17,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.69 | bwd_microstep: 9849.87 | bwd_inner_microstep: 9159.49 | bwd_allreduce_microstep: 690.34 | step_microstep: 166.96
[2025-01-06 11:56:17,915] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.68 | bwd: 9849.86 | bwd_inner: 9159.49 | bwd_allreduce: 690.34 | step: 166.96
[2025-01-06 11:56:31,203] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 156.95 | optimizer_gradients: 2.55 | optimizer_step: 4.39
[2025-01-06 11:56:31,204] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2963.75 | bwd_microstep: 9883.43 | bwd_inner_microstep: 9142.25 | bwd_allreduce_microstep: 741.15 | step_microstep: 171.61
[2025-01-06 11:56:31,204] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2963.74 | bwd: 9883.42 | bwd_inner: 9142.24 | bwd_allreduce: 741.15 | step: 171.60
[2025-01-06 11:56:44,458] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 155.94 | optimizer_gradients: 2.54 | optimizer_step: 4.36
[2025-01-06 11:56:44,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[2.3125000000000003e-05, 2.3125000000000003e-05], mom=[[0.9, 0.95], [0.9, 0.95]]
[2025-01-06 11:56:44,458] [INFO] [timer.py:260:stop] epoch=0/micro_step=370/global_step=370, RunningAvgSamplesPerSec=48.63247754812578, CurrSamplesPerSec=48.445301794578334, MemAllocated=4.63GB, MaxMemAllocated=66.95GB
[2025-01-06 11:56:44,458] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2961.63 | bwd_microstep: 9859.74 | bwd_inner_microstep: 9175.74 | bwd_allreduce_microstep: 683.96 | step_microstep: 171.10
[2025-01-06 11:56:44,459] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2961.62 | bwd: 9859.73 | bwd_inner: 9175.73 | bwd_allreduce: 683.96 | step: 171.10
 samples/sec: 48.307 | iteration      370/  320000 | elapsed time per iteration (ms): 13248.7 | learning rate: 2.313E-05 | approx flops per GPU: 147.1TFLOPS | MFU: 35.35% | HFU: 47.14% | lm_loss: 4.516921E+00 | loss scale: 65536.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward: 3240.90 | backward: 9825.67 | backward-backward: 9825.64 | backward-allreduce: 0.00 | optimizer: 168.31 | batch generator: 62.33
[2025-01-06 11:56:57,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | optimizer_allgather: 148.97 | optimizer_gradients: 2.55 | optimizer_step: 4.34
[2025-01-06 11:56:57,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd_microstep: 2971.43 | bwd_microstep: 9815.61 | bwd_inner_microstep: 9179.96 | bwd_allreduce_microstep: 635.62 | step_microstep: 163.69
[2025-01-06 11:56:57,678] [INFO] [logging.py:96:log_dist] [Rank 0] time (ms) | fwd: 2971.42 | bwd: 9815.61 | bwd_inner: 9179.96 | bwd_allreduce: 635.62 | step: 163.69
